<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>La Intuición Bayesiana: De Steve a la Medicina</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');

    body {
      font-family: 'Inter', sans-serif;
      scroll-behavior: smooth;
    }

    /* Animaciones para hacer la experiencia más fluida */
    .fade-in {
      animation: fadeIn 0.8s ease-in;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .story-card {
      transition: transform 0.2s;
    }

    .story-card:hover {
      transform: translateY(-2px);
    }

    .highlight-box {
      background-color: #fffbeb;
      border-left: 4px solid #f59e0b;
    }
  </style>
</head>

<body class="bg-slate-50 text-slate-800">

  <!-- Navegación Simplificada -->
  <nav class="bg-white/90 backdrop-blur-sm border-b border-slate-200 sticky top-0 z-50">
    <div class="max-w-5xl mx-auto px-4">
      <div class="flex justify-between h-14 items-center">
        <div class="flex items-center gap-2">
          <i class="fa-solid fa-brain text-indigo-600 text-xl"></i>
          <span class="font-bold text-lg tracking-tight text-slate-900">Intuición Bayesiana</span>
        </div>
        <div class="text-xs md:text-sm font-medium text-slate-500 space-x-4">
          <a href="#steve" class="hover:text-indigo-600">1. Steve</a>
          <a href="#trampa" class="hover:text-indigo-600">2. La Trampa</a>
          <a href="#simulador" class="hover:text-indigo-600">3. Simulador Médico</a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <header class="bg-white pt-16 pb-12 border-b border-slate-200 text-center px-4">
    <h1 class="text-4xl md:text-6xl font-extrabold text-slate-900 mb-6 tracking-tight">
      ¿Por qué tu cerebro te engaña con las probabilidades?
    </h1>
    <p class="text-xl text-slate-600 max-w-2xl mx-auto leading-relaxed">
      Una guía interactiva basada en los ejemplos de
      <span class="font-semibold text-indigo-600">Veritasium</span> y
      <span class="font-semibold text-blue-600">3Blue1Brown</span> para entender la probabilidad bayesiana sin fórmulas
      complicadas.
    </p>
    <div class="mt-8">
      <a href="#steve"
        class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-full shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 transition">
        Comenzar la Historia <i class="fa-solid fa-arrow-down ml-2"></i>
      </a>
    </div>
  </header>

  <main class="max-w-5xl mx-auto px-4 py-10 space-y-24">

    <!-- CAPÍTULO 1: STEVE (3Blue1Brown) -->
    <section id="steve" class="scroll-mt-20 fade-in">
      <div class="flex items-center gap-3 mb-6">
        <div
          class="w-10 h-10 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center font-bold text-xl">1
        </div>
        <h2 class="text-3xl font-bold text-slate-900">El Dilema de Steve</h2>
      </div>

      <div class="grid md:grid-cols-2 gap-10">
        <div class="prose prose-slate">
          <p class="text-lg">
            Conoce a <strong>Steve</strong>. Steve es muy tímido, retraído y servicial, pero con poco interés en la
            gente. Le encanta el orden y la estructura, y tiene pasión por los detalles.
          </p>
          <div class="bg-blue-50 p-4 rounded-xl border border-blue-100 my-4">
            <p class="font-bold text-blue-900">Pregunta rápida:</p>
            <p class="text-blue-800">¿Es más probable que Steve sea <span
                class="underline decoration-blue-400 decoration-2">Bibliotecario</span> o <span
                class="underline decoration-green-400 decoration-2">Agricultor</span>?</p>
          </div>
          <p>
            Si eres como la mayoría, pensaste: <em>"¡Bibliotecario, obvio! La descripción encaja perfecto"</em>.
          </p>
          <p>
            <strong>Aquí está el error:</strong> Te fijaste solo en la <em>evidencia</em> (su personalidad) e ignoraste
            la <em>base</em> (la realidad de los números).
          </p>
        </div>

        <!-- Visualización Steve -->
        <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
          <h3 class="font-bold text-center mb-4 text-slate-500 uppercase text-xs tracking-wider">La Realidad de los
            Números (Ratio 20:1)</h3>

          <div class="flex h-64 w-full">
            <!-- Columna Agricultores -->
            <div class="w-full flex flex-col items-center relative group">
              <div class="w-full bg-green-100 h-full rounded-t-lg relative overflow-hidden border border-green-200">
                <!-- Agricultores que parecen bibliotecarios -->
                <div class="absolute top-0 w-full bg-green-500 h-[10%] transition-all group-hover:bg-green-600"></div>
                <div class="absolute top-2 left-2 text-xs font-bold text-green-800">Agricultores (Muchos)</div>
              </div>
              <div class="mt-2 text-center">
                <span class="block font-bold text-green-700">~200 Agricultores</span>
                <span class="text-xs text-slate-500">Incluso si solo el 10% es tímido...</span>
                <span class="block font-bold text-green-600 text-lg mt-1">20 personas</span>
                <span class="text-xs text-green-600">coinciden con la descripción</span>
              </div>
            </div>

            <!-- Separador -->
            <div class="w-4"></div>

            <!-- Columna Bibliotecarios -->
            <div class="w-16 flex flex-col items-center relative group">
              <div
                class="w-full bg-blue-100 h-[10%] self-end rounded-t-lg relative overflow-hidden border border-blue-200 mt-auto">
                <!-- Bibliotecarios que parecen bibliotecarios -->
                <div class="absolute top-0 w-full bg-blue-600 h-[80%]"></div>
              </div>
              <div class="mt-2 text-center w-32 -ml-8">
                <span class="block font-bold text-blue-700">~10 Bibliotecarios</span>
                <span class="text-xs text-slate-500">Aunque el 80% sea tímido...</span>
                <span class="block font-bold text-blue-600 text-lg mt-1">8 personas</span>
                <span class="text-xs text-blue-600">coinciden con la descripción</span>
              </div>
            </div>
          </div>

          <div class="mt-6 p-3 bg-slate-100 rounded text-sm text-center">
            <p>Hay <strong>20 agricultores tímidos</strong> y solo <strong>8 bibliotecarios tímidos</strong>.</p>
            <p class="mt-1 font-bold text-indigo-700">¡Es más probable que Steve sea agricultor!</p>
          </div>
        </div>
      </div>
    </section>

    <!-- CAPÍTULO 2: LA TRAMPA MÉDICA (Veritasium) -->
    <section id="trampa" class="scroll-mt-20 border-t border-slate-200 pt-16">
      <div class="flex items-center gap-3 mb-6">
        <div class="w-10 h-10 rounded-full bg-red-100 text-red-600 flex items-center justify-center font-bold text-xl">2
        </div>
        <h2 class="text-3xl font-bold text-slate-900">La Trampa Bayesiana</h2>
      </div>

      <div class="bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden">
        <div class="bg-slate-900 p-8 text-white">
          <h3 class="text-2xl font-bold mb-2">El Caso de Veritasium</h3>
          <p class="text-slate-300">
            Te haces un test para una enfermedad rara. El test tiene una <strong>precisión del 99%</strong>.
            Das <strong>Positivo (+)</strong>. <br>
            ¿Qué probabilidad tienes de estar realmente enfermo?
          </p>
        </div>

        <div class="grid md:grid-cols-2">
          <!-- Controles Simplificados -->
          <div class="p-8 bg-slate-50 border-r border-slate-200">
            <div class="space-y-8">
              <div>
                <label class="flex justify-between font-bold text-slate-700 mb-2">
                  1. Prevalencia (Rareza de la enfermedad)
                  <span class="text-indigo-600">0.1%</span>
                </label>
                <div class="w-full bg-slate-200 rounded-full h-2">
                  <div class="bg-indigo-600 h-2 rounded-full" style="width: 0.1%"></div>
                </div>
                <p class="text-xs text-slate-500 mt-2">Solo 1 de cada 1000 personas la tiene (como en el video).</p>
              </div>

              <div>
                <label class="flex justify-between font-bold text-slate-700 mb-2">
                  2. Precisión del Test (Sensibilidad/Esp)
                  <span class="text-emerald-600">99%</span>
                </label>
                <div class="w-full bg-slate-200 rounded-full h-2">
                  <div class="bg-emerald-500 h-2 rounded-full" style="width: 99%"></div>
                </div>
                <p class="text-xs text-slate-500 mt-2">El test casi nunca falla.</p>
              </div>

              <div class="p-6 bg-white rounded-xl border border-slate-200 shadow-sm text-center">
                <p class="text-xs uppercase font-bold text-slate-400 mb-2">Tu intuición dice 99%, pero la realidad es:
                </p>
                <div class="text-5xl font-extrabold text-indigo-600 mb-2">9%</div>
                <p class="text-sm font-medium text-slate-600">Probabilidad Real de Enfermedad</p>
              </div>
            </div>
          </div>

          <!-- Explicación Visual -->
          <div class="p-8">
            <h4 class="font-bold text-slate-800 mb-4">¿Por qué solo el 9%? (La Explicación Visual)</h4>

            <div class="space-y-4">
              <!-- Fila 1: El Enfermo -->
              <div class="flex items-center gap-4">
                <div
                  class="w-12 h-12 rounded bg-red-100 flex items-center justify-center border border-red-200 flex-shrink-0">
                  <i class="fa-solid fa-user text-red-600"></i>
                </div>
                <div>
                  <p class="font-bold text-sm text-slate-900">1 Persona realmente enferma</p>
                  <p class="text-xs text-slate-500">De cada 1000 personas, solo 1 está enferma. El test la detecta
                    correctamente (Verdadero Positivo).</p>
                </div>
              </div>

              <!-- Fila 2: Los Falsos Positivos -->
              <div class="flex items-center gap-4">
                <div
                  class="w-12 h-12 rounded bg-orange-100 flex items-center justify-center border border-orange-200 flex-shrink-0 font-bold text-orange-600">
                  10
                </div>
                <div>
                  <p class="font-bold text-sm text-slate-900">10 Falsas Alarmas (Falsos Positivos)</p>
                  <p class="text-xs text-slate-500">De los 999 sanos, el test falla el 1% de las veces. El 1% de 999 es
                    aprox <strong>10 personas</strong>.</p>
                </div>
              </div>

              <hr class="border-slate-100">

              <!-- Conclusión -->
              <div class="bg-indigo-50 p-4 rounded-lg">
                <p class="text-sm text-indigo-900 mb-2">
                  Si tu test da positivo, eres <strong>1</strong> de las <strong>11</strong> personas con luz roja (1
                  real + 10 falsas).
                </p>
                <div class="flex items-center justify-center gap-2 font-mono text-lg font-bold text-indigo-700">
                  <span>1</span>
                  <span class="text-slate-400">/</span>
                  <span>11</span>
                  <span class="text-slate-400">=</span>
                  <span>0.09 (9%)</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- CAPÍTULO 3: SIMULADOR AVANZADO (Medicina & Datos) -->
    <section id="simulador" class="scroll-mt-20 border-t border-slate-200 pt-16">
      <div class="flex items-center gap-3 mb-6">
        <div
          class="w-10 h-10 rounded-full bg-emerald-100 text-emerald-600 flex items-center justify-center font-bold text-xl">
          3</div>
        <h2 class="text-3xl font-bold text-slate-900">Simulador Médico Completo</h2>
      </div>
      <p class="mb-6 text-slate-600">Ahora que entiendes la intuición (Steve) y la trampa matemática (Veritasium), juega
        con tus propios números médicos.</p>

      <div class="bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden">
        <!-- Barra de Presets -->
        <div class="bg-slate-100 p-4 flex flex-wrap gap-3 border-b border-slate-200">
          <span class="text-xs font-bold text-slate-500 uppercase self-center mr-2">Cargar Escenario:</span>
          <button onclick="setScenario(0.1, 99, 99)"
            class="px-3 py-1 bg-white border border-slate-300 rounded hover:bg-slate-50 text-xs font-medium transition">Veritasium
            (Enfermedad Rara)</button>
          <button onclick="setScenario(15, 90, 95)"
            class="px-3 py-1 bg-white border border-slate-300 rounded hover:bg-slate-50 text-xs font-medium transition">Influenza
            (Común)</button>
          <button onclick="setScenario(0.8, 80, 90)"
            class="px-3 py-1 bg-white border border-slate-300 rounded hover:bg-slate-50 text-xs font-medium transition">Mamografía
            (Screening)</button>
        </div>

        <div class="grid lg:grid-cols-12 gap-0">
          <!-- Panel Controles -->
          <div class="lg:col-span-4 p-6 bg-slate-50 border-r border-slate-200 space-y-6">
            <div>
              <div class="flex justify-between text-sm mb-1">
                <label class="font-bold text-slate-700">Prevalencia</label>
                <span id="valPrev" class="text-indigo-600 font-bold">0.1%</span>
              </div>
              <input type="range" id="inpPrev" min="0.1" max="50" step="0.1" value="0.1"
                class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer">
            </div>
            <div>
              <div class="flex justify-between text-sm mb-1">
                <label class="font-bold text-slate-700">Sensibilidad (TP)</label>
                <span id="valSens" class="text-emerald-600 font-bold">99%</span>
              </div>
              <input type="range" id="inpSens" min="50" max="100" step="0.5" value="99"
                class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer">
            </div>
            <div>
              <div class="flex justify-between text-sm mb-1">
                <label class="font-bold text-slate-700">Especificidad (TN)</label>
                <span id="valSpec" class="text-blue-600 font-bold">99%</span>
              </div>
              <input type="range" id="inpSpec" min="50" max="100" step="0.5" value="99"
                class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer">
            </div>

            <div class="pt-4 border-t border-slate-200">
              <p class="text-xs uppercase font-bold text-slate-400">Probabilidad Real (VPP)</p>
              <div class="text-4xl font-bold text-slate-900 mt-1" id="resPpv">9.0%</div>
              <div class="text-xs text-slate-500 mt-2" id="resText">1 de cada 11 positivos es real.</div>
            </div>
          </div>

          <!-- Panel Visualización Dual -->
          <div class="lg:col-span-8 p-6 bg-white">
            <!-- Pestañas Visuales -->
            <div class="flex space-x-4 mb-4 border-b border-slate-100 pb-2">
              <button onclick="setVisualMode('dots')" id="tabDots"
                class="text-sm font-bold text-indigo-600 border-b-2 border-indigo-600 pb-2">Iconos (Personas)</button>
              <button onclick="setVisualMode('area')" id="tabArea"
                class="text-sm font-medium text-slate-500 hover:text-indigo-600 pb-2 transition">Geometría
                (Áreas)</button>
            </div>

            <!-- Modo Iconos -->
            <div id="viewDots" class="block">
              <div id="iconGrid" class="grid grid-cols-25 gap-px w-full h-64 content-start overflow-hidden"></div>
              <div class="flex gap-4 mt-4 text-[10px] md:text-xs text-slate-500 justify-center">
                <div class="flex items-center"><span class="w-2 h-2 rounded-full bg-red-600 mr-1"></span> Enfermo
                  Detectado (TP)</div>
                <div class="flex items-center"><span class="w-2 h-2 rounded-full bg-orange-400 mr-1"></span> Falsa
                  Alarma (FP)</div>
                <div class="flex items-center"><span class="w-2 h-2 rounded-full bg-slate-200 mr-1"></span> Sano (TN)
                </div>
              </div>
            </div>

            <!-- Modo Área (3Blue1Brown Style) -->
            <div id="viewArea" class="hidden h-64 relative border-2 border-slate-800 bg-slate-100 rounded">
              <!-- Este es el cuadrado unitario -->
              <div class="absolute inset-0 flex">
                <!-- Columna Izquierda: Enfermos (Ancho = Prevalencia) -->
                <div id="areaSickCol"
                  class="h-full flex flex-col border-r border-white bg-red-100 relative transition-all duration-300"
                  style="width: 10%">
                  <div class="absolute -top-6 left-0 text-xs font-bold text-red-700 w-48">Enfermos (Prior)</div>
                  <!-- Parte Superior: Detectados -->
                  <div id="areaTp" class="w-full bg-red-600 transition-all duration-300 relative group"
                    style="height: 90%">
                    <span
                      class="absolute inset-0 flex items-center justify-center text-white text-xs font-bold opacity-0 group-hover:opacity-100">TP</span>
                  </div>
                  <!-- Parte Inferior: No Detectados -->
                  <div class="flex-grow"></div>
                </div>

                <!-- Columna Derecha: Sanos (Ancho = 1 - Prevalencia) -->
                <div class="h-full flex-grow flex flex-col bg-slate-200 relative">
                  <div class="absolute -top-6 right-0 text-xs font-bold text-slate-500">Sanos</div>
                  <!-- Parte Superior: Falsos Positivos -->
                  <div id="areaFp" class="w-full bg-orange-400 transition-all duration-300 relative group"
                    style="height: 10%">
                    <span
                      class="absolute inset-0 flex items-center justify-center text-white text-xs font-bold opacity-0 group-hover:opacity-100">FP</span>
                  </div>
                  <!-- Parte Inferior: Verdaderos Negativos -->
                  <div class="flex-grow"></div>
                </div>
              </div>

              <!-- Overlay explicativo -->
              <div
                class="absolute bottom-2 right-2 bg-white/90 p-2 rounded text-xs shadow border border-slate-200 max-w-xs">
                Compara el tamaño del área <span class="text-red-600 font-bold">ROJA</span> vs la <span
                  class="text-orange-500 font-bold">NARANJA</span>. <br>
                VPP = Área Roja / (Área Roja + Naranja)
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

  </main>

  <footer class="text-center py-10 text-slate-400 text-sm">
    <p>Inspirado en Veritasium y 3Blue1Brown | Powersemiotics Educational</p>
  </footer>

  <script>
    // State
    let state = { prev: 0.1, sens: 99, spec: 99 };
    const population = 1000;

    // Elements
    const inpPrev = document.getElementById('inpPrev');
    const inpSens = document.getElementById('inpSens');
    const inpSpec = document.getElementById('inpSpec');
    const valPrev = document.getElementById('valPrev');
    const valSens = document.getElementById('valSens');
    const valSpec = document.getElementById('valSpec');
    const resPpv = document.getElementById('resPpv');
    const resText = document.getElementById('resText');
    const iconGrid = document.getElementById('iconGrid');

    // Area Elements
    const areaSickCol = document.getElementById('areaSickCol');
    const areaTp = document.getElementById('areaTp');
    const areaFp = document.getElementById('areaFp');

    // Listeners
    inpPrev.addEventListener('input', (e) => updateState('prev', e.target.value));
    inpSens.addEventListener('input', (e) => updateState('sens', e.target.value));
    inpSpec.addEventListener('input', (e) => updateState('spec', e.target.value));

    function updateState(key, val) {
      state[key] = parseFloat(val);
      render();
    }

    function setScenario(p, s, sp) {
      state = { prev: p, sens: s, spec: sp };
      inpPrev.value = p;
      inpSens.value = s;
      inpSpec.value = sp;
      render();
    }

    function setVisualMode(mode) {
      const dots = document.getElementById('viewDots');
      const area = document.getElementById('viewArea');
      const tabDots = document.getElementById('tabDots');
      const tabArea = document.getElementById('tabArea');

      if (mode === 'dots') {
        dots.classList.remove('hidden');
        area.classList.add('hidden');
        tabDots.className = "text-sm font-bold text-indigo-600 border-b-2 border-indigo-600 pb-2";
        tabArea.className = "text-sm font-medium text-slate-500 hover:text-indigo-600 pb-2 transition";
      } else {
        dots.classList.add('hidden');
        area.classList.remove('hidden');
        tabArea.className = "text-sm font-bold text-indigo-600 border-b-2 border-indigo-600 pb-2";
        tabDots.className = "text-sm font-medium text-slate-500 hover:text-indigo-600 pb-2 transition";
      }
    }

    function render() {
      // Update labels
      valPrev.innerText = state.prev + '%';
      valSens.innerText = state.sens + '%';
      valSpec.innerText = state.spec + '%';

      // Calc
      const prevDec = state.prev / 100;
      const sensDec = state.sens / 100;
      const specDec = state.spec / 100;

      const sickCount = population * prevDec; // Can be float
      const healthyCount = population - sickCount;

      const tp = sickCount * sensDec;
      const fn = sickCount - tp;

      const tn = healthyCount * specDec;
      const fp = healthyCount - tn;

      const allPos = tp + fp;
      const ppv = allPos === 0 ? 0 : (tp / allPos);
      const ppvPerc = (ppv * 100).toFixed(1);

      // Update Text Results
      resPpv.innerText = ppvPerc + '%';
      const ratio = Math.round(1 / ppv);
      resText.innerText = `Significa que aprox 1 de cada ${ratio} positivos es real.`;
      if (ratio < 2) resText.innerText = "¡El resultado es muy confiable!";

      // Render Dots (Rounding for visuals)
      iconGrid.innerHTML = '';
      const frag = document.createDocumentFragment();

      // Visual Limit: 1000 dots.
      // Order: TP -> FN -> FP -> TN
      const rTp = Math.round(tp);
      const rFn = Math.round(fn);
      const rFp = Math.round(fp);
      const rTn = 1000 - rTp - rFn - rFp; // Fill rest

      const addDot = (color) => {
        const d = document.createElement('div');
        d.className = `w-1.5 h-1.5 rounded-full ${color} mx-auto`;
        frag.appendChild(d);
      }

      for (let i = 0; i < rTp; i++) addDot('bg-red-600');
      for (let i = 0; i < rFn; i++) addDot('bg-red-200 opacity-50'); // Missed
      for (let i = 0; i < rFp; i++) addDot('bg-orange-400');
      for (let i = 0; i < rTn; i++) addDot('bg-slate-200');

      iconGrid.appendChild(frag);

      // Render Area (Geometry)
      // Width of Sick Column = Prevalencia
      // Height of TP block = Sensibilidad
      // Height of FP block = (1 - Especificidad) -> Wait, Specification is TN rate. False Positive Rate = 1 - Specificity.

      areaSickCol.style.width = state.prev + '%';
      areaTp.style.height = state.sens + '%';

      // El bloque naranja en la columna de sanos representa la Tasa de Falsos Positivos (100 - Especificidad)
      const fpRate = 100 - state.spec;
      areaFp.style.height = fpRate + '%';
    }

    // Init
    render();

  </script>
</body>

</html>