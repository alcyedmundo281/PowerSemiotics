<!DOCTYPE html>
<html class="light" lang="es">

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <title>Autoevaluación: ERGE - PowerSemiotics</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com" rel="preconnect" />
  <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
  <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700;900&amp;display=swap"
    rel="stylesheet" />
  <link
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
    rel="stylesheet" />

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

  <!-- Tailwind Configuration -->
  <script id="tailwind-config">
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            "primary": "#8B3DFF", // PowerSemiotics Purple
            "secondary": "#FF4081",
            "background-light": "#f6f7f8",
            "background-dark": "#101922",
            "surface-light": "#ffffff",
            "surface-dark": "#1a242d",
            "border-light": "#e2e8f0",
            "border-dark": "#2d3748",
          },
          fontFamily: {
            "display": ["Lexend", "sans-serif"]
          },
          borderRadius: {
            "DEFAULT": "0.5rem",
            "lg": "0.75rem",
            "xl": "1rem",
            "full": "9999px"
          },
        },
      },
    }
  </script>

  <style>
    .gradient-text {
      background: linear-gradient(135deg, #8B3DFF 0%, #FF4081 100%);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    /* Custom radio styling from Stitch */
    .sr-only-input {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border-width: 0;
    }

    input[type="radio"]:checked+div {
      border-color: #8B3DFF;
      background-color: rgba(139, 61, 255, 0.05);
    }

    input[type="radio"]:checked+div .radio-circle {
      border-color: #8B3DFF;
      background-color: #8B3DFF;
      box-shadow: 0 0 0 3px rgba(139, 61, 255, 0.2);
    }

    input[type="radio"]:checked+div .radio-dot {
      opacity: 1;
    }

    .question-card.correct {
      border-color: #10b981;
      background-color: rgba(16, 185, 129, 0.02);
    }

    .question-card.incorrect {
      border-color: #ef4444;
      background-color: rgba(239, 68, 68, 0.02);
    }

    .feedback-correct {
      background-color: #ecfdf5;
      color: #065f46;
      border: 1px solid #a7f3d0;
    }

    .feedback-incorrect {
      background-color: #fef2f2;
      color: #991b1b;
      border: 1px solid #fecaca;
    }
  </style>
</head>

<body
  class="bg-background-light dark:bg-background-dark text-slate-900 dark:text-slate-100 font-display transition-colors duration-200">

  <!-- Top Navigation -->
  <header
    class="sticky top-0 z-50 flex items-center justify-between whitespace-nowrap border-b border-border-light dark:border-border-dark bg-surface-light dark:bg-surface-dark px-6 py-4 shadow-sm">
    <div class="flex items-center gap-4">
      <a href="index.html" class="flex items-center gap-3">
        <div class="size-10 bg-primary flex items-center justify-center text-white font-bold text-xl rounded-lg">P</div>
        <h2 class="text-xl font-bold leading-tight tracking-tight gradient-text">Powersemiotics</h2>
      </a>
    </div>
    <div class="flex items-center gap-6">
      <a href="gastroenterologia.html"
        class="hidden md:flex text-sm font-semibold text-primary hover:text-secondary transition-colors">Gastroenterología</a>
      <button
        class="flex size-10 cursor-pointer items-center justify-center rounded-lg bg-background-light dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors"
        onclick="document.documentElement.classList.toggle('dark')">
        <span class="material-symbols-outlined text-xl">dark_mode</span>
      </button>
    </div>
  </header>

  <div class="layout-container flex flex-col md:flex-row max-w-7xl mx-auto w-full p-4 md:p-6 lg:p-8 gap-8">

    <!-- Main Assessment Column -->
    <main class="flex-1 min-w-0 flex flex-col gap-8">
      <div
        class="bg-surface-light dark:bg-surface-dark p-8 rounded-2xl border border-border-light dark:border-border-dark shadow-sm">
        <div class="inline-block px-3 py-1 bg-primary/10 rounded-full mb-4">
          <span class="text-xs font-bold text-primary uppercase tracking-widest">Autoevaluación</span>
        </div>
        <h1 class="text-3xl md:text-4xl font-black leading-tight tracking-tight mb-4">Módulo de Gastroenterología</h1>
        <p class="text-slate-500 dark:text-slate-400 font-medium">
          Pon a prueba tus conocimientos sobre fisiopatología y clínica digestiva. Todas las preguntas están basadas en
          guías actuales.
        </p>
      </div>

      <form id="quiz" class="space-y-6">
        <!-- Question Template Loop -->

        <!-- Helper for generating question cards -->
        <script>
          const renderQuestion = (id, title, questionText, options, answer, explanation) => {
            return `
                        <div class="question question-card bg-surface-light dark:bg-surface-dark p-6 rounded-2xl border border-border-light dark:border-border-dark shadow-sm transition-all" data-answer="${answer}" data-explanation="${explanation}">
                            <div class="flex items-center gap-3 mb-4">
                                <span class="size-8 rounded-full bg-primary/10 text-primary flex items-center justify-center font-bold">${id}</span>
                                <h4 class="text-lg font-bold text-slate-900 dark:text-white leading-tight">${title}</h4>
                            </div>
                            <p class="text-slate-600 dark:text-slate-300 mb-6">${questionText}</p>
                            <div class="grid gap-3">
                                ${options.map((opt, i) => `
                                    <label class="relative cursor-pointer group">
                                        <input class="sr-only-input" name="q${id}" type="radio" value="${['A', 'B', 'C', 'D'][i]}">
                                        <div class="flex items-center gap-4 p-4 rounded-xl border border-border-light dark:border-border-dark bg-slate-50 dark:bg-slate-800/50 group-hover:border-primary/50 transition-all">
                                            <div class="flex-shrink-0 size-5 rounded-full border border-slate-300 dark:border-slate-500 radio-circle flex items-center justify-center transition-colors">
                                                <div class="size-2 rounded-full bg-white opacity-0 radio-dot transition-opacity"></div>
                                            </div>
                                            <span class="font-medium text-slate-700 dark:text-slate-200">${opt}</span>
                                        </div>
                                    </label>
                                `).join('')}
                            </div>
                            <p class="mt-4 p-4 rounded-lg text-sm hidden feedback"></p>
                        </div>
                        `;
          };

          const questionsData = [
            {
              id: 1, title: "Mecanismo del reflujo",
              text: "¿Cuál es el mecanismo fisiopatológico principal del reflujo gastroesofágico?",
              options: ["Hipersecreción gástrica de gastrina.", "Obstrucción pilórica funcional.", "Relajaciones transitorias del esfínter esofágico inferior.", "Hipomotilidad colónica."],
              answer: "C", explanation: "La relajación transitoria del esfínter esofágico inferior permite el reflujo ácido hacia el esófago."
            },
            {
              id: 2, title: "Génesis de la úlcera",
              text: "En la úlcera péptica, ¿qué factor etiológico es más relevante en su génesis?",
              options: ["Dieta rica en fibra.", "Infección por Helicobacter pylori.", "Uso de antiácidos.", "Consumo moderado de alcohol."],
              answer: "B", explanation: "Helicobacter pylori incrementa la secreción ácida y produce inflamación que favorece la úlcera."
            },
            {
              id: 3, title: "Hemorragia digestiva",
              text: "En la hemorragia digestiva alta por várices esofágicas, ¿cuál es la intervención de primera línea?",
              options: ["Ligadura endoscópica de várices.", "Somatostatina en infusión sin endoscopia.", "Derivación portosistémica inmediata.", "Reposición de hierro oral."],
              answer: "A", explanation: "La ligadura endoscópica se recomienda como tratamiento inicial en hemorragia digestiva alta por várices."
            },
            {
              id: 4, title: "Pancreatitis aguda",
              text: "En un paciente con dolor epigástrico irradiado a espalda y vómitos, ¿qué dato apoya el diagnóstico de pancreatitis aguda?",
              options: ["Amilasa urinaria normal.", "Bilirrubina directa elevada sin dolor.", "Hipocalcemia leve sin síntomas.", "Lipasa sérica >3 veces el límite superior normal."],
              answer: "D", explanation: "La elevación marcada de lipasa es característica de pancreatitis aguda."
            },
            {
              id: 5, title: "Cirrosis: Child-Pugh",
              text: "¿Qué parámetros se consideran en la clasificación de Child-Pugh para cirrosis?",
              options: ["Edad y nivel de fosfatasa alcalina.", "Bilirrubina, albúmina, INR, ascitis y encefalopatía.", "Creatinina, hematocrito y sodio.", "Ecografía hepática y peso corporal."],
              answer: "B", explanation: "La clasificación Child-Pugh emplea bilirrubina, albúmina, INR, ascitis y encefalopatía."
            },
            {
              id: 6, title: "Ictericia obstructiva",
              text: "¿Qué hallazgo sugiere ictericia de origen obstructivo?",
              options: ["Bilirrubina directa elevada con heces hipocolóricas.", "Bilirrubina indirecta elevada en hemólisis.", "Urobilinógeno urinario aumentado.", "Hipoglucemia severa."],
              answer: "A", explanation: "La elevación de bilirrubina conjugada y acolia sugiere colestasis con ictericia obstructiva."
            },
            {
              id: 7, title: "Inflamación intestinal",
              text: "¿Cuál es un componente importante en la patogénesis de la enfermedad inflamatoria intestinal?",
              options: ["Deficiencia de vitamina C.", "Exceso de fibra dietaria.", "Hipertensión portal.", "Respuesta inmunitaria alterada frente a la microbiota intestinal."],
              answer: "D", explanation: "Respuesta inmunitaria alterada frente a la microbiota intestinal se relaciona con EII."
            },
            {
              id: 8, title: "Hepatitis B",
              text: "¿Cuál es la medida más efectiva para prevenir hepatitis B crónica?",
              options: ["Uso de probióticos.", "Terapia con lactulosa.", "Vacunación frente al virus de hepatitis B.", "Uso crónico de antivirales."],
              answer: "C", explanation: "La vacuna contra hepatitis B previene la infección por el virus correspondiente."
            },
            {
              id: 9, title: "TCE Hepático",
              text: "En pacientes con cirrosis hepática, ¿cuál es la estrategia de tamizaje recomendada para carcinoma hepatocelular?",
              options: ["Ecografía abdominal cada 6 meses.", "Resonancia magnética mensual.", "Biopsia hepática anual.", "Tomografía diaria."],
              answer: "A", explanation: "Los pacientes con cirrosis deben someterse a ecografía semestral para tamizaje de CHC."
            },
            {
              id: 10, title: "Enfermedad celíaca",
              text: "¿Qué hallazgo es típico de la enfermedad celíaca?",
              options: ["Hiperplasia de criptas con aumento de vellosidades.", "Atrofia de vellosidades intestinales con diarrea crónica.", "Sobrecrecimiento bacteriano con estreñimiento.", "Absorción aumentada de hierro."],
              answer: "B", explanation: "La malabsorción de gluten ocasiona atrofia de vellosidades en enfermedad celíaca."
            },
            {
              id: 11, title: "Hemorroides",
              text: "¿Cuál es una característica de las hemorroides internas sintomáticas?",
              options: ["Dolor intenso perianal.", "Fiebre y leucocitosis.", "Secreción purulenta.", "Sangrado rojo brillante sin dolor."],
              answer: "D", explanation: "Las hemorroides internas suelen presentar sangrado indoloro con evacuaciones."
            },
            {
              id: 12, title: "Ascitis",
              text: "¿Cuál es la causa más frecuente de ascitis en el mundo occidental?",
              options: ["Cirrosis hepática.", "Insuficiencia cardíaca derecha.", "Síndrome nefrótico.", "Peritonitis tuberculosa."],
              answer: "A", explanation: "La insuficiencia hepática avanzada conduce a hipoalbuminemia y ascitis."
            },
            {
              id: 13, title: "Encefalopatía",
              text: "¿Cuál es el tratamiento de primera línea para encefalopatía hepática?",
              options: ["Transfusión de plaquetas.", "Vitaminas del complejo B.", "Lactulosa oral para reducir el amonio.", "Inhibidores de bomba de protones."],
              answer: "C", explanation: "La encefalopatía hepática se trata inicialmente con lactulosa."
            },
            {
              id: 14, title: "Gastroenteritis",
              text: "¿Qué hallazgo orienta hacia una gastroenteritis bacteriana frente a una viral?",
              options: ["Inicio súbito de vómitos sin fiebre.", "Presencia de sangre o moco en las heces con fiebre.", "Astenia prolongada sin diarrea.", "Ausencia de dolor abdominal."],
              answer: "B", explanation: "La presencia de sangre o moco en heces sugiere origen bacteriano."
            },
            {
              id: 15, title: "Colelitiasis",
              text: "¿Cuál es una causa frecuente de colelitiasis en adultos?",
              options: ["Hipersecreción pancreática.", "Insuficiencia renal crónica.", "Ausencia de vesícula biliar.", "Cálculos de colesterol por supersaturación biliar."],
              answer: "D", explanation: "Causa común por desequilibrio en componentes de la bilis."
            },
            {
              id: 16, title: "HDB",
              text: "¿Cuál es una causa común de hemorragia digestiva baja en adultos mayores?",
              options: ["Gastritis erosiva.", "Diverticulosis colónica.", "Úlcera gástrica perforada.", "Colecistitis aguda."],
              answer: "B", explanation: "Diverticulosis es una causa prevalente en esta población."
            },
            {
              id: 17, title: "Esofagitis",
              text: "¿Qué hallazgo histológico caracteriza la esofagitis eosinofílica?",
              options: ["Infiltrado eosinofílico denso en la mucosa esofágica.", "Metaplasia intestinal de Barrett.", "Atrofia de vellosidades duodenales.", "Necrosis isquémica transmural."],
              answer: "A", explanation: "Infiltración eosinofílica es el marcador diagnóstico."
            },
            {
              id: 18, title: "Colangitis biliar",
              text: "¿Qué característica distingue a la colangitis biliar primaria?",
              options: ["Obstrucción biliar por cálculos.", "Infección bacteriana recurrente.", "Presencia de anticuerpos antimitochondriales.", "Asociación con pancreatitis."],
              answer: "C", explanation: "Enfermedad autoinmunitaria asociada a AMA."
            },
            {
              id: 19, title: "Várices esofágicas",
              text: "¿Qué terapia se utiliza para prevenir la primera hemorragia por várices esofágicas?",
              options: ["Nitratos orales.", "Betabloqueadores no selectivos.", "Somatostatina diaria.", "Hierro intravenoso."],
              answer: "B", explanation: "Reducen la presión portal y riesgo de sangrado."
            },
            {
              id: 20, title: "Insuficiencia aguda",
              text: "¿Qué define a la insuficiencia hepática aguda?",
              options: ["Encefalopatía y coagulopatía sin cirrosis previa.", "Ascitis crónica en paciente cirrótico.", "Elevación aislada de FA.", "Hepatitis B crónica."],
              answer: "A", explanation: "Falla masiva súbita en hígado previamente sano."
            }
          ];

          document.write(questionsData.map(q => renderQuestion(q.id, q.title, q.text, q.options, q.answer, q.explanation)).join(''));
        </script>

        <!-- Action Button Mobile -->
        <div class="lg:hidden mt-8">
          <button type="button" onclick="checkAnswers()"
            class="w-full bg-primary hover:bg-secondary text-white font-bold py-4 rounded-xl shadow-lg transition-all flex items-center justify-center gap-2">
            <span>REVISAR EVALUACIÓN</span>
            <span class="material-symbols-outlined">send</span>
          </button>
        </div>
      </form>
    </main>

    <!-- Sidebar Progress Column -->
    <aside class="hidden lg:block w-80 flex-shrink-0">
      <div class="sticky top-24 space-y-6">
        <!-- Score Card -->
        <div
          class="bg-surface-light dark:bg-surface-dark rounded-2xl border border-border-light dark:border-border-dark shadow-lg overflow-hidden">
          <div class="bg-slate-50 dark:bg-slate-800 p-4 border-b border-border-light dark:border-border-dark">
            <h2 class="font-bold text-slate-800 dark:text-slate-200 flex items-center gap-2">
              <span class="material-symbols-outlined text-primary">analytics</span>
              Tu Puntuación
            </h2>
          </div>
          <div class="p-8 flex flex-col items-center justify-center text-center">
            <div id="live-score"
              class="text-7xl font-black text-slate-900 dark:text-white leading-none tracking-tighter mb-2">0</div>
            <p class="text-slate-500 dark:text-slate-400 font-medium text-lg">de 20 aciertos</p>
          </div>
          <div class="px-6 pb-6">
            <div id="score-tag"
              class="bg-blue-50 dark:bg-blue-900/30 border border-blue-100 dark:border-blue-800 rounded-xl p-4 text-center">
              <span class="text-xs font-bold text-blue-600 dark:text-blue-400 uppercase tracking-wider">Estado</span>
              <p id="score-message" class="text-md font-bold text-blue-800 dark:text-blue-200 leading-tight mt-1">
                Realiza el test para ver resultados</p>
            </div>
          </div>
        </div>

        <!-- Actions Card -->
        <div
          class="bg-surface-light dark:bg-surface-dark rounded-2xl border border-border-light dark:border-border-dark shadow-sm p-6">
          <button type="button" onclick="checkAnswers()"
            class="w-full bg-primary hover:bg-secondary text-white font-bold py-4 rounded-xl shadow-lg shadow-primary/20 transition-all flex items-center justify-center gap-2 group">
            <span>REVISAR AHORA</span>
            <span class="material-symbols-outlined group-hover:translate-x-1 transition-transform">arrow_forward</span>
          </button>
          <button type="button" onclick="window.location.reload()"
            class="w-full mt-3 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 font-bold py-3 rounded-xl border border-border-light dark:border-border-dark transition-all flex items-center justify-center gap-2">
            <span class="material-symbols-outlined text-lg">restart_alt</span>
            <span>Reiniciar</span>
          </button>
        </div>

        <!-- Info Card -->
        <div class="bg-slate-900 text-white rounded-2xl p-6 shadow-xl relative overflow-hidden">
          <div class="absolute -right-4 -top-4 w-24 h-24 bg-primary/20 rounded-full blur-2xl"></div>
          <h3 class="font-bold mb-2 flex items-center gap-2 text-sm">
            <span class="material-symbols-outlined text-primary text-base">verified</span>
            Power Tip
          </h3>
          <p class="text-[11px] text-slate-400 leading-relaxed">
            El aprendizaje basado en el error es la herramienta más potente. Revisa las explicaciones incluso en tus
            aciertos.
          </p>
        </div>
      </div>
    </aside>
  </div>

  <footer class="bg-surface-light dark:bg-surface-dark border-t border-border-light dark:border-border-dark mt-20">
    <div class="container mx-auto px-6 py-10 flex flex-col items-center gap-4 text-center">
      <div class="flex items-center gap-2">
        <div class="size-6 bg-slate-300 dark:bg-slate-700 rounded-md"></div>
        <span class="font-bold text-slate-900 dark:text-white">Powersemiotics</span>
      </div>
      <p class="text-gray-500 text-sm italic">&copy; 2025 Powersemiotics. Formación Médica de Alto Nivel.</p>
    </div>
  </footer>

  <script>
    function checkAnswers() {
      const questions = document.querySelectorAll('.question');
      const totalQuestions = questions.length;
      let score = 0;

      questions.forEach((q, index) => {
        const qName = 'q' + (index + 1);
        const selected = q.querySelector(`input[name="${qName}"]:checked`);
        const correctAnswer = q.getAttribute('data-answer');
        const explanation = q.getAttribute('data-explanation');
        const feedback = q.querySelector('.feedback');

        // Reset states
        q.classList.remove('correct', 'incorrect');
        feedback.className = "mt-4 p-4 rounded-lg text-sm hidden feedback";

        if (selected) {
          if (selected.value === correctAnswer) {
            score++;
            q.classList.add('correct');
            feedback.innerHTML = `<div class="flex items-start gap-2 text-green-700 font-bold"><span class="material-symbols-outlined text-lg">check_circle</span> <span>¡Correcto!</span></div><p class="mt-1 text-green-600">${explanation}</p>`;
            feedback.classList.remove('hidden');
            feedback.classList.add('feedback-correct');
          } else {
            q.classList.add('incorrect');
            feedback.innerHTML = `<div class="flex items-start gap-2 text-red-700 font-bold"><span class="material-symbols-outlined text-lg">cancel</span> <span>Incorrecto</span></div><p class="mt-1 text-red-600">La respuesta correcta es la <b>${correctAnswer}</b>. ${explanation}</p>`;
            feedback.classList.remove('hidden');
            feedback.classList.add('feedback-incorrect');
          }
        } else {
          // Not answered
          q.classList.add('incorrect');
          feedback.innerHTML = `<div class="flex items-start gap-2 text-amber-700 font-bold"><span class="material-symbols-outlined text-lg">warning</span> <span>Sin respuesta</span></div><p class="mt-1 text-amber-600">La respuesta correcta era la <b>${correctAnswer}</b>.</p>`;
          feedback.classList.remove('hidden');
          feedback.classList.add('bg-amber-50', 'text-amber-800', 'border', 'border-amber-200');
        }
      });

      // Update Sidebar Score
      const scoreDisplay = document.getElementById('live-score');
      const scoreMsg = document.getElementById('score-message');
      const scoreTag = document.getElementById('score-tag');

      scoreDisplay.innerText = score;

      if (score === totalQuestions) {
        scoreMsg.innerText = "¡Excelente! Dominio total.";
        scoreTag.className = "bg-green-50 dark:bg-green-900/30 border border-green-100 dark:border-green-800 rounded-xl p-4 text-center";
      } else if (score >= totalQuestions * 0.8) {
        scoreMsg.innerText = "¡Muy bien! Casi perfecto.";
        scoreTag.className = "bg-green-50 dark:bg-green-900/30 border border-green-100 dark:border-green-800 rounded-xl p-4 text-center";
      } else if (score >= totalQuestions / 2) {
        scoreMsg.innerText = "Buen intento. Sigue repasando.";
        scoreTag.className = "bg-blue-50 dark:bg-blue-900/30 border border-blue-100 dark:border-blue-800 rounded-xl p-4 text-center";
      } else {
        scoreMsg.innerText = "Necesitas reforzar conceptos.";
        scoreTag.className = "bg-red-50 dark:bg-red-900/30 border border-red-100 dark:border-red-800 rounded-xl p-4 text-center";
      }

      // Smooth scroll to results on mobile, or just let them see sidebar on desktop
      if (window.innerWidth < 1024) {
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
    }
  </script>
</body>

</html>