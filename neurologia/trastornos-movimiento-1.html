<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Trastornos del Movimiento | Neuro ‚Äî PowerSemiotics</title>
  <meta name="description" content="Resumen claro, navegable y visualmente limpio de los trastornos del movimiento: temblor, parkinsonismo, diston√≠a, corea, ataxia, tics y mioclon√≠as." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=IBM+Plex+Serif:wght@400;600&display=swap" rel="stylesheet">
  <link href="../assets/tailwind.css" rel="stylesheet" />
  <style>
    :root{
      --bg:#0b0d12;               /* deep slate */
      --panel:#0f1219;            /* panel background */
      --panel-2:#121622;          /* secondary panel */
      --ink:#e6e8ef;              /* main text */
      --muted:#b3b7c6;           /* secondary text */
      --brand:#6db2ff;            /* accent */
      --brand-2:#9ad2ff;          /* accent light */
      --ok:#49d38a;               /* positive */
      --warn:#ffcc66;             /* warning */
      --bad:#ff7a7a;              /* negative */
      --border:#1f2636;           /* borders */
      --code:#0b1220;             /* code bg */
      --shadow: 0 8px 30px rgba(0,0,0,.35);
      --radius-xl: 18px;
      --radius: 12px;
      --radius-sm: 8px;
      --w-wide: 1200px;
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg:#f7f8fb;
        --panel:#ffffff;
        --panel-2:#f2f4f8;
        --ink:#1b2230;
        --muted:#56607a;
        --brand:#2563eb;
        --brand-2:#60a5fa;
        --ok:#16a34a;
        --warn:#b45309;
        --bad:#dc2626;
        --border:#e6e9f2;
        --code:#f1f5f9;
        --shadow: 0 10px 24px rgba(16, 24, 40, .08);
      }
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:linear-gradient(180deg,var(--bg),#0c1018 60%,var(--bg));
      color:var(--ink); font: 400 16px/1.65 Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif;
      -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
    }
    a{color:var(--brand); text-decoration:none}
    a:hover{text-decoration:underline}
    .container{max-width:var(--w-wide); margin:0 auto; padding:24px}

    /* Topbar */
    .topbar{position:sticky; top:0; z-index:40; backdrop-filter: blur(8px); background:color-mix(in oklab, var(--bg) 75%, transparent); border-bottom:1px solid var(--border)}
    .topbar-inner{display:flex; align-items:center; gap:16px; min-height:64px}
    .logo{display:flex; align-items:center; gap:10px; font-weight:800; letter-spacing:.2px}
    .logo-mark{width:28px; height:28px; border-radius:8px; background: radial-gradient(120% 120% at 80% 20%, var(--brand-2), var(--brand)); box-shadow: inset 0 0 20px rgba(255,255,255,.25)}
    .breadcrumbs{color:var(--muted); font-size:14px}
    .breadcrumbs a{color:inherit}

    /* Hero */
    .hero{padding:28px 0 6px}
    .hero h1{font:800 46px/1.1 Inter, system-ui; letter-spacing:-.02em; margin:4px 0}
    .hero p{max-width:70ch; color:var(--muted); margin:6px 0 0}
    .badges{display:flex; gap:10px; margin-top:14px; flex-wrap:wrap}
    .badge{font-size:12px; padding:6px 10px; border:1px solid var(--border); border-radius:999px; color:var(--muted); background:var(--panel)}

    /* Layout */
    .layout{display:grid; grid-template-columns: 280px 1fr; gap:24px}
    @media (max-width: 1024px){ .layout{grid-template-columns: 1fr} }

    /* TOC */
    .toc{position:sticky; top:88px; align-self:start; border:1px solid var(--border); background:var(--panel); border-radius:var(--radius); padding:14px; box-shadow:var(--shadow)}
    .toc h3{margin:6px 6px 10px; font-weight:700; font-size:14px; letter-spacing:.02em; text-transform:uppercase; color:var(--muted)}
    .toc nav{max-height:70vh; overflow:auto; padding-right:6px}
    .toc a{display:block; padding:8px 10px; border-radius:10px; color:var(--ink); border:1px dashed transparent}
    .toc a:hover{background:var(--panel-2)}
    .toc a.active{border-color:var(--brand); background:color-mix(in oklab, var(--brand) 18%, var(--panel)); box-shadow: inset 0 0 0 1px color-mix(in oklab, var(--brand) 50%, transparent)}

    /* Content */
    .content{display:grid; gap:16px}
    .card{background:var(--panel); border:1px solid var(--border); border-radius:var(--radius-xl); padding:22px; box-shadow:var(--shadow)}
    .card h2, .card h3{scroll-margin-top:96px}
    .eyebrow{font-weight:600; color:var(--muted); letter-spacing:.06em; text-transform:uppercase; font-size:12px}
    .title{font:700 28px/1.25 Inter, system-ui; margin:6px 0 12px}
    .lede{color:var(--muted); margin:0 0 10px}

    /* Callouts */
    .callout{display:grid; grid-template-columns: 28px 1fr; gap:12px; border:1px solid var(--border); background:var(--panel-2); padding:14px; border-radius:var(--radius)}
    .callout.ok{border-left:4px solid var(--ok)}
    .callout.warn{border-left:4px solid var(--warn)}
    .callout.bad{border-left:4px solid var(--bad)}

    /* Definition list */
    dl {display:grid; grid-template-columns: 220px 1fr; gap:12px 18px; margin:12px 0}
    dt {color:var(--muted)}
    dd {margin:0}
    @media (max-width: 700px){ dl{grid-template-columns: 1fr} }

    /* Accordions */
    details{border:1px solid var(--border); border-radius:12px; padding:14px 14px; background:var(--panel-2)}
    details + details{margin-top:10px}
    summary{cursor:pointer; list-style:none; font-weight:600}
    summary::-webkit-details-marker{display:none}
    summary .caret{display:inline-block; width:10px; height:10px; margin-right:8px; transform:rotate(-90deg); transition:.2s}
    details[open] summary .caret{transform:rotate(0)}

    /* Legacy accordion blocks */
    .accordion-content{max-height:0; overflow:hidden; transition:max-height .3s ease}
    .accordion-button.active .accordion-icon{transform:rotate(180deg)}

    /* Tables */
    .table-wrap{overflow:auto; border:1px solid var(--border); border-radius:12px; background:var(--panel-2)}
    table{width:100%; border-collapse:collapse; font-size:14px}
    th, td{padding:10px 12px; border-bottom:1px solid var(--border)}
    th{position:sticky; top:0; background:var(--panel); text-align:left}
    tbody tr:hover{background:color-mix(in oklab, var(--panel-2) 80%, var(--panel))}

    /* Footer */
    footer{color:var(--muted); font-size:14px; padding:24px 0 60px}

    /* Utilities */
    .grid-2{display:grid; grid-template-columns: 1fr 1fr; gap:16px}
    @media (max-width:900px){ .grid-2{grid-template-columns:1fr} }
    .muted{color:var(--muted)}
    .kbd{font: 600 12px/1.1 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; background:var(--code); padding:4px 6px; border-radius:6px; border:1px solid var(--border)}
    .chip{display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px; background:var(--panel-2); border:1px solid var(--border); font-size:12px; color:var(--muted)}
    .sr-only{position:absolute; left:-10000px; top:auto; width:1px; height:1px; overflow:hidden}
    .spacer{height:6px}
    .shadow{box-shadow:var(--shadow)}

    /* Back to top */
    .to-top{position:fixed; right:18px; bottom:18px; padding:10px 12px; background:var(--panel); border:1px solid var(--border); border-radius:10px; display:none}
    .to-top.show{display:inline-flex}
  </style>
</head>
<body>
  <!-- Topbar -->
  <div class="topbar">
    <div class="container topbar-inner">
      <div class="logo" aria-label="PowerSemiotics Neuro">
        <div class="logo-mark" aria-hidden="true"></div>
        <span>PowerSemiotics ¬∑ Neuro</span>
      </div>
      <div class="breadcrumbs" role="navigation" aria-label="Ruta">
        <a href="/">Inicio</a> ¬∑ <a href="/neurologia/">Neurolog√≠a</a> ¬∑ <strong>Trastornos del movimiento</strong>
      </div>
      <div style="margin-left:auto; display:flex; gap:8px; align-items:center">
        <label class="chip" title="Buscar (presiona /)">üîé <input id="q" placeholder="Buscar en la p√°gina‚Ä¶" style="all:unset; width:180px" /> </label>
        <span class="kbd" aria-hidden="true">/</span>
      </div>
    </div>
  </div>

  <main class="container">
    <!-- Hero -->
    <header class="hero">
      <p class="eyebrow">Resumen visual & gu√≠a pr√°ctica</p>
      <h1>Trastornos del movimiento</h1>
      <p class="lede">Clasificaci√≥n cl√≠nica, claves diagn√≥sticas r√°pidas y diferencias clave entre <em>temblor</em>, <em>parkinsonismo</em>, <em>diston√≠a</em>, <em>corea</em>, <em>ataxia</em>, <em>tics</em> y <em>mioclon√≠as</em>. Estructurado para consulta √°gil en guardia o estudio.</p>
      <div class="badges" aria-label="Etiquetas">
        <span class="badge">√öltima revisi√≥n: <time id="last-reviewed">2025-08-19</time></span>
        <span class="badge">Lectura: ~8 min</span>
        <span class="badge">CC BY-NC</span>
      </div>
    </header>

    <!-- Layout -->
    <div class="layout" id="layout">
      <!-- TOC -->
      <aside class="toc" aria-label="Tabla de contenidos">
        <h3>Contenido</h3>
        <nav id="toc"></nav>
      </aside>

      <!-- Content column -->
      <section class="content" id="content">
        <!-- Key Points -->
        <article class="card" id="resumen">
          <p class="eyebrow">Puntos clave</p>
          <h2 class="title">C√≥mo orientar el diagn√≥stico en 60 segundos</h2>
          <div class="grid-2">
            <div class="callout ok">
              <div>‚úÖ</div>
              <div>
                <strong>Fenomenolog√≠a primero.</strong> ¬øEs exceso (hipercin√©tico) o defecto (hipocin√©tico) del movimiento? Observa <em>ritmo</em>, <em>patr√≥n</em>, <em>distractibilidad</em>, <em>respuesta a alcohol</em>, <em>variabilidad</em> y <em>fatigabilidad</em>.
              </div>
            </div>
            <div class="callout warn">
              <div>‚ö†Ô∏è</div>
              <div>
                <strong>Banderas rojas.</strong> Inicio s√∫bito, ataxia aguda, rigidez + fiebre (S. neurol√©ptico), corea con alteraci√≥n de conciencia, diston√≠a lar√≠ngea, mioclon√≠as multifocales con crisis o deterioro subagudo.
              </div>
            </div>
          </div>
        </article>

        <!-- Quick compare table -->
        <article class="card" id="comparativa">
          <p class="eyebrow">Comparativa r√°pida</p>
          <h2 class="title">Diferencias fenomenol√≥gicas</h2>
          <div class="table-wrap">
            <table aria-label="Tabla comparativa de trastornos del movimiento">
              <thead>
                <tr>
                  <th>Entidad</th>
                  <th>Descripci√≥n breve</th>
                  <th>Claves a la exploraci√≥n</th>
                  <th>Perlas</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Temblor</td>
                  <td>Oscilaciones r√≠tmicas</td>
                  <td>Reposo vs. acci√≥n; frecuencia 4‚Äì12 Hz</td>
                  <td>Se aten√∫a con alcohol (TEM esencial)</td>
                </tr>
                <tr>
                  <td>Parkinsonismo</td>
                  <td>Bradicinesia + rigidez ¬± temblor reposo</td>
                  <td>Hipomimia, festinaci√≥n, congelamiento</td>
                  <td>Respuesta a levodopa sugiere EP idiop√°tica</td>
                </tr>
                <tr>
                  <td>Diston√≠a</td>
                  <td>Posturas sostenidas o torsiones</td>
                  <td>Gestos sensoriales (alivio), patr√≥n espec√≠fico</td>
                  <td>Considerar toxina botul√≠nica en focales</td>
                </tr>
                <tr>
                  <td>Corea</td>
                  <td>Movimientos irregulares, fluyentes</td>
                  <td>Vuelan de una zona a otra, suprimibles pobremente</td>
                  <td>Pensar en f√°rmacos, embarazo, Huntington</td>
                </tr>
                <tr>
                  <td>Ataxia</td>
                  <td>Incoordinaci√≥n motora</td>
                  <td>Disdiadococinesia, dismetr√≠a, nistagmo</td>
                  <td>Aguda ‚Üí vascular, t√≥xica o inmune</td>
                </tr>
                <tr>
                  <td>Tics</td>
                  <td>Movimientos/sonidos estereotipados</td>
                  <td>Precedidos por urgencia; suprimibles</td>
                  <td>Rebote post-supresi√≥n es t√≠pico</td>
                </tr>
                <tr>
                  <td>Mioclon√≠as</td>
                  <td>Sacudidas breves, tipo choque</td>
                  <td>Focales/multifocales; est√≠mulo-sensibles</td>
                  <td>EEG y causa metab√≥lica/medicamentosa</td>
                </tr>
              </tbody>
            </table>
          </div>
        </article>

        <!-- Sections (placeholders easily replaceable with contenido actual) -->
        <article class="card" id="temblor">
          <h2 class="title">Temblor</h2>
          <p>Clasificaci√≥n: reposo (parkinsoniano), postural/acci√≥n (esencial), cin√©tico e intencional (cerebeloso). Evaluar frecuencia, amplitud, distribuci√≥n y respuesta a carga/maniobras.</p>
          <details><summary><span class="caret">‚ñ∂</span>Tratamiento</summary>
            <dl>
              <dt>Esencial</dt><dd>Propranolol, primidona; considerar toxina botul√≠nica en cef√°lico y TCE si refractario.</dd>
              <dt>Parkinsoniano</dt><dd>Levodopa, agonistas dopamin√©rgicos.</dd>
              <dt>Cerebeloso</dt><dd>Rehabilitaci√≥n; manejo etiol√≥gico.</dd>
            </dl>
          </details>
        </article>

        <article class="card" id="parkinsonismo">
          <h2 class="title">Parkinsonismo</h2>
          <p>Distinguir EP idiop√°tica de parkinsonismos at√≠picos (MSA, PSP, CBD) y secundarios (f√°rmacos, vascular). Buscar bradicinesia nuclear y signos de alerta: ca√≠das tempranas, disautonom√≠a severa, par√°lisis supranuclear de la mirada, apraxia ideomotora.</p>
          <div class="callout warn"><div>üîé</div><div><strong>Perla:</strong> ¬´Respuesta clara y sostenida¬ª a levodopa favorece EP; ausencia temprana sugiere at√≠pico.</div></div>
        </article>

        <article class="card" id="distonia">
          <h2 class="title">Diston√≠a</h2>
          <p>Focal (cervical, blefaroespasmo), segmentaria o generalizada. Explorar gestos sensoriales (alivio), patr√≥n horario y gatillos. Considerar Wilson, DYT-TOR1A en inicio juvenil.</p>
          <details><summary><span class="caret">‚ñ∂</span>Tratamiento</summary>
            <p>Toxina botul√≠nica en focales; anticolin√©rgicos/benzodiacepinas; estimulaci√≥n cerebral profunda en refractarias.</p>
          </details>
        </article>

        <article class="card" id="corea">
          <h2 class="title">Corea</h2>
          <p>Movimientos impredecibles, fluyentes. Causas: f√°rmacos (levodopa, anticonceptivos), Huntington, corea grav√≠dica, autoinmunes.</p>
        </article>

        <article class="card" id="ataxia">
          <h2 class="title">Ataxia</h2>
          <p>Aguda vs. cr√≥nica. Cerebelosa, sensorial, vestibular. Evaluaci√≥n dirigida con pruebas de coordinaci√≥n y marcha.</p>
        </article>

        <article class="card" id="tics">
          <h2 class="title">Tics</h2>
          <p>Evaluar complejidad, coprolalia rara, comorbilidades (TOC/TDAH). Psicoeducaci√≥n, TCC (CBIT), clonidina/guanfacina; antipsic√≥ticos si graves.</p>
        </article>

        <article class="card" id="mioclonias">
          <h2 class="title">Mioclon√≠as</h2>
          <p>Sacudidas breves; corticales, subcorticales o espinales. Buscar precipitantes: est√≠mulo, f√°rmacos (opioides, ISRS), fallo renal/hep√°tico.</p>
        </article>

        <!-- Interactivity -->
        <article class="card" id="recursos">
          <p class="eyebrow">Recursos interactivos</p>
          <h2 class="title">Aprende haciendo</h2>
          <div id="accordion-container" class="space-y-4">
            <!-- Presentaci√≥n Interactiva -->
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
              <button class="accordion-button w-full flex justify-between items-center p-5 text-left font-semibold text-lg text-gray-800 hover:bg-gray-50 transition-colors">
                <span>Presentaci√≥n interactiva: El espectro cl√≠nico del Parkinson</span>
                <svg class="accordion-icon w-6 h-6 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
              </button>
              <div class="accordion-content">
                <div id="presentation-container-parent" class="p-5 border-t border-gray-200">
                  <!-- El contenido de la presentaci√≥n se cargar√° aqu√≠ -->
                </div>
              </div>
            </div>

            <!-- Actividad ABP -->
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
              <button class="accordion-button w-full flex justify-between items-center p-5 text-left font-semibold text-lg text-gray-800 hover:bg-gray-50 transition-colors">
                <span>Actividad interactiva: ABP - "El caso del temblor unilateral"</span>
                <svg class="accordion-icon w-6 h-6 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
              </button>
              <div class="accordion-content">
                <div id="abp-container-parent" class="p-5 border-t border-gray-200">
                  <!-- El contenido de ABP se cargar√° aqu√≠ -->
                </div>
              </div>
            </div>

            <!-- Banco de Preguntas -->
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
              <button class="accordion-button w-full flex justify-between items-center p-5 text-left font-semibold text-lg text-gray-800 hover:bg-gray-50 transition-colors">
                <span>Banco de preguntas: Autoevaluaci√≥n de fundamentos</span>
                <svg class="accordion-icon w-6 h-6 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
              </button>
              <div class="accordion-content">
                <div id="quiz-container-parent" class="p-5 border-t border-gray-200">
                  <!-- El contenido del quiz se cargar√° aqu√≠ -->
                </div>
              </div>
            </div>
          </div>
        </article>

        <!-- Referencias / Meta -->
        <article class="card" id="referencias">
          <h2 class="title">Referencias</h2>
          <p class="muted">Inserta aqu√≠ tus fuentes clave (gu√≠as cl√≠nicas, revisiones recientes, cap√≠tulos de texto).</p>
        </article>

        <footer>
          Hecho con ‚ô• para estudio y pr√°ctica cl√≠nica. Mejora visual 2025.
        </footer>
      </section>
    </div>
  </main>

  <a href="#top" class="to-top" id="toTop" aria-label="Volver arriba">‚Üë Arriba</a>

  <script>
    // Quick search within page
    const q = document.getElementById('q');
    const content = document.getElementById('content');
    q?.addEventListener('keydown', (e)=>{ if(e.key === '/'){ e.preventDefault(); q.focus(); } });
    document.addEventListener('keydown', (e)=>{ if(e.key === '/' && document.activeElement !== q){ e.preventDefault(); q.focus(); } });
    q?.addEventListener('input', ()=>{
      const term = q.value.toLowerCase().trim();
      const cards = content.querySelectorAll('.card');
      cards.forEach(c=>{
        const txt = c.innerText.toLowerCase();
        c.style.outline = term && txt.includes(term) ? '2px solid var(--brand)' : 'none';
        c.style.opacity = term && !txt.includes(term) ? .35 : 1;
      })
    });

    // Build TOC from h2 inside .card
    const toc = document.getElementById('toc');
    const sections = [...document.querySelectorAll('.card h2')];
    const makeId = s=> s.textContent.toLowerCase().replace(/[^a-z√°√©√≠√≥√∫√±0-9 ]/gi,'').replace(/\s+/g,'-');
    sections.forEach(h=>{
      const section = h.closest('.card');
      if(section && !section.id){ section.id = makeId(h) }
      const a = document.createElement('a');
      a.href = `#${section.id}`;
      a.textContent = h.textContent;
      toc.appendChild(a);
    });

    // Scrollspy
    const links = [...toc.querySelectorAll('a')];
    const obs = new IntersectionObserver(entries=>{
      entries.forEach(en=>{
        const idx = links.findIndex(l=> l.getAttribute('href') === `#${en.target.id}`);
        if(idx>=0){
          if(en.isIntersecting){ links.forEach(l=>l.classList.remove('active')); links[idx].classList.add('active'); }
        }
      })
    }, { rootMargin: '-40% 0px -50% 0px', threshold: .01 });
    document.querySelectorAll('.card').forEach(sec=> obs.observe(sec));

    // Back to top
    const toTop = document.getElementById('toTop');
    window.addEventListener('scroll', ()=>{
      toTop.classList.toggle('show', window.scrollY > 500);
    });
  </script>
  <script>
      function abp_revealFinding(id) {
        const el = document.getElementById(id);
        if (el) el.style.display = 'block';
      }

      function abp_checkDiagnosis(diagnosis) {
        const feedbackEl = document.getElementById('feedback');
        const c1 = document.getElementById('c1').checked;
        const c2 = document.getElementById('c2').checked;
        const c3 = document.getElementById('c3').checked;
        const c4 = document.getElementById('c4').checked;
        const c5 = document.getElementById('c5').checked;
        const c6 = document.getElementById('c6').checked;
        const c7 = document.getElementById('c7').checked;

        let isCorrect = c1 && c2 && c3 && c4 && c5 && c6 && c7;

        if (diagnosis === 'probable') {
          if (isCorrect) {
            feedbackEl.className = 'correct';
            feedbackEl.innerHTML = `<h3>¬°Correcto!</h3><p><strong>Justificaci√≥n:</strong> El diagn√≥stico de <strong>Enfermedad de Parkinson Probable</strong> es el m√°s adecuado. El paciente cumple claramente el criterio de Parkinsonismo y presenta m√∫ltiples Criterios de Apoyo.</p>`;
          } else {
            feedbackEl.className = 'incorrect';
            feedbackEl.innerHTML = `<h3>Revisi√≥n Necesaria</h3><p>No ha marcado todos los criterios diagn√≥sticos que el paciente cumple. Revise los hallazgos.</p>`;
          }
        } else {
          feedbackEl.className = 'incorrect';
          feedbackEl.innerHTML = `<h3>Diagn√≥stico Incorrecto</h3><p>El temblor del paciente es en reposo y se acompa√±a de bradicinesia y rigidez, lo que descarta otras opciones.</p>`;
        }
        feedbackEl.style.display = 'block';
      }

      function focusOnMDS() {
        const mdsAccordionButton = document.getElementById('mds-accordion-button');
        const mdsAccordionDiv = document.getElementById('mds-accordion');

        if (mdsAccordionButton && !mdsAccordionButton.classList.contains('active')) {
          mdsAccordionButton.click();
        }

        setTimeout(() => {
          mdsAccordionDiv.scrollIntoView({
            behavior: 'smooth',
            block: 'start',
          });
        }, 500);
      }

      function quiz_selectAnswer(btn, isCorrect) {
        const currentQuestion = btn.closest('.question-block');
        const feedbackEl = currentQuestion.querySelector('.feedback');
        const options = currentQuestion.querySelectorAll('.option-btn');

        options.forEach((opt) => (opt.disabled = true));

        if (isCorrect) {
          btn.classList.add('correct');
          feedbackEl.innerHTML = '¬°Correcto! ' + btn.dataset.feedback;
          feedbackEl.classList.add('correct');
        } else {
          btn.classList.add('incorrect');
          feedbackEl.innerHTML = 'Incorrecto. ' + btn.dataset.feedback;
          feedbackEl.classList.add('incorrect');
          options.forEach((opt) => {
            if (opt.dataset.correct === 'true') {
              opt.classList.add('correct');
            }
          });
        }
        feedbackEl.style.display = 'block';
      }

      document.addEventListener('DOMContentLoaded', function () {
        // --- Dynamic Content Loaders ---
        const contentLoaders = {
          'presentation-container-parent': function (container) {
            container.innerHTML = `<div style="height: 80vh; position: relative;"><iframe id="presentation-iframe" style="width: 100%; height: 100%; border: none;"></iframe></div>`;
            const iframe = container.querySelector('#presentation-iframe');
            if (iframe) {
              iframe.srcdoc = `<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Presentaci√≥n Parkinson</title></head><body><div class="slide active"><h1>Trastornos del Movimiento I</h1><h2>Contexto en Ecuador</h2><img src="https://upload.wikimedia.org/wikipedia/commons/e/e8/Flag_of_Ecuador.svg" alt="Bandera de Ecuador" style="height: 150px; margin:20px 0;"><p class="caption">Fuente: Wikimedia Commons</p><p>Prevalencia en Manab√≠: <strong>243 casos por cada 100,000 habitantes</strong>.</p></div><div class="slide"><h2>Fisiopatolog√≠a: La V√≠a Nigroestriada</h2><svg id="basal-ganglia-svg" viewBox="0 0 600 450"><defs><marker id="arrow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#333" /></marker></defs><g id="cortex"><rect x="150" y="10" width="300" height="40" rx="5" fill="#FFDDC1" stroke="#333" /><text x="300" y="35" text-anchor="middle">Corteza Cerebral (+)</text></g><g id="striatum"><rect x="150" y="90" width="300" height="50" rx="5" fill="#DAF7A6" stroke="#333" /><text x="300" y="120" text-anchor="middle">Estriado</text></g><g id="gpe"><rect x="50" y="190" width="180" height="40" rx="5" fill="#A6B1F7" stroke="#333" /><text x="140" y="215" text-anchor="middle">GPe</text></g><g id="gpi"><rect x="370" y="190" width="180" height="40" rx="5" fill="#A6B1F7" stroke="#333" /><text x="460" y="215" text-anchor="middle">GPi</text></g><g id="stn"><rect x="150" y="270" width="180" height="40" rx="5" fill="#FFC3A0" stroke="#333" /><text x="240" y="295" text-anchor="middle">STN</text></g><g id="thalamus"><rect x="370" y="270" width="180" height="40" rx="5" fill="#C1FFD7" stroke="#333" /><text x="460" y="295" text-anchor="middle">T√°lamo</text></g><g id="snc"><rect x="150" y="380" width="300" height="40" rx="5" fill="#D1D5DB" stroke="#333" /><text x="300" y="405" text-anchor="middle">SNc</text></g><path d="M 300 50 V 90" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/><path id="direct-path" class="pathway" d="M 320 140 V 190 H 400" stroke="green" stroke-width="3" fill="none" marker-end="url(#arrow)"/><text x="340" y="175" fill="green" font-size="12">V√≠a Directa (-)</text><path id="indirect-path-1" class="pathway" d="M 280 140 V 190 H 200" stroke="red" stroke-width="3" fill="none" marker-end="url(#arrow)"/><text x="220" y="175" fill="red" font-size="12">V√≠a Indirecta</text><path class="pathway" d="M 140 230 V 270 H 200" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrow)"/><text x="175" y="255" fill="red" font-size="12">(-)</text><path class="pathway" d="M 240 310 V 230 H 400" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrow)"/><text x="350" y="255" fill="green" font-size="12">(+)</text><path class="pathway" d="M 460 230 V 270" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrow)"/><text x="470" y="255" fill="red" font-size="12">(-)</text><path d="M 460 270 C 500 200, 400 100, 300 50" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrow)" stroke-dasharray="5,5"/><text x="430" y="150" fill="green" font-size="12">(+)</text><path id="dopamine-flow-path" class="dopamine-flow" d="M 300 380 V 140" stroke="blue" stroke-width="4" fill="none" marker-end="url(#arrow)"/><text x="310" y="260" fill="blue" font-size="12">Dopamina</text></svg><button id="toggle-parkinson" class="nav-btn" style="margin-top: 1rem;">Simular Parkinson</button><p id="status-text">Estado Saludable</p></div><div class="slide"><h2>Signos Motores: Temblor en Reposo</h2><div class="video-container"><iframe src="https://www.youtube.com/embed/sHJYEAkWi9o" allowfullscreen></iframe></div><p>4-6 Hz, asim√©trico, "contar monedas".</p></div><div class="slide"><h2>Signos Motores: Rigidez</h2><div class="video-container"><iframe src="https://www.youtube.com/embed/4tWPNan12-U" allowfullscreen></iframe></div><p>"Tubo de plomo" o "rueda dentada".</p></div>`;
            }
          },
          'abp-container-parent': function (container) {
            container.innerHTML = `<div id="abp-content-wrapper" class="embedded-content"><div class="container"><h1>ABP: El Caso del Temblor Unilateral</h1><div class="step"><h2>Paso 1: Presentaci√≥n del Caso</h2><p>Un hombre de 68 a√±os, de Portoviejo, acude a su consulta. Su esposa lo ha convencido de venir. √âl refiere que desde hace aproximadamente un a√±o ha notado "un temblor leve en la mano derecha" y una "lentitud general para hacer las cosas".</p></div><div class="step"><h2>Paso 2: Anamnesis Interactiva</h2><p>Haga clic para obtener m√°s informaci√≥n.</p><div class="interactive-section"><button onclick="abp_revealFinding('hea')">Historia de la Enfermedad Actual</button><button onclick="abp_revealFinding('antecedentes')">Antecedentes</button><button onclick="abp_revealFinding('snm')">S√≠ntomas No Motores</button></div><div id="hea" class="finding"><strong>Detalles:</strong> El temblor es en reposo y desaparece con la acci√≥n. La lentitud la nota al vestirse. Progresi√≥n lenta.</div><div id="antecedentes" class="finding"><strong>Antecedentes:</strong> HTA en tto. No historia de trauma, toxinas o neurol√©pticos.</div><div id="snm" class="finding"><strong>Interrogatorio:</strong> La esposa confirma p√©rdida de olfato. El paciente admite estre√±imiento cr√≥nico y "actuar" sus sue√±os.</div></div><div class="step"><h2>Paso 3: Examen F√≠sico Virtual</h2><p>Seleccione las maniobras relevantes.</p><div class="interactive-section"><button onclick="abp_revealFinding('examen-reposo')">Observar en reposo</button><button onclick="abp_revealFinding('examen-dedos')">Golpeteo de dedos</button><button onclick="abp_revealFinding('examen-muneca')">Movimiento pasivo</button></div><div id="examen-reposo" class="finding"><strong>Hallazgo:</strong> Temblor de 5 Hz en mano derecha en reposo.</div><div id="examen-dedos" class="finding"><strong>Hallazgo:</strong> En mano derecha, movimiento lento con decremento de amplitud.</div><div id="examen-muneca" class="finding"><strong>Hallazgo:</strong> Rigidez en "rueda dentada" en mu√±eca derecha.</div></div><div class="step"><h2>Paso 4: Aplicaci√≥n de Criterios (MDS)</h2><p>Marque los criterios que cumple el paciente.</p><div id="checklist"><div class="checklist-item"><input type="checkbox" id="c1" value="bradicinesia"> <label for="c1">Bradicinesia</label></div><div class="checklist-item"><input type="checkbox" id="c2" value="rigidez"> <label for="c2">Rigidez</label></div><div class="checklist-item"><input type="checkbox" id="c3" value="temblor"> <label for="c3">Temblor en reposo</label></div><div class="checklist-item"><input type="checkbox" id="c4" value="parkinsonismo"> <label for="c4">**Cumple Criterio de Parkinsonismo**</label></div><hr><p><strong>Criterios de Apoyo:</strong></p><div class="checklist-item"><input type="checkbox" id="c5" value="apoyo-temblor"> <label for="c5">Temblor en reposo</label></div><div class="checklist-item"><input type="checkbox" id="c6" value="apoyo-olfato"> <label for="c6">Hiposmia</label></div><div class="checklist-item"><input type="checkbox" id="c7" value="apoyo-asim√©trico"> <label for="c7">Inicio asim√©trico</label></div></div></div><div class="step"><h2>Paso 5: Conclusi√≥n Diagn√≥stica</h2><p>¬øCu√°l es su diagn√≥stico m√°s probable?</p><div class="interactive-section"><button onclick="abp_checkDiagnosis('probable')">EP Probable</button><button onclick="abp_checkDiagnosis('esencial')">Temblor Esencial</button></div><div id="feedback"></div></div></div></div>`;
          },
          'quiz-container-parent': function (container) {
            container.innerHTML = `<div id="quiz-content-wrapper" class="embedded-content"><h1>Autoevaluaci√≥n: Fundamentos de EP</h1><div id="quiz-questions"></div></div>`;
            const quizData = [
              {
                question: 'Un paciente muestra lentitud al iniciar movimientos y una disminuci√≥n progresiva en la amplitud al golpear sus dedos repetidamente. ¬øQu√© signo cardinal de la EP describe esto?',
                options: ['Rigidez en rueda dentada', 'Temblor de acci√≥n', 'Bradicinesia con decremento', 'Apraxia ideomotora'],
                correct: 2,
                justification: 'La bradicinesia es el signo cardinal, caracterizado por lentitud y decremento en movimientos repetitivos.',
              },
              {
                question: '¬øCu√°l de los siguientes s√≠ntomas no motores tiene una de las mayores especificidades para una sinucleinopat√≠a como la EP?',
                options: ['Estre√±imiento', 'Depresi√≥n', 'P√©rdida del olfato (hiposmia)', 'Fatiga'],
                correct: 2,
                justification: 'La hiposmia es uno de los s√≠ntomas prodr√≥micos m√°s espec√≠ficos.',
              },
              {
                question: 'Para confirmar un temblor en reposo, ¬øqu√© maniobra es m√°s √∫til?',
                options: ['Pedirle que escriba', 'Pedirle que sostenga los brazos extendidos', 'Pedirle que cuente hacia atr√°s desde 20', 'Evaluar reflejos'],
                correct: 2,
                justification: 'El temblor en reposo se acent√∫a con la distracci√≥n mental.',
              },
              {
                question: '¬øCu√°l es el requisito M√çNIMO para diagnosticar un s√≠ndrome parkinsoniano seg√∫n los criterios de la MDS?',
                options: ['Temblor en reposo + Rigidez', 'Bradicinesia + Temblor en reposo', 'Inestabilidad postural + Temblor', 'Bradicinesia + Inestabilidad postural'],
                correct: 1,
                justification: 'El criterio fundamental es la bradicinesia, combinada con al menos temblor en reposo o rigidez.',
              },
              {
                question: 'Una respuesta dram√°tica a la levodopa es un ejemplo de ¬øcu√°l de los siguientes criterios diagn√≥sticos de la MDS?',
                options: ['Criterio de exclusi√≥n absoluta', 'Bandera roja', 'Criterio de apoyo', 'Signo cardinal'],
                correct: 2,
                justification: 'Una respuesta beneficiosa y clara a la terapia dopamin√©rgica es un Criterio de Apoyo clave.',
              },
            ];
            const questionsContainer = container.querySelector('#quiz-questions');
            questionsContainer.innerHTML = quizData
              .map((q, i) => `
                        <div class="question-block">
                            <p class="font-semibold">${i + 1}. ${q.question}</p>
                            <div class="options-container">
                                ${q.options
                                  .map(
                                    (opt, j) => `<button class="option-btn" data-correct="${j === q.correct}" data-feedback="${q.justification}" onclick="quiz_selectAnswer(this, ${j === q.correct})">${String.fromCharCode(65 + j)}. ${opt}</button>`
                                  )
                                  .join('')}
                            </div>
                            <div class="feedback"></div>
                        </div>
                    `)
              .join('');
          },
        };

        // --- Accordion Functionality ---
        const accordionButtons = document.querySelectorAll('.accordion-button');
        accordionButtons.forEach((button) => {
          button.addEventListener('click', () => {
            const content = button.nextElementSibling;
            const isActive = button.classList.contains('active');

            accordionButtons.forEach((otherButton) => {
              if (otherButton !== button) {
                otherButton.classList.remove('active');
                otherButton.nextElementSibling.style.maxHeight = null;
              }
            });

            if (isActive) {
              button.classList.remove('active');
              content.style.maxHeight = null;
            } else {
              button.classList.add('active');
              const contentDiv = content.firstElementChild;
              if (contentDiv && !contentDiv.dataset.loaded) {
                if (contentLoaders[contentDiv.id]) {
                  contentLoaders[contentDiv.id](contentDiv);
                  contentDiv.dataset.loaded = 'true';
                }
              }
              setTimeout(() => {
                content.style.maxHeight = content.scrollHeight + 'px';
              }, 200);
            }
          });
        });
      });
  </script>
  <script src="/assets/ask-ai.js"></script>
</body>
</html>
