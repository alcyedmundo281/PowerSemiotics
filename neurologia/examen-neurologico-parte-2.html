<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Examen neurológico parte 2 | Powersemiotics</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
      integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="../assets/tailwind.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap"
    />
    <style>
      :root {
        color-scheme: light;
        --bg: #f4f5fb;
        --shell: rgba(255, 255, 255, 0.92);
        --ink: #0f172a;
        --muted: #475569;
        --outline: rgba(15, 23, 42, 0.08);
        --accent: #4f46e5;
        --accent-soft: rgba(79, 70, 229, 0.12);
        --success: #10b981;
        --warning: #f59e0b;
      }
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        font-family: 'Space Grotesk', 'Inter', system-ui, -apple-system, BlinkMacSystemFont,
          'Segoe UI', sans-serif;
        color: var(--ink);
        background: radial-gradient(circle at 20% 20%, rgba(79, 70, 229, 0.08), transparent 45%),
          radial-gradient(circle at 80% 0%, rgba(14, 165, 233, 0.12), transparent 50%),
          linear-gradient(180deg, #f5f7ff 0%, #eef2ff 45%, #e0f7ff 100%);
        min-height: 100vh;
      }
      body::before {
        content: '';
        position: fixed;
        inset: 0;
        background-image: linear-gradient(120deg, rgba(79, 70, 229, 0.08) 1px, transparent 1px),
          linear-gradient(300deg, rgba(14, 165, 233, 0.08) 1px, transparent 1px);
        background-size: 160px 160px, 220px 220px;
        opacity: 0.45;
        pointer-events: none;
        z-index: -1;
      }
      body.drawer-open {
        overflow: hidden;
      }
      html {
        scroll-behavior: smooth;
      }
      section[data-module] {
        scroll-margin-top: 110px;
      }
      .page-shell {
        max-width: 1220px;
        margin: 0 auto;
        padding: 3.5rem 1.5rem 5rem;
      }
      .learning-shell {
        position: relative;
        display: grid;
        grid-template-columns: minmax(0, 1fr);
        gap: 2rem;
      }
      .main-card {
        background: var(--shell);
        border-radius: 40px;
        padding: clamp(1.25rem, 4vw, 3rem);
        border: 1px solid rgba(226, 232, 240, 0.8);
        box-shadow: 0 40px 120px -60px rgba(15, 23, 42, 0.6);
        position: relative;
        overflow: hidden;
      }
      .main-card::after {
        content: '';
        position: absolute;
        inset: 0;
        background: radial-gradient(circle at 80% 20%, rgba(59, 130, 246, 0.12), transparent 55%),
          radial-gradient(circle at 10% 90%, rgba(16, 185, 129, 0.12), transparent 60%);
        opacity: 0.7;
        pointer-events: none;
      }
      .main-card > * {
        position: relative;
        z-index: 2;
      }
      .hero {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
        gap: 1.5rem;
        align-items: stretch;
      }
      .hero-card,
      .score-card {
        border-radius: 28px;
        padding: clamp(1.5rem, 3vw, 2.5rem);
        border: 1px solid rgba(148, 163, 184, 0.35);
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(8px);
      }
      .hero-card h1 {
        font-size: clamp(2.1rem, 5vw, 3.2rem);
        margin: 0 0 0.8rem;
      }
      .hero-card p {
        margin: 0;
        color: var(--muted);
        font-size: 1.05rem;
      }
      .chip-row {
        display: flex;
        flex-wrap: wrap;
        gap: 0.65rem;
        margin: 1rem 0 1.5rem;
      }
      .chip {
        padding: 0.4rem 1rem;
        border-radius: 999px;
        font-size: 0.75rem;
        letter-spacing: 0.06em;
        text-transform: uppercase;
        border: 1px solid rgba(148, 163, 184, 0.4);
        background: rgba(15, 23, 42, 0.04);
      }
      .score-card {
        background: linear-gradient(135deg, rgba(15, 23, 42, 0.95), rgba(76, 29, 149, 0.85));
        color: white;
        border: none;
        box-shadow: 0 35px 80px -50px rgba(15, 23, 42, 1);
      }
      .score-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 1rem;
        margin-top: 1.5rem;
      }
      .score-tile {
        border-radius: 20px;
        padding: 1rem;
        background: rgba(255, 255, 255, 0.12);
        border: 1px solid rgba(255, 255, 255, 0.15);
      }
      .score-tile span {
        font-size: 0.72rem;
        letter-spacing: 0.3em;
        text-transform: uppercase;
        opacity: 0.8;
      }
      .score-tile strong {
        display: block;
        font-size: 1.8rem;
        margin-top: 0.4rem;
      }
      .progress-track {
        height: 0.8rem;
        background: rgba(255, 255, 255, 0.25);
        border-radius: 999px;
        overflow: hidden;
        margin-top: 1rem;
      }
      .progress-track span {
        display: block;
        height: 100%;
        width: 40%;
        background: linear-gradient(90deg, #a5b4fc, #22d3ee);
      }
      .modules-grid {
        margin-top: 3rem;
        display: flex;
        flex-direction: column;
        gap: 2rem;
      }
      .module-card {
        border-radius: 32px;
        padding: clamp(1.25rem, 3vw, 2.25rem);
        background: rgba(255, 255, 255, 0.9);
        border: 1px solid var(--outline);
        box-shadow: 0 30px 90px -70px rgba(15, 23, 42, 0.8);
        position: relative;
      }
      .module-header {
        display: flex;
        flex-direction: column;
        gap: 0.4rem;
        margin-bottom: 1.25rem;
      }
      .module-label {
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.3em;
        color: var(--muted);
      }
      .module-title {
        font-size: clamp(1.5rem, 4vw, 2.25rem);
        margin: 0;
      }
      .module-body {
        display: grid;
        gap: 1.25rem;
      }
      .flashcard-grid,
      .lab-grid,
      .quiz-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 1rem;
      }
      .flashcard {
        border-radius: 18px;
        border: 1px solid var(--outline);
        padding: 1rem;
        background: rgba(15, 23, 42, 0.02);
        cursor: pointer;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }
      .flashcard.is-flipped {
        background: var(--accent);
        color: white;
        border-color: rgba(255, 255, 255, 0.4);
      }
      .flashcard:focus-visible,
      .flashcard:hover {
        transform: translateY(-4px);
        box-shadow: 0 15px 30px -25px rgba(15, 23, 42, 0.6);
      }
      .flashcard p {
        margin: 0;
      }
      .flashcard strong {
        display: block;
        font-size: 1.05rem;
      }
      .lab-wrapper {
        display: flex;
        flex-direction: column;
        gap: 1.25rem;
      }
      .lab-progress {
        border-radius: 24px;
        padding: 1rem 1.25rem;
        border: 1px solid rgba(79, 70, 229, 0.25);
        background: linear-gradient(120deg, rgba(79, 70, 229, 0.15), rgba(14, 165, 233, 0.08));
        box-shadow: 0 20px 50px -35px rgba(79, 70, 229, 0.8);
      }
      .lab-progress-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 1rem;
      }
      .lab-progress-header p {
        margin: 0;
        text-transform: uppercase;
        letter-spacing: 0.2em;
        font-size: 0.75rem;
        color: rgba(15, 23, 42, 0.65);
      }
      .lab-progress-count {
        display: block;
        font-size: 1.3rem;
        margin-top: 0.15rem;
      }
      .lab-progress-header span {
        font-size: 0.9rem;
        color: rgba(15, 23, 42, 0.75);
      }
      .lab-progress-track {
        height: 0.6rem;
        background: rgba(255, 255, 255, 0.5);
        border-radius: 999px;
        overflow: hidden;
        margin-top: 0.75rem;
      }
      .lab-progress-track span {
        display: block;
        height: 100%;
        width: 0%;
        background: linear-gradient(90deg, #4f46e5, #22d3ee);
        transition: width 0.4s ease;
      }
      .lab-steps {
        list-style: none;
        margin: 0;
        padding: 0;
        display: flex;
        flex-direction: column;
        gap: 0.85rem;
      }
      .lab-step {
        border-radius: 24px;
        border: 1px solid rgba(15, 23, 42, 0.08);
        background: white;
        box-shadow: 0 20px 45px -35px rgba(15, 23, 42, 0.8);
        transition: border-color 0.3s ease, transform 0.3s ease;
      }
      .lab-step label {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1rem 1.25rem;
        cursor: pointer;
      }
      .lab-step input[type='checkbox'] {
        appearance: none;
        width: 1.35rem;
        height: 1.35rem;
        border-radius: 6px;
        border: 2px solid rgba(15, 23, 42, 0.25);
        display: grid;
        place-items: center;
        transition: background 0.2s ease, border-color 0.2s ease;
      }
      .lab-step input[type='checkbox']::after {
        content: '\2713';
        font-size: 0.9rem;
        color: white;
        transform: scale(0);
        transition: transform 0.2s ease;
      }
      .lab-step input[type='checkbox']:checked {
        background: var(--accent);
        border-color: var(--accent);
      }
      .lab-step input[type='checkbox']:checked::after {
        transform: scale(1);
      }
      .lab-step-content {
        flex: 1;
        display: flex;
        gap: 1rem;
        align-items: flex-start;
      }
      .lab-step-pill {
        font-size: 0.85rem;
        font-weight: 600;
        color: var(--accent);
        background: rgba(79, 70, 229, 0.1);
        padding: 0.4rem 0.65rem;
        border-radius: 999px;
        min-width: 3.3rem;
        text-align: center;
      }
      .lab-step-content strong {
        display: block;
        font-size: 1.05rem;
        margin-bottom: 0.15rem;
      }
      .lab-step-content p {
        margin: 0;
        color: var(--muted);
      }
      .lab-step.completed {
        border-color: rgba(79, 70, 229, 0.5);
        transform: translateX(6px);
      }
      .lab-step.completed .lab-step-pill {
        background: var(--accent);
        color: white;
      }
      .slider-block {
        display: grid;
        gap: 0.6rem;
      }
      .slider-label {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 0.75rem;
      }
      .slider-label output {
        font-weight: 700;
        color: var(--accent);
      }
      .slider-block input[type='range'] {
        width: 100%;
        accent-color: var(--accent);
      }
      .generator-panel {
        border-radius: 22px;
        border: 1px solid var(--outline);
        padding: 1.25rem;
        background: rgba(14, 165, 233, 0.04);
      }
      .generator-output {
        border-radius: 16px;
        padding: 1rem;
        min-height: 60px;
        background: white;
        border: 1px dashed var(--outline);
      }
      .module-actions {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
        margin-top: 1rem;
      }
      .btn {
        border-radius: 999px;
        padding: 0.55rem 1.4rem;
        border: none;
        cursor: pointer;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
      }
      .btn-primary {
        background: var(--accent);
        color: white;
      }
      .btn-secondary {
        background: rgba(15, 23, 42, 0.08);
        color: var(--ink);
      }
      .quiz-card {
        border: 1px solid var(--outline);
        border-radius: 20px;
        padding: 1rem;
        background: rgba(79, 70, 229, 0.04);
      }
      .quiz-options {
        display: grid;
        gap: 0.4rem;
        margin-top: 0.75rem;
      }
      .quiz-options label {
        border-radius: 14px;
        border: 1px solid rgba(79, 70, 229, 0.25);
        padding: 0.65rem 0.9rem;
        display: flex;
        align-items: center;
        gap: 0.6rem;
        cursor: pointer;
      }
      .quiz-options input {
        accent-color: var(--accent);
      }
      .guide-frame {
        width: 100%;
        border: none;
        border-radius: 24px;
        min-height: 480px;
        background: white;
      }
      .status-pill {
        display: inline-flex;
        align-items: center;
        gap: 0.45rem;
        padding: 0.35rem 0.85rem;
        border-radius: 999px;
        background: rgba(16, 185, 129, 0.12);
        color: var(--success);
        font-weight: 600;
        font-size: 0.9rem;
      }
      .drawer-toggle {
        display: inline-flex;
        align-items: center;
        gap: 0.4rem;
        border-radius: 999px;
        border: 1px solid rgba(15, 23, 42, 0.2);
        padding: 0.45rem 1rem;
        background: white;
        cursor: pointer;
        font-weight: 600;
        margin-bottom: 1.5rem;
      }
      .drawer {
        position: fixed;
        top: 0;
        bottom: 0;
        left: 0;
        width: min(320px, 90vw);
        background: rgba(9, 9, 20, 0.95);
        color: white;
        padding: 2rem 1.25rem;
        transform: translateX(-100%);
        transition: transform 0.35s ease;
        z-index: 10;
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
      }
      .drawer.open {
        transform: translateX(0);
      }
      .drawer header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 0.5rem;
      }
      .drawer nav {
        display: flex;
        flex-direction: column;
        gap: 0.65rem;
      }
      .drawer a {
        color: rgba(255, 255, 255, 0.85);
        text-decoration: none;
        font-weight: 600;
        padding: 0.4rem 0.5rem;
        border-radius: 10px;
        display: inline-flex;
        align-items: center;
        gap: 0.6rem;
      }
      .drawer a.active {
        background: rgba(79, 70, 229, 0.35);
      }
      .drawer-close {
        background: none;
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 999px;
        color: white;
        padding: 0.35rem 0.9rem;
        cursor: pointer;
      }
      .drawer-overlay {
        position: fixed;
        inset: 0;
        background: rgba(15, 23, 42, 0.45);
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
        z-index: 9;
      }
      .drawer-overlay.visible {
        opacity: 1;
        pointer-events: auto;
      }
      @media (min-width: 1024px) {
        .learning-shell {
          grid-template-columns: 260px 1fr;
        }
        .drawer,
        .drawer-overlay,
        .drawer-toggle {
          display: none;
        }
        .sidebar-static {
          position: sticky;
          top: 2rem;
          align-self: start;
          padding: 2rem 1.25rem;
          border-radius: 28px;
          background: rgba(15, 23, 42, 0.92);
          color: white;
          border: 1px solid rgba(255, 255, 255, 0.12);
          box-shadow: 0 35px 80px -60px rgba(15, 23, 42, 1);
          display: flex;
          flex-direction: column;
          gap: 1.5rem;
        }
        .sidebar-static nav {
          display: flex;
          flex-direction: column;
          gap: 0.45rem;
        }
        .sidebar-static a {
          color: rgba(255, 255, 255, 0.85);
          text-decoration: none;
          padding: 0.35rem 0.4rem;
          border-radius: 10px;
          display: inline-flex;
          align-items: center;
          gap: 0.6rem;
        }
        .sidebar-static a.active {
          background: rgba(79, 70, 229, 0.35);
        }
      }
      @media (prefers-reduced-motion: reduce) {
        html {
          scroll-behavior: auto;
        }
        *,
        *::before,
        *::after {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }
        .flashcard,
        .drawer,
        .drawer-overlay,
        .drawer-toggle {
          transition: none !important;
        }
      }
    </style>
  </head>
  <body>
    <div class="drawer" aria-hidden="true" aria-label="Panel de navegación">
      <header>
        <strong>Mapa interactivo</strong>
        <button class="drawer-close" type="button">Cerrar</button>
      </header>
      <nav class="drawer-links"></nav>
    </div>
    <div class="drawer-overlay" aria-hidden="true"></div>
    <div class="page-shell">
      <button class="drawer-toggle" type="button">
        <i class="fa-solid fa-compass" aria-hidden="true"></i>
        Abrir panel
      </button>
      <div class="learning-shell">
        <aside class="sidebar-static" aria-label="Panel lateral">
          <div>
            <p style="margin: 0; letter-spacing: 0.35em; font-size: 0.7rem; text-transform: uppercase">
              Temario
            </p>
            <strong style="font-size: 1.35rem">Misiones</strong>
          </div>
          <nav class="sidebar-links"></nav>
          <div>
            <p style="margin: 0 0 0.35rem; font-size: 0.85rem; opacity: 0.8">Tip</p>
            <p style="margin: 0; font-size: 0.95rem">
              Cada módulo usa plantillas dinámicas. Edita el texto en un solo lugar y evitarás conflictos.
            </p>
          </div>
        </aside>
        <main class="main-card">
          <div class="hero">
            <article class="hero-card">
              <p class="chip">Examen neurológico · parte 2</p>
              <h1>Entrenamiento gamificado</h1>
              <p>
                Explora cada sistema neurológico mediante tarjetas, laboratorios, generadores de casos y un
                quiz que calcula tu XP automáticamente.
              </p>
              <div class="chip-row">
                <span class="chip">Pares craneales</span>
                <span class="chip">Motor</span>
                <span class="chip">Sensitivo</span>
                <span class="chip">Integración</span>
              </div>
            </article>
            <article class="score-card" aria-live="polite">
              <div style="display: flex; align-items: center; justify-content: space-between">
                <div>
                  <p style="margin: 0; letter-spacing: 0.3em; font-size: 0.75rem">Tablero</p>
                  <strong style="font-size: 2.4rem" id="xpCounter">1200 XP</strong>
                </div>
                <div>
                  <p style="margin: 0; opacity: 0.8">Racha</p>
                  <strong id="streakCounter">x3</strong>
                </div>
              </div>
              <div class="progress-track" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="40">
                <span id="progressTrack"></span>
              </div>
              <div class="score-grid">
                <div class="score-tile">
                  <span>Misiones</span>
                  <strong id="missionCount">0/0</strong>
                </div>
                <div class="score-tile">
                  <span>Flashcards</span>
                  <strong id="cardCount">0</strong>
                </div>
                <div class="score-tile">
                  <span>Retos</span>
                  <strong id="challengeCount">0</strong>
                </div>
              </div>
            </article>
          </div>
          <div class="modules-grid" id="modules"></div>
        </main>
      </div>
    </div>
    <script>
      const modules = [
        {
          id: 'pares-craneales',
          number: '01',
          icon: 'fa-brain',
          title: 'Pares craneales',
          intro:
            'Memoriza las funciones y pruebas rápidas con tarjetas volteables. Cada click revela maniobras clave.',
          type: 'flashcards',
          cards: [
            { title: 'I · Olfatorio', description: 'Identificar olores con cada fosa nasal por separado.' },
            { title: 'II · Óptico', description: 'Evaluar agudeza, campos visuales y fondo de ojo.' },
            {
              title: 'III, IV, VI',
              description: 'Motilidad ocular extrínseca, reflejo fotomotor y seguimiento suave.'
            },
            { title: 'V · Trigémino', description: 'Tono masetero, reflejo corneal y sensibilidad facial.' },
            { title: 'VII · Facial', description: 'Mímica facial simétrica, gusto en 2/3 anteriores.' },
            { title: 'VIII · Vestibulococlear', description: 'Pruebas de Rinne y Weber, equilibrio.' },
            { title: 'IX, X · Glosofaríngeo/Vago', description: 'Reflejo nauseoso y elevación del paladar.' },
            { title: 'XI · Accesorio', description: 'Fuerza del esternocleidomastoideo y trapecio.' },
            { title: 'XII · Hipogloso', description: 'Movimientos linguales, fasciculaciones y desviaciones.' }
          ]
        },
        {
          id: 'sistema-motor',
          number: '02',
          icon: 'fa-dumbbell',
          title: 'Sistema motor',
          intro:
            'Organiza la fuerza, el tono y los reflejos usando un laboratorio con pasos guiados que puedes marcar.',
          type: 'lab',
          steps: [
            {
              title: 'Inspección',
              detail: 'Busca atrofias, fasciculaciones y postura antálgica desde la entrada del paciente.'
            },
            {
              title: 'Tono y fuerza',
              detail:
                'Palpa la resistencia pasiva y califica la fuerza (0-5) en flexión/extensión de hombro, codo y muñeca.'
            },
            {
              title: 'Reflejos',
              detail: 'Rotuliano, aquíleo, bicipital y tricipital, registrando hiporreflexia o clonus.'
            },
            {
              title: 'Pruebas superiores',
              detail: 'Índice-nariz, talón-rodilla y maniobras de pronador para vías piramidales.'
            }
          ]
        },
        {
          id: 'sistema-sensitivo',
          number: '03',
          icon: 'fa-wave-square',
          title: 'Sistema sensitivo',
          intro:
            'Ajusta los umbrales de dolor, tacto, vibración y propiocepción con un control único para documentar hallazgos.',
          type: 'slider',
          slider: {
            min: 0,
            max: 10,
            value: 5,
            label: 'Umbral percibido',
            description: 'Desliza según la respuesta del paciente para estimar la intensidad mínima percibida.'
          },
          checklist: [
            'Dolor (estímulo punzante vs. romo)',
            'Tacto ligero con torundas',
            'Vibración con diapasón 128 Hz',
            'Propiocepción en articulaciones distales'
          ]
        },
        {
          id: 'integracion',
          number: '04',
          icon: 'fa-flask',
          title: 'Integración clínica',
          intro:
            'Genera casos y patrones electrodiagnósticos aleatorios para que la discusión sea distinta cada vez.',
          type: 'generator',
          cases: [
            'Paciente con diplopía horizontal y ptosis progresiva',
            'Temblor de reposo, bradicinesia y rigidez en rueda dentada',
            'Parestesias en guante y media con antecedente metabólico',
            'Debilidad proximal con CK elevada y reflejos conservados',
            'Ataxia aguda tras cuadro viral en pediatría'
          ],
          patterns: [
            'EMG con descargas repetitivas y patrón miopático',
            'Velocidades de conducción disminuidas difusamente',
            'Resonancia con lesiones periventriculares',
            'Potenciales evocados visuales prolongados',
            'LCR con disociación albúmino-citológica'
          ]
        },
        {
          id: 'demostracion',
          number: '05',
          icon: 'fa-chalkboard-user',
          title: 'Demostración guiada',
          intro:
            'Observa la secuencia en video o utiliza la rúbrica paso a paso para evaluar a tus compañeros.',
          type: 'demo',
          video: 'https://www.youtube.com/embed/4J0s9l9Q-rA',
          rubric: [
            'Presentación y explicación del procedimiento',
            'Secuencia lógica: inspección, palpación, maniobras',
            'Comunicación clara con el paciente simulado',
            'Registro completo de hallazgos positivos y negativos'
          ]
        },
        {
          id: 'auto-evaluacion',
          number: '06',
          icon: 'fa-question',
          title: 'Autoevaluación',
          intro:
            'Responde la batería rápida de tres reactivos. Cada respuesta correcta suma 150 XP y aumenta la racha.',
          type: 'quiz',
          questions: [
            {
              prompt: '¿Qué par craneal controla el reflejo corneal aferente?',
              options: ['VII', 'V', 'III'],
              answer: 'V'
            },
            {
              prompt: 'Una hipotonía generalizada con hiporreflexia orienta a un patrón…',
              options: ['Central', 'Periférico', 'Funcional'],
              answer: 'Periférico'
            },
            {
              prompt: 'El signo de Romberg positivo se documenta dentro de…',
              options: ['Sensibilidad profunda', 'Sistema motor', 'Integración cortical'],
              answer: 'Sensibilidad profunda'
            }
          ]
        },
        {
          id: 'guia-interactiva',
          number: '07',
          icon: 'fa-compass-drafting',
          title: 'Guía interactiva',
          intro:
            'Consulta la guía desplegable con checklists imprimibles. Puedes refrescarla sin salir de la página.',
          type: 'guide',
          url: 'https://script.google.com/macros/s/AKfycbycyUCZNCgbrKE9tGdKOsvfDnYFkxSJbE0811P7bXwVoRwktwTdUr4Uarw4f-Eg9sbhtQ/exec'
        },
        {
          id: 'bibliografia',
          number: '08',
          icon: 'fa-book',
          title: 'Bibliografía mínima',
          intro:
            'Mantén una lista corta de referencias para citar al presentar tus hallazgos clínicos y electrofisiológicos.',
          type: 'list',
          resources: [
            'DeMyer W. Técnica del examen neurológico',
            'Preston & Shapiro. Electromiografía y conducción nerviosa',
            'Adams y Victor. Principios de neurología',
            'AAN Practice Parameters para EMG y NCV'
          ]
        }
      ];

      const modulesContainer = document.getElementById('modules');
      const sidebarLinks = document.querySelector('.sidebar-links');
      const drawerLinks = document.querySelector('.drawer-links');

      function createElement(html) {
        const template = document.createElement('template');
        template.innerHTML = html.trim();
        return template.content.firstElementChild;
      }

      function renderNav(linkContainer) {
        linkContainer.innerHTML = '';
        modules.forEach((module) => {
          const link = createElement(
            `<a href="#${module.id}"><i class="fa-solid ${module.icon}" aria-hidden="true"></i><span>${module.number}. ${module.title}</span></a>`
          );
          linkContainer.appendChild(link);
        });
      }

      function renderFlashcards(cards) {
        const grid = document.createElement('div');
        grid.className = 'flashcard-grid';
        cards.forEach((card) => {
          const flashcard = createElement(
            `<article class="flashcard" tabindex="0" aria-label="${card.title}">
              <strong>${card.title}</strong>
              <p>${card.description}</p>
            </article>`
          );
          flashcard.addEventListener('click', () => flashcard.classList.toggle('is-flipped'));
          flashcard.addEventListener('keypress', (event) => {
            if (event.key === 'Enter') {
              flashcard.classList.toggle('is-flipped');
            }
          });
          grid.appendChild(flashcard);
        });
        return grid;
      }

      function renderLab(steps) {
        const wrapper = document.createElement('div');
        wrapper.className = 'lab-wrapper';
        const progress = createElement(
          `<div class="lab-progress" role="status" aria-live="polite">
            <div class="lab-progress-header">
              <div>
                <p>Checklist motor</p>
                <strong class="lab-progress-count">0/${steps.length} pasos completados</strong>
              </div>
              <span>Marca cada paso tras ejecutarlo.</span>
            </div>
            <div class="lab-progress-track" aria-hidden="true">
              <span></span>
            </div>
          </div>`
        );
        const list = document.createElement('ol');
        list.className = 'lab-steps';
        const fill = progress.querySelector('.lab-progress-track span');
        const counter = progress.querySelector('.lab-progress-count');

        const updateProgress = () => {
          const total = steps.length;
          const checked = list.querySelectorAll('input:checked').length;
          const percent = total === 0 ? 0 : Math.round((checked / total) * 100);
          fill.style.width = `${percent}%`;
          counter.textContent = `${checked}/${total} pasos completados`;
        };

        steps.forEach((step, index) => {
          const item = createElement(
            `<li class="lab-step">
              <label>
                <input type="checkbox" aria-label="Marcar ${step.title}" />
                <div class="lab-step-content">
                  <span class="lab-step-pill">Paso ${String(index + 1).padStart(2, '0')}</span>
                  <div>
                    <strong>${step.title}</strong>
                    <p>${step.detail}</p>
                  </div>
                </div>
              </label>
            </li>`
          );
          const checkbox = item.querySelector('input');
          checkbox.addEventListener('change', () => {
            item.classList.toggle('completed', checkbox.checked);
            updateProgress();
          });
          list.appendChild(item);
        });

        wrapper.appendChild(progress);
        wrapper.appendChild(list);
        updateProgress();
        return wrapper;
      }

      function renderSlider(slider, checklist) {
        const block = document.createElement('div');
        block.className = 'slider-block';
        const sliderId = `slider-${Math.random().toString(36).slice(2, 7)}`;
        const descriptionId = `${sliderId}-description`;
        block.innerHTML = `
          <div class="slider-label">
            <label for="${sliderId}">${slider.label}</label>
            <output id="${sliderId}-value" for="${sliderId}" role="status" aria-live="polite">${slider.value}</output>
          </div>
          <input type="range" id="${sliderId}" min="${slider.min}" max="${slider.max}" value="${slider.value}" aria-describedby="${descriptionId}" />
          <p id="${descriptionId}">${slider.description}</p>
          <ul style="margin: 0; padding-left: 1.2rem; color: var(--muted)">
            ${checklist.map((item) => `<li>${item}</li>`).join('')}
          </ul>
        `;
        const sliderInput = block.querySelector('input');
        const sliderValue = block.querySelector('output');
        sliderInput.addEventListener('input', () => {
          sliderValue.textContent = sliderInput.value;
        });
        return block;
      }

      function renderGenerator(data) {
        const panel = document.createElement('div');
        panel.className = 'generator-panel';
        panel.innerHTML = `
          <div class="generator-output" id="caseOutput" role="status" aria-live="polite">Pulsa «Nuevo caso».</div>
          <div class="module-actions">
            <button class="btn btn-primary" type="button" data-action="case"><i class="fa-solid fa-shuffle" aria-hidden="true"></i> Nuevo caso</button>
            <button class="btn btn-secondary" type="button" data-action="pattern"><i class="fa-solid fa-wave-square" aria-hidden="true"></i> Patrón electrodiagnóstico</button>
          </div>
        `;
        const output = panel.querySelector('#caseOutput');
        panel.querySelectorAll('button').forEach((button) => {
          button.addEventListener('click', () => {
            const pool = button.dataset.action === 'case' ? data.cases : data.patterns;
            const choice = pool[Math.floor(Math.random() * pool.length)];
            output.textContent = choice;
            updateChallenges(40);
          });
        });
        return panel;
      }

      function renderDemo(module) {
        const wrapper = document.createElement('div');
        wrapper.className = 'module-body';
        wrapper.innerHTML = `
          <div style="position: relative; padding-top: 56.25%; border-radius: 20px; overflow: hidden; border: 1px solid var(--outline)">
            <iframe src="${module.video}" title="Demostración" allowfullscreen style="position:absolute; inset:0; width:100%; height:100%; border:0"></iframe>
          </div>
          <div>
            <h4>Rúbrica rápida</h4>
            <ul style="margin: 0; padding-left: 1.2rem; color: var(--muted)">
              ${module.rubric.map((item) => `<li>${item}</li>`).join('')}
            </ul>
          </div>
        `;
        return wrapper;
      }

      function renderQuiz(module) {
        const grid = document.createElement('div');
        grid.className = 'quiz-grid';
        module.questions.forEach((question, index) => {
          const card = createElement(
            `<article class="quiz-card">
              <strong>Pregunta ${index + 1}</strong>
              <p>${question.prompt}</p>
              <div class="quiz-options">
                ${question.options
                  .map(
                    (option, optionIndex) => `
                      <label>
                        <input type="radio" name="quiz-${index}" value="${option}" />
                        <span>${option}</span>
                      </label>
                    `
                  )
                  .join('')}
              </div>
            </article>`
          );
          grid.appendChild(card);
        });
        const actions = createElement(
          `<div class="module-actions">
            <button class="btn btn-primary" type="button" id="submitQuiz">
              <i class="fa-solid fa-check" aria-hidden="true"></i>
              Calificar
            </button>
            <div class="status-pill" aria-live="polite" id="quizStatus">
              <i class="fa-solid fa-star" aria-hidden="true"></i>
              Listo para responder
            </div>
          </div>`
        );
        actions.querySelector('#submitQuiz').addEventListener('click', () => {
          let score = 0;
          module.questions.forEach((question, index) => {
            const selected = grid.querySelector(`input[name="quiz-${index}"]:checked`);
            if (selected && selected.value === question.answer) {
              score += 1;
            }
          });
          const status = actions.querySelector('#quizStatus');
          status.textContent = `Aciertos: ${score}/${module.questions.length}`;
          if (score > 0) {
            updateXP(score * 150);
            updateChallenges(score * 50);
          }
        });
        const fragment = document.createDocumentFragment();
        fragment.appendChild(grid);
        fragment.appendChild(actions);
        return fragment;
      }

      function renderGuide(module) {
        const wrapper = document.createElement('div');
        wrapper.className = 'module-body';
        wrapper.innerHTML = `
          <div class="status-pill" aria-live="polite" id="guideStatus">
            <i class="fa-solid fa-circle-notch fa-spin" aria-hidden="true"></i>
            Cargando guía…
          </div>
          <iframe class="guide-frame" src="${module.url}" title="Guía interactiva"></iframe>
          <div class="module-actions">
            <button class="btn btn-secondary" type="button" id="reloadGuide">
              <i class="fa-solid fa-rotate" aria-hidden="true"></i>
              Refrescar
            </button>
            <a class="btn btn-primary" href="${module.url}" target="_blank" rel="noopener">
              <i class="fa-solid fa-arrow-up-right-from-square" aria-hidden="true"></i>
              Abrir en pestaña nueva
            </a>
          </div>
        `;
        const frame = wrapper.querySelector('iframe');
        const status = wrapper.querySelector('#guideStatus');
        frame.addEventListener('load', () => {
          status.innerHTML = '<i class="fa-solid fa-circle-check" aria-hidden="true"></i> Guía lista';
        });
        wrapper.querySelector('#reloadGuide').addEventListener('click', () => {
          status.innerHTML = '<i class="fa-solid fa-circle-notch fa-spin" aria-hidden="true"></i> Actualizando…';
          frame.src = module.url;
        });
        return wrapper;
      }

      function renderList(module) {
        const list = document.createElement('ul');
        list.style.margin = '0';
        list.style.paddingLeft = '1.2rem';
        list.style.color = 'var(--muted)';
        list.innerHTML = module.resources.map((item) => `<li>${item}</li>`).join('');
        return list;
      }

      function renderModule(module) {
        const section = document.createElement('section');
        section.className = 'module-card';
        section.id = module.id;
        section.dataset.module = '';
        section.innerHTML = `
          <header class="module-header">
            <span class="module-label">Misión ${module.number}</span>
            <h2 class="module-title">${module.title}</h2>
            <p style="color: var(--muted); margin: 0">${module.intro}</p>
          </header>
        `;
        const body = document.createElement('div');
        body.className = 'module-body';
        if (module.type === 'flashcards') body.appendChild(renderFlashcards(module.cards));
        if (module.type === 'lab') body.appendChild(renderLab(module.steps));
        if (module.type === 'slider') body.appendChild(renderSlider(module.slider, module.checklist));
        if (module.type === 'generator') body.appendChild(renderGenerator(module));
        if (module.type === 'demo') body.appendChild(renderDemo(module));
        if (module.type === 'quiz') body.appendChild(renderQuiz(module));
        if (module.type === 'guide') body.appendChild(renderGuide(module));
        if (module.type === 'list') body.appendChild(renderList(module));
        section.appendChild(body);
        return section;
      }

      function renderModules() {
        modulesContainer.innerHTML = '';
        modules.forEach((module) => {
          modulesContainer.appendChild(renderModule(module));
        });
        document.getElementById('missionCount').textContent = `${modules.length}/${modules.length}`;
        document.getElementById('cardCount').textContent = modules.find((m) => m.type === 'flashcards').cards.length;
      }

      let xp = 1200;
      let streak = 3;
      let challenges = 0;

      function updateXP(amount) {
        xp += amount;
        document.getElementById('xpCounter').textContent = `${xp} XP`;
        const progress = Math.min(100, Math.round((xp / 2000) * 100));
        const progressBar = document.getElementById('progressTrack');
        progressBar.style.width = `${progress}%`;
        progressBar.parentElement.setAttribute('aria-valuenow', String(progress));
      }

      function updateChallenges(amount) {
        challenges += amount;
        document.getElementById('challengeCount').textContent = challenges;
        streak += 1;
        document.getElementById('streakCounter').textContent = `x${streak}`;
      }

      renderNav(sidebarLinks);
      renderNav(drawerLinks);
      renderModules();

      const drawer = document.querySelector('.drawer');
      const overlay = document.querySelector('.drawer-overlay');
      const drawerToggle = document.querySelector('.drawer-toggle');
      const drawerClose = document.querySelector('.drawer-close');

      function openDrawer() {
        drawer.classList.add('open');
        overlay.classList.add('visible');
        drawer.setAttribute('aria-hidden', 'false');
        document.body.classList.add('drawer-open');
      }

      function closeDrawer() {
        drawer.classList.remove('open');
        overlay.classList.remove('visible');
        drawer.setAttribute('aria-hidden', 'true');
        document.body.classList.remove('drawer-open');
      }

      drawerToggle.addEventListener('click', openDrawer);
      drawerClose.addEventListener('click', closeDrawer);
      overlay.addEventListener('click', closeDrawer);
      window.addEventListener('keydown', (event) => {
        if (event.key === 'Escape') {
          closeDrawer();
        }
      });

      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            const id = entry.target.getAttribute('id');
            const selector = `a[href="#${id}"]`;
            document.querySelectorAll(selector).forEach((link) => {
              if (entry.isIntersecting) {
                link.classList.add('active');
              } else {
                link.classList.remove('active');
              }
            });
          });
        },
        { rootMargin: '-40% 0px -50% 0px' }
      );
      document.querySelectorAll('[data-module]').forEach((section) => observer.observe(section));
    </script>
  </body>
</html>
