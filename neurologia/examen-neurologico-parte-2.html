<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Examen neurológico parte 2 | Powersemiotics</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
      integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="../assets/tailwind.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap"
    />
    <style>
      :root {
        color-scheme: light;
        --bg: #f4f5fb;
        --shell: rgba(255, 255, 255, 0.92);
        --ink: #0f172a;
        --muted: #475569;
        --outline: rgba(15, 23, 42, 0.08);
        --accent: #4f46e5;
        --accent-soft: rgba(79, 70, 229, 0.12);
        --success: #10b981;
        --warning: #f59e0b;
      }
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        font-family: 'Space Grotesk', 'Inter', system-ui, -apple-system, BlinkMacSystemFont,
          'Segoe UI', sans-serif;
        color: var(--ink);
        background: radial-gradient(circle at 20% 20%, rgba(79, 70, 229, 0.08), transparent 45%),
          radial-gradient(circle at 80% 0%, rgba(14, 165, 233, 0.12), transparent 50%),
          linear-gradient(180deg, #f5f7ff 0%, #eef2ff 45%, #e0f7ff 100%);
        min-height: 100vh;
      }
      body::before {
        content: '';
        position: fixed;
        inset: 0;
        background-image: linear-gradient(120deg, rgba(79, 70, 229, 0.08) 1px, transparent 1px),
          linear-gradient(300deg, rgba(14, 165, 233, 0.08) 1px, transparent 1px);
        background-size: 160px 160px, 220px 220px;
        opacity: 0.45;
        pointer-events: none;
        z-index: -1;
      }
      body.drawer-open {
        overflow: hidden;
      }
      html {
        scroll-behavior: smooth;
      }
      section[data-module] {
        scroll-margin-top: 110px;
      }
      .page-shell {
        max-width: 1220px;
        margin: 0 auto;
        padding: 3.5rem 1.5rem 5rem;
      }
      .learning-shell {
        position: relative;
        display: grid;
        grid-template-columns: minmax(0, 1fr);
        gap: 2rem;
      }
      .main-card {
        background: var(--shell);
        border-radius: 40px;
        padding: clamp(1.25rem, 4vw, 3rem);
        border: 1px solid rgba(226, 232, 240, 0.8);
        box-shadow: 0 40px 120px -60px rgba(15, 23, 42, 0.6);
        position: relative;
        overflow: hidden;
      }
      .main-card::after {
        content: '';
        position: absolute;
        inset: 0;
        background: radial-gradient(circle at 80% 20%, rgba(59, 130, 246, 0.12), transparent 55%),
          radial-gradient(circle at 10% 90%, rgba(16, 185, 129, 0.12), transparent 60%);
        opacity: 0.7;
        pointer-events: none;
      }
      .main-card > * {
        position: relative;
        z-index: 2;
      }
      .hero {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
        gap: 1.5rem;
        align-items: stretch;
      }
      .hero-card,
      .score-card {
        border-radius: 28px;
        padding: clamp(1.5rem, 3vw, 2.5rem);
        border: 1px solid rgba(148, 163, 184, 0.35);
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(8px);
      }
      .hero-card h1 {
        font-size: clamp(2.1rem, 5vw, 3.2rem);
        margin: 0 0 0.8rem;
      }
      .hero-card p {
        margin: 0;
        color: var(--muted);
        font-size: 1.05rem;
      }
      .chip-row {
        display: flex;
        flex-wrap: wrap;
        gap: 0.65rem;
        margin: 1rem 0 1.5rem;
      }
      .chip {
        padding: 0.4rem 1rem;
        border-radius: 999px;
        font-size: 0.75rem;
        letter-spacing: 0.06em;
        text-transform: uppercase;
        border: 1px solid rgba(148, 163, 184, 0.4);
        background: rgba(15, 23, 42, 0.04);
      }
      .score-card {
        background: linear-gradient(135deg, rgba(15, 23, 42, 0.95), rgba(76, 29, 149, 0.85));
        color: white;
        border: none;
        box-shadow: 0 35px 80px -50px rgba(15, 23, 42, 1);
      }
      .score-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 1rem;
        margin-top: 1.5rem;
      }
      .score-tile {
        border-radius: 20px;
        padding: 1rem;
        background: rgba(255, 255, 255, 0.12);
        border: 1px solid rgba(255, 255, 255, 0.15);
      }
      .score-tile span {
        font-size: 0.72rem;
        letter-spacing: 0.3em;
        text-transform: uppercase;
        opacity: 0.8;
      }
      .score-tile strong {
        display: block;
        font-size: 1.8rem;
        margin-top: 0.4rem;
      }
      .progress-track {
        height: 0.8rem;
        background: rgba(255, 255, 255, 0.25);
        border-radius: 999px;
        overflow: hidden;
        margin-top: 1rem;
      }
      .progress-track span {
        display: block;
        height: 100%;
        width: 40%;
        background: linear-gradient(90deg, #a5b4fc, #22d3ee);
      }
      .modules-grid {
        margin-top: 3rem;
        display: flex;
        flex-direction: column;
        gap: 2rem;
      }
      .module-card {
        border-radius: 32px;
        padding: clamp(1.25rem, 3vw, 2.25rem);
        background: rgba(255, 255, 255, 0.9);
        border: 1px solid var(--outline);
        box-shadow: 0 30px 90px -70px rgba(15, 23, 42, 0.8);
        position: relative;
      }
      .module-header {
        display: flex;
        flex-direction: column;
        gap: 0.4rem;
        margin-bottom: 1.25rem;
      }
      .module-label {
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.3em;
        color: var(--muted);
      }
      .module-title {
        font-size: clamp(1.5rem, 4vw, 2.25rem);
        margin: 0;
      }
      .module-body {
        display: grid;
        gap: 1.25rem;
      }
      .flashcard-grid,
      .lab-grid,
      .quiz-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 1rem;
      }
      .flashcard {
        border-radius: 18px;
        border: 1px solid var(--outline);
        padding: 1rem;
        background: rgba(15, 23, 42, 0.02);
        cursor: pointer;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }
      .flashcard.is-flipped {
        background: var(--accent);
        color: white;
        border-color: rgba(255, 255, 255, 0.4);
      }
      .flashcard:focus-visible,
      .flashcard:hover {
        transform: translateY(-4px);
        box-shadow: 0 15px 30px -25px rgba(15, 23, 42, 0.6);
      }
      .flashcard p {
        margin: 0;
      }
      .flashcard strong {
        display: block;
        font-size: 1.05rem;
      }
      .lab-wrapper {
        display: flex;
        flex-direction: column;
        gap: 1.25rem;
      }
      .lab-progress {
        border-radius: 24px;
        padding: 1rem 1.25rem;
        border: 1px solid rgba(79, 70, 229, 0.25);
        background: linear-gradient(120deg, rgba(79, 70, 229, 0.15), rgba(14, 165, 233, 0.08));
        box-shadow: 0 20px 50px -35px rgba(79, 70, 229, 0.8);
      }
      .lab-progress-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 1rem;
      }
      .lab-progress-header p {
        margin: 0;
        text-transform: uppercase;
        letter-spacing: 0.2em;
        font-size: 0.75rem;
        color: rgba(15, 23, 42, 0.65);
      }
      .lab-progress-count {
        display: block;
        font-size: 1.3rem;
        margin-top: 0.15rem;
      }
      .lab-progress-header span {
        font-size: 0.9rem;
        color: rgba(15, 23, 42, 0.75);
      }
      .lab-progress-track {
        height: 0.6rem;
        background: rgba(255, 255, 255, 0.5);
        border-radius: 999px;
        overflow: hidden;
        margin-top: 0.75rem;
      }
      .lab-progress-track span {
        display: block;
        height: 100%;
        width: 0%;
        background: linear-gradient(90deg, #4f46e5, #22d3ee);
        transition: width 0.4s ease;
      }
      .lab-steps {
        list-style: none;
        margin: 0;
        padding: 0;
        display: flex;
        flex-direction: column;
        gap: 0.85rem;
      }
      .lab-step {
        border-radius: 24px;
        border: 1px solid rgba(15, 23, 42, 0.08);
        background: white;
        box-shadow: 0 20px 45px -35px rgba(15, 23, 42, 0.8);
        transition: border-color 0.3s ease, transform 0.3s ease;
      }
      .lab-step label {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1rem 1.25rem;
        cursor: pointer;
      }
      .lab-step input[type='checkbox'] {
        appearance: none;
        width: 1.35rem;
        height: 1.35rem;
        border-radius: 6px;
        border: 2px solid rgba(15, 23, 42, 0.25);
        display: grid;
        place-items: center;
        transition: background 0.2s ease, border-color 0.2s ease;
      }
      .lab-step input[type='checkbox']::after {
        content: '\2713';
        font-size: 0.9rem;
        color: white;
        transform: scale(0);
        transition: transform 0.2s ease;
      }
      .lab-step input[type='checkbox']:checked {
        background: var(--accent);
        border-color: var(--accent);
      }
      .lab-step input[type='checkbox']:checked::after {
        transform: scale(1);
      }
      .lab-step-content {
        flex: 1;
        display: flex;
        gap: 1rem;
        align-items: flex-start;
      }
      .lab-step-pill {
        font-size: 0.85rem;
        font-weight: 600;
        color: var(--accent);
        background: rgba(79, 70, 229, 0.1);
        padding: 0.4rem 0.65rem;
        border-radius: 999px;
        min-width: 3.3rem;
        text-align: center;
      }
      .lab-step-content strong {
        display: block;
        font-size: 1.05rem;
        margin-bottom: 0.15rem;
      }
      .lab-step-content p {
        margin: 0;
        color: var(--muted);
      }
      .lab-step.completed {
        border-color: rgba(79, 70, 229, 0.5);
        transform: translateX(6px);
      }
      .lab-step.completed .lab-step-pill {
        background: var(--accent);
        color: white;
      }
      .slider-block {
        display: grid;
        gap: 0.6rem;
      }
      .slider-label {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 0.75rem;
      }
      .slider-label output {
        font-weight: 700;
        color: var(--accent);
      }
      .slider-block input[type='range'] {
        width: 100%;
        accent-color: var(--accent);
      }
      .generator-panel {
        border-radius: 22px;
        border: 1px solid var(--outline);
        padding: 1.25rem;
        background: rgba(14, 165, 233, 0.04);
      }
      .generator-output {
        border-radius: 16px;
        padding: 1rem;
        min-height: 60px;
        background: white;
        border: 1px dashed var(--outline);
      }
      .module-actions {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
        margin-top: 1rem;
      }
      .btn {
        border-radius: 999px;
        padding: 0.55rem 1.4rem;
        border: none;
        cursor: pointer;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
      }
      .btn-primary {
        background: var(--accent);
        color: white;
      }
      .btn-secondary {
        background: rgba(15, 23, 42, 0.08);
        color: var(--ink);
      }
      .quiz-card {
        border: 1px solid var(--outline);
        border-radius: 20px;
        padding: 1rem;
        background: rgba(79, 70, 229, 0.04);
      }
      .quiz-options {
        display: grid;
        gap: 0.4rem;
        margin-top: 0.75rem;
      }
      .quiz-options label {
        border-radius: 14px;
        border: 1px solid rgba(79, 70, 229, 0.25);
        padding: 0.65rem 0.9rem;
        display: flex;
        align-items: center;
        gap: 0.6rem;
        cursor: pointer;
      }
      .quiz-options input {
        accent-color: var(--accent);
      }
      .guide-frame {
        width: 100%;
        border: none;
        border-radius: 24px;
        min-height: 480px;
        background: white;
      }
      .status-pill {
        display: inline-flex;
        align-items: center;
        gap: 0.45rem;
        padding: 0.35rem 0.85rem;
        border-radius: 999px;
        background: rgba(16, 185, 129, 0.12);
        color: var(--success);
        font-weight: 600;
        font-size: 0.9rem;
      }
      .drawer-toggle {
        display: inline-flex;
        align-items: center;
        gap: 0.4rem;
        border-radius: 999px;
        border: 1px solid rgba(15, 23, 42, 0.2);
        padding: 0.45rem 1rem;
        background: white;
        cursor: pointer;
        font-weight: 600;
        margin-bottom: 1.5rem;
      }
      .drawer {
        position: fixed;
        top: 0;
        bottom: 0;
        left: 0;
        width: min(320px, 90vw);
        background: rgba(9, 9, 20, 0.95);
        color: white;
        padding: 2rem 1.25rem;
        transform: translateX(-100%);
        transition: transform 0.35s ease;
        z-index: 10;
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
      }
      .drawer.open {
        transform: translateX(0);
      }
      .drawer header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 0.5rem;
      }
      .drawer nav {
        display: flex;
        flex-direction: column;
        gap: 0.65rem;
      }
      .drawer a {
        color: rgba(255, 255, 255, 0.85);
        text-decoration: none;
        font-weight: 600;
        padding: 0.4rem 0.5rem;
        border-radius: 10px;
        display: inline-flex;
        align-items: center;
        gap: 0.6rem;
      }
      .drawer a.active {
        background: rgba(79, 70, 229, 0.35);
      }
      .drawer-close {
        background: none;
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 999px;
        color: white;
        padding: 0.35rem 0.9rem;
        cursor: pointer;
      }
      .drawer-overlay {
        position: fixed;
        inset: 0;
        background: rgba(15, 23, 42, 0.45);
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
        z-index: 9;
      }
      .drawer-overlay.visible {
        opacity: 1;
        pointer-events: auto;
      }
      .mission-item,
      .challenge,
      .case-button {
        width: 100%;
        border: 1px solid rgba(148, 163, 184, 0.5);
        background: white;
        border-radius: 1.5rem;
        padding: 1rem 1.1rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 1rem;
        text-align: left;
        font-size: 0.9rem;
        font-weight: 500;
        color: #1f2937;
        transition: all 0.2s ease;
        cursor: pointer;
      }
      .mission-item:hover,
      .challenge:hover,
      .case-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 15px 30px -20px rgba(15, 23, 42, 0.4);
        border-color: rgba(79, 70, 229, 0.4);
      }
      .mission-item.completed,
      .challenge.completed {
        background: linear-gradient(120deg, rgba(16, 185, 129, 0.15), rgba(59, 130, 246, 0.15));
        border-color: rgba(16, 185, 129, 0.6);
      }
      .mission-item i,
      .challenge i {
        color: #6366f1;
      }
      .case-button {
        justify-content: center;
        font-weight: 600;
        background: linear-gradient(135deg, #4c1d95, #2563eb);
        color: white;
        border-color: transparent;
      }
      .case-button i {
        margin-right: 0.5rem;
      }
      .flip-card {
        position: relative;
        width: 100%;
        border: none;
        padding: 0;
        background: transparent;
        perspective: 1200px;
      }
      .flip-card-inner {
        position: relative;
        width: 100%;
        min-height: 180px;
        border-radius: 1.5rem;
        transform-style: preserve-3d;
        transition: transform 0.6s ease;
        background: linear-gradient(135deg, rgba(15, 23, 42, 0.95), rgba(76, 29, 149, 0.9));
        color: white;
        padding: 1.5rem;
      }
      .flip-card.is-flipped .flip-card-inner {
        transform: rotateY(180deg);
      }
      .flip-card-front,
      .flip-card-back {
        position: absolute;
        inset: 0;
        backface-visibility: hidden;
        display: flex;
        flex-direction: column;
        justify-content: center;
      }
      .flip-card-back {
        transform: rotateY(180deg);
        color: #e2e8f0;
        font-size: 0.9rem;
      }
      .lab-button {
        border: 1px solid rgba(148, 163, 184, 0.6);
        border-radius: 999px;
        padding: 0.5rem 1.5rem;
        font-size: 0.95rem;
        font-weight: 600;
        color: #475569;
        background: white;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        transition: all 0.2s ease;
      }
      .lab-button.active {
        background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(14, 165, 233, 0.15));
        border-color: rgba(79, 70, 229, 0.5);
        color: #1f2937;
      }
      .lab-panel {
        display: none;
        animation: fadeIn 0.3s ease;
      }
      .lab-panel.active {
        display: block;
      }
      .timeline {
        border-left: 3px solid rgba(148, 163, 184, 0.5);
        padding-left: 1.5rem;
        display: grid;
        gap: 1.5rem;
      }
      .timeline-label {
        font-size: 0.85rem;
        text-transform: uppercase;
        letter-spacing: 0.2em;
        color: #94a3b8;
      }
      .teaching-note {
        border: 1px solid rgba(148, 163, 184, 0.5);
        border-radius: 1.25rem;
        padding: 1rem 1.2rem;
        background: #f8fafc;
      }
      .teaching-note summary {
        cursor: pointer;
        list-style: none;
      }
      .teaching-note summary::-webkit-details-marker {
        display: none;
      }
      .quiz {
        border: 1px solid rgba(148, 163, 184, 0.5);
        border-radius: 1.5rem;
        padding: 2rem;
        background: #f8fafc;
        display: grid;
        gap: 2rem;
      }
      .quiz-options {
        display: grid;
        gap: 0.75rem;
      }
      .quiz-options button {
        width: 100%;
        border-radius: 999px;
        padding: 0.65rem 1.2rem;
        border: 1px solid rgba(148, 163, 184, 0.7);
        background: white;
        text-align: left;
        transition: all 0.2s ease;
      }
      .quiz-options button.selected {
        border-color: rgba(79, 70, 229, 0.7);
        background: rgba(99, 102, 241, 0.08);
      }
      .quiz-options button.correct {
        border-color: rgba(16, 185, 129, 0.8);
        background: rgba(16, 185, 129, 0.15);
      }
      .quiz-options button.incorrect {
        border-color: rgba(239, 68, 68, 0.8);
        background: rgba(239, 68, 68, 0.15);
      }
      .reference-card {
        border: 1px solid rgba(148, 163, 184, 0.5);
        border-radius: 1.25rem;
        padding: 1.25rem;
        background: #f8fafc;
      }
      .reference-card h3 {
        font-weight: 700;
        color: #1f2937;
      }
      .reference-card span {
        font-size: 0.85rem;
        color: #94a3b8;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(8px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      @media (max-width: 768px) {
        .cranial-map {
          padding: 2.5rem 1.5rem 12rem;
        }
        .drawer,
        .drawer-overlay,
        .drawer-toggle {
          display: none;
        }
        .sidebar-static {
          position: sticky;
          top: 2rem;
          align-self: start;
          padding: 2rem 1.25rem;
          border-radius: 28px;
          background: rgba(15, 23, 42, 0.92);
          color: white;
          border: 1px solid rgba(255, 255, 255, 0.12);
          box-shadow: 0 35px 80px -60px rgba(15, 23, 42, 1);
          display: flex;
          flex-direction: column;
          gap: 1.5rem;
        }
        .sidebar-static nav {
          display: flex;
          flex-direction: column;
          gap: 0.45rem;
        }
        .sidebar-static a {
          color: rgba(255, 255, 255, 0.85);
          text-decoration: none;
          padding: 0.35rem 0.4rem;
          border-radius: 10px;
          display: inline-flex;
          align-items: center;
          gap: 0.6rem;
        }
        .sidebar-static a.active {
          background: rgba(79, 70, 229, 0.35);
        }
      }
      @media (prefers-reduced-motion: reduce) {
        html {
          scroll-behavior: auto;
        }
        *,
        *::before,
        *::after {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }
        .flashcard,
        .drawer,
        .drawer-overlay,
        .drawer-toggle {
          transition: none !important;
        }
      }
    </style>
  </head>
  <body class="bg-slate-50 text-slate-800 font-sans">
    <header class="bg-white/80 backdrop-blur-lg border-b border-slate-200 sticky top-0 z-40">
      <div
        class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between"
      >
        <a href="../neurologia.html" class="flex items-center space-x-3">
          <div
            class="h-10 w-10 rounded-full bg-gradient-to-br from-indigo-500 to-sky-500 flex items-center justify-center text-white"
          >
            <i class="fas fa-brain text-xl"></i>
          </div>
          <nav class="sidebar-links"></nav>
          <div>
            <p style="margin: 0 0 0.35rem; font-size: 0.85rem; opacity: 0.8">Tip</p>
            <p style="margin: 0; font-size: 0.95rem">
              Cada módulo usa plantillas dinámicas. Edita el texto en un solo lugar y evitarás conflictos.
            </p>
          </div>
        </aside>
        <main class="main-card">
          <div class="hero">
            <article class="hero-card">
              <p class="chip">Examen neurológico · parte 2</p>
              <h1>Entrenamiento gamificado</h1>
              <p>
                Explora cada sistema neurológico mediante tarjetas, laboratorios, generadores de casos y un
                quiz que calcula tu XP automáticamente.
              </p>
              <div class="chip-row">
                <span class="chip">Pares craneales</span>
                <span class="chip">Motor</span>
                <span class="chip">Sensitivo</span>
                <span class="chip">Integración</span>
              </div>
            </article>
            <article class="score-card" aria-live="polite">
              <div style="display: flex; align-items: center; justify-content: space-between">
                <div>
                  <p style="margin: 0; letter-spacing: 0.3em; font-size: 0.75rem">Tablero</p>
                  <strong style="font-size: 2.4rem" id="xpCounter">1200 XP</strong>
                </div>
                <div>
                  <p style="margin: 0; opacity: 0.8">Racha</p>
                  <strong id="streakCounter">x3</strong>
                </div>
              </div>
              <div class="progress-track" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="40">
                <span id="progressTrack"></span>
              </div>
              <div class="score-grid">
                <div class="score-tile">
                  <span>Misiones</span>
                  <strong id="missionCount">0/0</strong>
                </div>
                <div class="score-tile">
                  <span>Flashcards</span>
                  <strong id="cardCount">0</strong>
                </div>
                <div class="score-tile">
                  <span>Retos</span>
                  <strong id="challengeCount">0</strong>
                </div>
              </div>
            </article>
          </div>
          <div class="modules-grid" id="modules"></div>
        </main>
      </div>
    </div>
    <script>
      const modules = [
        {
          id: 'pares-craneales',
          number: '01',
          icon: 'fa-brain',
          title: 'Pares craneales',
          intro:
            'Memoriza las funciones y pruebas rápidas con tarjetas volteables. Cada click revela maniobras clave.',
          type: 'flashcards',
          cards: [
            { title: 'I · Olfatorio', description: 'Identificar olores con cada fosa nasal por separado.' },
            { title: 'II · Óptico', description: 'Evaluar agudeza, campos visuales y fondo de ojo.' },
            {
              title: 'III, IV, VI',
              description: 'Motilidad ocular extrínseca, reflejo fotomotor y seguimiento suave.'
            },
            { title: 'V · Trigémino', description: 'Tono masetero, reflejo corneal y sensibilidad facial.' },
            { title: 'VII · Facial', description: 'Mímica facial simétrica, gusto en 2/3 anteriores.' },
            { title: 'VIII · Vestibulococlear', description: 'Pruebas de Rinne y Weber, equilibrio.' },
            { title: 'IX, X · Glosofaríngeo/Vago', description: 'Reflejo nauseoso y elevación del paladar.' },
            { title: 'XI · Accesorio', description: 'Fuerza del esternocleidomastoideo y trapecio.' },
            { title: 'XII · Hipogloso', description: 'Movimientos linguales, fasciculaciones y desviaciones.' }
          ]
        },
        {
          id: 'sistema-motor',
          number: '02',
          icon: 'fa-dumbbell',
          title: 'Sistema motor',
          intro:
            'Organiza la fuerza, el tono y los reflejos usando un laboratorio con pasos guiados que puedes marcar.',
          type: 'lab',
          steps: [
            {
              title: 'Inspección',
              detail: 'Busca atrofias, fasciculaciones y postura antálgica desde la entrada del paciente.'
            },
            {
              title: 'Tono y fuerza',
              detail:
                'Palpa la resistencia pasiva y califica la fuerza (0-5) en flexión/extensión de hombro, codo y muñeca.'
            },
            {
              title: 'Reflejos',
              detail: 'Rotuliano, aquíleo, bicipital y tricipital, registrando hiporreflexia o clonus.'
            },
            {
              title: 'Pruebas superiores',
              detail: 'Índice-nariz, talón-rodilla y maniobras de pronador para vías piramidales.'
            }
          ]
        },
        {
          id: 'sistema-sensitivo',
          number: '03',
          icon: 'fa-wave-square',
          title: 'Sistema sensitivo',
          intro:
            'Ajusta los umbrales de dolor, tacto, vibración y propiocepción con un control único para documentar hallazgos.',
          type: 'slider',
          slider: {
            min: 0,
            max: 10,
            value: 5,
            label: 'Umbral percibido',
            description: 'Desliza según la respuesta del paciente para estimar la intensidad mínima percibida.'
          },
          checklist: [
            'Dolor (estímulo punzante vs. romo)',
            'Tacto ligero con torundas',
            'Vibración con diapasón 128 Hz',
            'Propiocepción en articulaciones distales'
          ]
        },
        {
          id: 'integracion',
          number: '04',
          icon: 'fa-flask',
          title: 'Integración clínica',
          intro:
            'Genera casos y patrones electrodiagnósticos aleatorios para que la discusión sea distinta cada vez.',
          type: 'generator',
          cases: [
            'Paciente con diplopía horizontal y ptosis progresiva',
            'Temblor de reposo, bradicinesia y rigidez en rueda dentada',
            'Parestesias en guante y media con antecedente metabólico',
            'Debilidad proximal con CK elevada y reflejos conservados',
            'Ataxia aguda tras cuadro viral en pediatría'
          ],
          patterns: [
            'EMG con descargas repetitivas y patrón miopático',
            'Velocidades de conducción disminuidas difusamente',
            'Resonancia con lesiones periventriculares',
            'Potenciales evocados visuales prolongados',
            'LCR con disociación albúmino-citológica'
          ]
        },
        {
          id: 'demostracion',
          number: '05',
          icon: 'fa-chalkboard-user',
          title: 'Demostración guiada',
          intro:
            'Observa la secuencia en video o utiliza la rúbrica paso a paso para evaluar a tus compañeros.',
          type: 'demo',
          video: 'https://www.youtube.com/embed/4J0s9l9Q-rA',
          rubric: [
            'Presentación y explicación del procedimiento',
            'Secuencia lógica: inspección, palpación, maniobras',
            'Comunicación clara con el paciente simulado',
            'Registro completo de hallazgos positivos y negativos'
          ]
        },
        {
          id: 'auto-evaluacion',
          number: '06',
          icon: 'fa-question',
          title: 'Autoevaluación',
          intro:
            'Responde la batería rápida de tres reactivos. Cada respuesta correcta suma 150 XP y aumenta la racha.',
          type: 'quiz',
          questions: [
            {
              prompt: '¿Qué par craneal controla el reflejo corneal aferente?',
              options: ['VII', 'V', 'III'],
              answer: 'V'
            },
            {
              prompt: 'Una hipotonía generalizada con hiporreflexia orienta a un patrón…',
              options: ['Central', 'Periférico', 'Funcional'],
              answer: 'Periférico'
            },
            {
              prompt: 'El signo de Romberg positivo se documenta dentro de…',
              options: ['Sensibilidad profunda', 'Sistema motor', 'Integración cortical'],
              answer: 'Sensibilidad profunda'
            }
          ]
        },
        {
          id: 'guia-interactiva',
          number: '07',
          icon: 'fa-compass-drafting',
          title: 'Guía interactiva',
          intro:
            'Consulta la guía desplegable con checklists imprimibles. Puedes refrescarla sin salir de la página.',
          type: 'guide',
          url: 'https://script.google.com/macros/s/AKfycbycyUCZNCgbrKE9tGdKOsvfDnYFkxSJbE0811P7bXwVoRwktwTdUr4Uarw4f-Eg9sbhtQ/exec'
        },
        {
          id: 'bibliografia',
          number: '08',
          icon: 'fa-book',
          title: 'Bibliografía mínima',
          intro:
            'Mantén una lista corta de referencias para citar al presentar tus hallazgos clínicos y electrofisiológicos.',
          type: 'list',
          resources: [
            'DeMyer W. Técnica del examen neurológico',
            'Preston & Shapiro. Electromiografía y conducción nerviosa',
            'Adams y Victor. Principios de neurología',
            'AAN Practice Parameters para EMG y NCV'
          ]
        }
      ];

      const modulesContainer = document.getElementById('modules');
      const sidebarLinks = document.querySelector('.sidebar-links');
      const drawerLinks = document.querySelector('.drawer-links');

      function createElement(html) {
        const template = document.createElement('template');
        template.innerHTML = html.trim();
        return template.content.firstElementChild;
      }

      function renderNav(linkContainer) {
        linkContainer.innerHTML = '';
        modules.forEach((module) => {
          const link = createElement(
            `<a href="#${module.id}"><i class="fa-solid ${module.icon}" aria-hidden="true"></i><span>${module.number}. ${module.title}</span></a>`
          );
          linkContainer.appendChild(link);
        });
      }

      function renderFlashcards(cards) {
        const grid = document.createElement('div');
        grid.className = 'flashcard-grid';
        cards.forEach((card) => {
          const flashcard = createElement(
            `<article class="flashcard" tabindex="0" aria-label="${card.title}">
              <strong>${card.title}</strong>
              <p>${card.description}</p>
            </article>`
          );
          flashcard.addEventListener('click', () => flashcard.classList.toggle('is-flipped'));
          flashcard.addEventListener('keypress', (event) => {
            if (event.key === 'Enter') {
              flashcard.classList.toggle('is-flipped');
            }
          });
          grid.appendChild(flashcard);
        });
        return grid;
      }

      function renderLab(steps) {
        const wrapper = document.createElement('div');
        wrapper.className = 'lab-wrapper';
        const progress = createElement(
          `<div class="lab-progress" role="status" aria-live="polite">
            <div class="lab-progress-header">
              <div>
                <p>Checklist motor</p>
                <strong class="lab-progress-count">0/${steps.length} pasos completados</strong>
              </div>
              <span>Marca cada paso tras ejecutarlo.</span>
            </div>
            <div class="lab-progress-track" aria-hidden="true">
              <span></span>
            </div>
          </div>`
        );
        const list = document.createElement('ol');
        list.className = 'lab-steps';
        const fill = progress.querySelector('.lab-progress-track span');
        const counter = progress.querySelector('.lab-progress-count');

        const updateProgress = () => {
          const total = steps.length;
          const checked = list.querySelectorAll('input:checked').length;
          const percent = total === 0 ? 0 : Math.round((checked / total) * 100);
          fill.style.width = `${percent}%`;
          counter.textContent = `${checked}/${total} pasos completados`;
        };

        steps.forEach((step, index) => {
          const item = createElement(
            `<li class="lab-step">
              <label>
                <input type="checkbox" aria-label="Marcar ${step.title}" />
                <div class="lab-step-content">
                  <span class="lab-step-pill">Paso ${String(index + 1).padStart(2, '0')}</span>
                  <div>
                    <strong>${step.title}</strong>
                    <p>${step.detail}</p>
                  </div>
                </div>
              </label>
            </li>`
          );
          const checkbox = item.querySelector('input');
          checkbox.addEventListener('change', () => {
            item.classList.toggle('completed', checkbox.checked);
            updateProgress();
          });
          list.appendChild(item);
        });

        wrapper.appendChild(progress);
        wrapper.appendChild(list);
        updateProgress();
        return wrapper;
      }

    <main class="max-w-7xl mx-auto px-6 py-12 space-y-12">
      <section
        class="bg-white rounded-3xl p-8 lg:p-12 shadow-lg relative overflow-hidden"
      >
        <div class="relative z-10 grid gap-8 lg:grid-cols-[2fr_1.2fr]">
          <div class="space-y-6">
            <p
              class="text-sm uppercase tracking-[0.45em] text-indigo-600 font-semibold"
            >
              Misión inmersiva
            </p>
            <h2 class="text-4xl lg:text-5xl font-bold leading-tight text-slate-900">
              Domina la segunda parte del examen neurológico con una experiencia
              pedagógica, interactiva y gamificada
            </h2>
            <p class="text-lg text-slate-600">
              Avanza por retos prácticos, desbloquea insignias clínicas y pon a
              prueba tus habilidades diagnósticas en tiempo real.
            </p>
            <div class="flex flex-wrap gap-4 text-sm">
              <span
                class="px-4 py-2 rounded-full bg-indigo-100 text-indigo-800 font-semibold"
                >Pares craneales VII-XII</span
              >
              <span
                class="px-4 py-2 rounded-full bg-white/10 border border-white/20"
                >Sistema motor</span
              >
              <span
                class="px-4 py-2 rounded-full bg-white/10 border border-white/20"
                >Sistema sensitivo</span
              >
            </div>
          </div>
          <div
            class="bg-slate-900/20 backdrop-blur-xl rounded-3xl border border-slate-100/20 p-6 flex flex-col gap-6 text-white"
          >
            <div class="flex items-center justify-between">
              <div>
                <p class="text-sm text-slate-300">Puntaje acumulado</p>
                <p class="text-4xl font-black" data-xp-display>0</p>
              </div>
              <div class="text-right">
                <p class="text-sm text-slate-300">Racha clínica</p>
                <p class="text-3xl font-black" data-streak>0</p>
              </div>
            </div>
            <div>
              <p class="text-xs uppercase tracking-[0.4em] text-slate-300">
                Progreso del módulo
              </p>
              <div class="mt-3 h-3 bg-white/10 rounded-full overflow-hidden">
                <div
                  class="h-full bg-gradient-to-r from-emerald-400 via-sky-400 to-indigo-400"
                  style="width: 0%"
                  data-progress-bar
                ></div>
              </div>
              <p class="mt-2 text-sm text-slate-200" data-progress-text>
                0% completado
              </p>
            </div>
            <div class="grid grid-cols-2 gap-3 text-sm">
              <div
                class="p-4 rounded-2xl bg-slate-900/25 border border-slate-100/20"
              >
                <p class="text-xs uppercase tracking-[0.3em] text-slate-300">
                  Modalidad
                </p>
                <p class="mt-1 font-semibold">Aprendizaje activo</p>
              </div>
              <div
                class="p-4 rounded-2xl bg-slate-900/25 border border-slate-100/20"
              >
                <p class="text-xs uppercase tracking-[0.3em] text-slate-300">
                  Nivel
                </p>
                <p class="mt-1 font-semibold">Clínico intermedio</p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <div class="grid grid-cols-1 lg:grid-cols-[300px_minmax(0,1fr)] gap-10">
        <aside class="lg:sticky lg:top-28 space-y-6">
          <div
            class="bg-white/80 border border-slate-200 rounded-2xl shadow-sm p-6 backdrop-blur-lg"
          >
            <h2
              class="text-sm font-bold uppercase tracking-widest text-slate-400"
            >
              Mapa del módulo
            </h2>
            <nav class="mt-4 space-y-1" id="module-nav">
              <a href="#pares-craneales" class="nav-link">
                <span
                  class="flex items-center gap-3 py-2 px-3 rounded-xl text-sm font-semibold text-slate-600 hover:bg-indigo-50"
                >
                  <i class="fas fa-brain text-indigo-500"></i>
                  Pares craneales (VII-XII)
                </span>
              </a>
              <a href="#sistema-motor" class="nav-link">
                <span
                  class="flex items-center gap-3 py-2 px-3 rounded-xl text-sm font-semibold text-slate-600 hover:bg-indigo-50"
                >
                  <i class="fas fa-running text-indigo-500"></i>
                  Sistema motor
                </span>
              </a>
              <a href="#sistema-sensitivo" class="nav-link">
                <span
                  class="flex items-center gap-3 py-2 px-3 rounded-xl text-sm font-semibold text-slate-600 hover:bg-indigo-50"
                >
                  <i class="fas fa-hand-paper text-indigo-500"></i>
                  Sistema sensitivo
                </span>
              </a>
              <a href="#demostracion-practica" class="nav-link">
                <span
                  class="flex items-center gap-3 py-2 px-3 rounded-xl text-sm font-semibold text-slate-600 hover:bg-indigo-50"
                >
                  <i class="fas fa-chalkboard-teacher text-indigo-500"></i>
                  Demostración y práctica
                </span>
              </a>
              <a href="#evaluacion-formativa" class="nav-link">
                <span
                  class="flex items-center gap-3 py-2 px-3 rounded-xl text-sm font-semibold text-slate-600 hover:bg-indigo-50"
                >
                  <i class="fas fa-tasks text-indigo-500"></i>
                  Evaluación formativa
                </span>
              </a>
              <a href="#bibliografia" class="nav-link">
                <span
                  class="flex items-center gap-3 py-2 px-3 rounded-xl text-sm font-semibold text-slate-600 hover:bg-indigo-50"
                >
                  <i class="fas fa-book text-indigo-500"></i>
                  Bibliografía
                </span>
              </a>
            </nav>
          </div>
          <input type="range" id="${sliderId}" min="${slider.min}" max="${slider.max}" value="${slider.value}" aria-describedby="${descriptionId}" />
          <p id="${descriptionId}">${slider.description}</p>
          <ul style="margin: 0; padding-left: 1.2rem; color: var(--muted)">
            ${checklist.map((item) => `<li>${item}</li>`).join('')}
          </ul>
        `;
        const sliderInput = block.querySelector('input');
        const sliderValue = block.querySelector('output');
        sliderInput.addEventListener('input', () => {
          sliderValue.textContent = sliderInput.value;
        });
        return block;
      }

      function renderGenerator(data) {
        const panel = document.createElement('div');
        panel.className = 'generator-panel';
        panel.innerHTML = `
          <div class="generator-output" id="caseOutput" role="status" aria-live="polite">Pulsa «Nuevo caso».</div>
          <div class="module-actions">
            <button class="btn btn-primary" type="button" data-action="case"><i class="fa-solid fa-shuffle" aria-hidden="true"></i> Nuevo caso</button>
            <button class="btn btn-secondary" type="button" data-action="pattern"><i class="fa-solid fa-wave-square" aria-hidden="true"></i> Patrón electrodiagnóstico</button>
          </div>
        `;
        const output = panel.querySelector('#caseOutput');
        panel.querySelectorAll('button').forEach((button) => {
          button.addEventListener('click', () => {
            const pool = button.dataset.action === 'case' ? data.cases : data.patterns;
            const choice = pool[Math.floor(Math.random() * pool.length)];
            output.textContent = choice;
            updateChallenges(40);
          });
        });
        return panel;
      }

      function renderDemo(module) {
        const wrapper = document.createElement('div');
        wrapper.className = 'module-body';
        wrapper.innerHTML = `
          <div style="position: relative; padding-top: 56.25%; border-radius: 20px; overflow: hidden; border: 1px solid var(--outline)">
            <iframe src="${module.video}" title="Demostración" allowfullscreen style="position:absolute; inset:0; width:100%; height:100%; border:0"></iframe>
          </div>
          <div>
            <h4>Rúbrica rápida</h4>
            <ul style="margin: 0; padding-left: 1.2rem; color: var(--muted)">
              ${module.rubric.map((item) => `<li>${item}</li>`).join('')}
            </ul>
          </div>
        `;
        return wrapper;
      }

      function renderQuiz(module) {
        const grid = document.createElement('div');
        grid.className = 'quiz-grid';
        module.questions.forEach((question, index) => {
          const card = createElement(
            `<article class="quiz-card">
              <strong>Pregunta ${index + 1}</strong>
              <p>${question.prompt}</p>
              <div class="quiz-options">
                ${question.options
                  .map(
                    (option, optionIndex) => `
                      <label>
                        <input type="radio" name="quiz-${index}" value="${option}" />
                        <span>${option}</span>
                      </label>
                    `
                  )
                  .join('')}
              </div>
            </article>`
          );
          grid.appendChild(card);
        });
        const actions = createElement(
          `<div class="module-actions">
            <button class="btn btn-primary" type="button" id="submitQuiz">
              <i class="fa-solid fa-check" aria-hidden="true"></i>
              Calificar
            </button>
            <div class="status-pill" aria-live="polite" id="quizStatus">
              <i class="fa-solid fa-star" aria-hidden="true"></i>
              Listo para responder
            </div>
          </div>`
        );
        actions.querySelector('#submitQuiz').addEventListener('click', () => {
          let score = 0;
          module.questions.forEach((question, index) => {
            const selected = grid.querySelector(`input[name="quiz-${index}"]:checked`);
            if (selected && selected.value === question.answer) {
              score += 1;
            }
          });
          const status = actions.querySelector('#quizStatus');
          status.textContent = `Aciertos: ${score}/${module.questions.length}`;
          if (score > 0) {
            updateXP(score * 150);
            updateChallenges(score * 50);
          }
        });
        const fragment = document.createDocumentFragment();
        fragment.appendChild(grid);
        fragment.appendChild(actions);
        return fragment;
      }

      function renderGuide(module) {
        const wrapper = document.createElement('div');
        wrapper.className = 'module-body';
        wrapper.innerHTML = `
          <div class="status-pill" aria-live="polite" id="guideStatus">
            <i class="fa-solid fa-circle-notch fa-spin" aria-hidden="true"></i>
            Cargando guía…
          </div>

          <div class="bg-white border border-slate-200 rounded-2xl shadow-sm p-6">
            <h3 class="text-sm font-semibold uppercase tracking-[0.35em] text-slate-400">
              Misiones del día
            </h3>
            <p class="mt-2 text-sm text-slate-500">
              Marca cada reto cuando lo domines y observa cómo sube tu progreso.
            </p>
            <div class="mt-4 space-y-3">
              <button type="button"
                class="mission-item"
                data-mission
                data-xp="25"
              >
                <span>
                  <strong>Explora</strong> los pares craneales VII-XII y describe dos maniobras clave.
                </span>
                <i class="fas fa-check"></i>
              </button>
              <button type="button" class="mission-item" data-mission data-xp="20">
                <span>
                  <strong>Ejecuta</strong> la evaluación de fuerza y tono en al menos tres grupos musculares.
                </span>
                <i class="fas fa-check"></i>
              </button>
              <button type="button" class="mission-item" data-mission data-xp="20">
                <span>
                  <strong>Integra</strong> pruebas de sensibilidad superficial y profunda.
                </span>
                <i class="fas fa-check"></i>
              </button>
              <button type="button" class="mission-item" data-mission data-xp="15">
                <span>
                  <strong>Comparte</strong> tus hallazgos con un compañero para recibir retroalimentación.
                </span>
                <i class="fas fa-check"></i>
              </button>
            </div>
          </div>
        </aside>

        <section class="space-y-12">
          <section
            id="pares-craneales"
            class="bg-white border border-slate-200 rounded-3xl shadow-lg p-8 lg:p-12 space-y-10"
          >
            <h2 class="text-3xl font-bold text-slate-900">Pares craneales (VII-XII)</h2>
            <p class="mt-4 text-lg text-slate-600">
              Evalúa la simetría facial, los reflejos bulbares, la fonación, la deglución y la movilidad lingual con una ruta guiada.
            </p>
            <div class="grid gap-10 lg:grid-cols-2">
              <div class="space-y-6">
                <div class="p-5 rounded-2xl border border-slate-200 bg-slate-50">
                  <h3 class="font-semibold text-slate-800">Secuencia sugerida</h3>
                  <ol class="mt-4 space-y-3 text-slate-600">
                    <li class="flex gap-3">
                      <span class="font-bold text-indigo-500">1.</span>
                      Inspecciona mímica facial, eleva las cejas y realiza la prueba de arrugar la frente (VII).
                    </li>
                    <li class="flex gap-3">
                      <span class="font-bold text-indigo-500">2.</span>
                      Evalúa audición con frote digital y equilibrio con prueba de Romberg (VIII).
                    </li>
                    <li class="flex gap-3">
                      <span class="font-bold text-indigo-500">3.</span>
                      Observa úvula y reflejo nauseoso, pide pronunciar "kaa" y "goo" (IX-X).
                    </li>
                    <li class="flex gap-3">
                      <span class="font-bold text-indigo-500">4.</span>
                      Explora elevación del trapecio y rotación cefálica contra resistencia (XI).
                    </li>
                    <li class="flex gap-3">
                      <span class="font-bold text-indigo-500">5.</span>
                      Analiza protrusión lingual, movimientos laterales y fasciculaciones (XII).
                    </li>
                  </ol>
                </div>
                <div class="space-y-4">
                  <h3 class="font-semibold text-slate-800">Flashcards interactivas</h3>
                  <div class="grid gap-4 md:grid-cols-2" data-flashcards>
                    <button type="button" class="flip-card" data-flip-card>
                      <div class="flip-card-inner">
                        <div class="flip-card-front">
                          <p class="text-sm uppercase tracking-[0.3em] text-indigo-500">Reto</p>
                          <p class="text-lg font-semibold mt-2">Explora el signo de Bell</p>
                        </div>
                        <div class="flip-card-back">
                          <p class="text-slate-100">
                            Observa incapacidad para cerrar completamente los párpados en parálisis facial periférica (VII).
                          </p>
                        </div>
                      </div>
                    </button>
                    <button type="button" class="flip-card" data-flip-card>
                      <div class="flip-card-inner">
                        <div class="flip-card-front">
                          <p class="text-sm uppercase tracking-[0.3em] text-indigo-500">Reto</p>
                          <p class="text-lg font-semibold mt-2">Test de Weber</p>
                        </div>
                        <div class="flip-card-back">
                          <p class="text-slate-100">
                            Lateraliza la vibración al oído afectado en hipoacusia conductiva y al sano en neurosensorial (VIII).
                          </p>
                        </div>
                      </div>
                    </button>
                    <button type="button" class="flip-card" data-flip-card>
                      <div class="flip-card-inner">
                        <div class="flip-card-front">
                          <p class="text-sm uppercase tracking-[0.3em] text-indigo-500">Reto</p>
                          <p class="text-lg font-semibold mt-2">Reflejo nauseoso</p>
                        </div>
                        <div class="flip-card-back">
                          <p class="text-slate-100">
                            Respuesta aferente IX y eferente X; ausencia unilateral orienta a lesión bulbar.
                          </p>
                        </div>
                      </div>
                    </button>
                    <button type="button" class="flip-card" data-flip-card>
                      <div class="flip-card-inner">
                        <div class="flip-card-front">
                          <p class="text-sm uppercase tracking-[0.3em] text-indigo-500">Reto</p>
                          <p class="text-lg font-semibold mt-2">Lengua en sable</p>
                        </div>
                        <div class="flip-card-back">
                          <p class="text-slate-100">
                            La desviación hacia el lado lesionado indica hipogloso ipsilateral afectado.
                          </p>
                        </div>
                      </div>
                    </button>
                  </div>
                </div>
              </div>
              <div class="cranial-map">
                <div class="nerve-node" style="top: 12%; left: 12%">
                  <button type="button" class="nerve-pin">VII</button>
                  <div class="nerve-tooltip">
                    <h4>Facial</h4>
                    <p>Simetría facial, gusto 2/3 anteriores, reflejo corneal.</p>
                  </div>
                </div>
                <div class="nerve-node" style="top: 18%; right: 15%">
                  <button type="button" class="nerve-pin">VIII</button>
                  <div class="nerve-tooltip">
                    <h4>Vestibulococlear</h4>
                    <p>Audición, equilibrio, pruebas de Weber y Rinne.</p>
                  </div>
                </div>
                <div class="nerve-node" style="top: 45%; left: 20%">
                  <button type="button" class="nerve-pin">IX</button>
                  <div class="nerve-tooltip">
                    <h4>Glosofaríngeo</h4>
                    <p>Gusto posterior, reflejo nauseoso, elevación del paladar.</p>
                  </div>
                </div>
                <div class="nerve-node" style="top: 50%; right: 25%">
                  <button type="button" class="nerve-pin">X</button>
                  <div class="nerve-tooltip">
                    <h4>Vago</h4>
                    <p>Fonación, deglución, función parasimpática.</p>
                  </div>
                </div>
                <div class="nerve-node" style="bottom: 25%; left: 28%">
                  <button type="button" class="nerve-pin">XI</button>
                  <div class="nerve-tooltip">
                    <h4>Accesorio</h4>
                    <p>Trapecio y esternocleidomastoideo: fuerza y resistencia.</p>
                  </div>
                </div>
                <div class="nerve-node" style="bottom: 18%; right: 18%">
                  <button type="button" class="nerve-pin">XII</button>
                  <div class="nerve-tooltip">
                    <h4>Hipogloso</h4>
                    <p>Movimientos linguales, atrofia y fasciculaciones.</p>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <section
            id="sistema-motor"
            class="bg-white border border-slate-200 rounded-3xl shadow-lg p-8 lg:p-12 space-y-10"
          >
            <h2 class="text-3xl font-bold text-slate-900">Sistema motor</h2>
            <p class="mt-4 text-lg text-slate-600">
              Alterna entre fuerza, tono, reflejos y coordinación mediante el laboratorio interactivo; suma puntos adicionales si completas el simulador de caso.
            </p>
            <div class="bg-slate-50 border border-slate-200 rounded-2xl p-6">
              <div class="flex flex-wrap gap-3" role="tablist">
                <button type="button" class="lab-button active" data-lab-button="fuerza">
                  <i class="fas fa-dumbbell"></i> Fuerza
                </button>
                <button type="button" class="lab-button" data-lab-button="tono">
                  <i class="fas fa-wave-square"></i> Tono
                </button>
                <button type="button" class="lab-button" data-lab-button="reflejos">
                  <i class="fas fa-bolt"></i> Reflejos
                </button>
                <button type="button" class="lab-button" data-lab-button="coordinacion">
                  <i class="fas fa-project-diagram"></i> Coordinación
                </button>
              </div>
              <div class="mt-6" data-lab-panels>
                <article class="lab-panel active" data-lab-panel="fuerza">
                  <p>
                    Explora grupos musculares proximales y distales, compara lados y documenta en la escala MRC (0-5).
                  </p>
                  <ul class="mt-4 space-y-2 text-slate-600 list-disc list-inside">
                    <li>Deltoides, bíceps, interóseos, extensores de cadera, tibial anterior.</li>
                    <li>Busca fatigabilidad y pruebas funcionales (sentadillas, pinza fina).</li>
                  </ul>
                </article>
                <article class="lab-panel" data-lab-panel="tono">
                  <p>
                    Realiza movimientos pasivos rápidos y lentos. Identifica espasticidad (liberación piramidal) versus rigidez (parkinsonismo).
                  </p>
                  <p class="mt-4 text-slate-600">
                    Utiliza la maniobra del "rueda dentada" y el "clasp knife" como elementos clave.
                  </p>
                </article>
                <article class="lab-panel" data-lab-panel="reflejos">
                  <p>
                    Usa el martillo neurológico y compara respuesta con la escala 0-4+. Identifica signos de Babinski y Hoffman.
                  </p>
                  <p class="mt-4 text-slate-600">
                    Añade maniobras de refuerzo (Jendrassik) para potenciar reflejos perezosos.
                  </p>
                </article>
                <article class="lab-panel" data-lab-panel="coordinacion">
                  <p>
                    Emplea pruebas dedo-nariz, talón-rodilla y diadococinesia para localizar lesiones cerebelosas.
                  </p>
                  <p class="mt-4 text-slate-600">
                    Observa ataxia troncal, temblor intencional y dismetría como pistas clave.
                  </p>
                </article>
              </div>
            </div>
            <div class="grid gap-8 lg:grid-cols-2">
              <div class="border border-slate-200 rounded-2xl p-6">
                <h3 class="font-semibold text-slate-800">Reto motor cronometrado</h3>
                <p class="mt-2 text-sm text-slate-500">
                  Marca cada acción cuando la ejecutes para obtener una insignia adicional.
                </p>
                <div class="mt-4 space-y-3">
                  <button type="button" class="challenge" data-challenge data-xp="10">
                    <span>Evalúa movimientos en contra de la gravedad.</span>
                    <i class="fas fa-stopwatch"></i>
                  </button>
                  <button type="button" class="challenge" data-challenge data-xp="10">
                    <span>Describe dos signos piramidales presentes.</span>
                    <i class="fas fa-stopwatch"></i>
                  </button>
                  <button type="button" class="challenge" data-challenge data-xp="10">
                    <span>Documenta un hallazgo extrapiramidal.</span>
                    <i class="fas fa-stopwatch"></i>
                  </button>
                </div>
              </div>
              <div class="border border-slate-200 rounded-2xl p-6 bg-slate-50">
                <h3 class="font-semibold text-slate-800">Simulador de caso</h3>
                <p class="mt-2 text-sm text-slate-500">
                  Presiona "Generar caso" para recibir un paciente y decide qué maniobras priorizar.
                </p>
                <button type="button" class="case-button" data-case-button>
                  <i class="fas fa-dice"></i> Generar caso
                </button>
                <p class="mt-4 text-slate-700" data-case-output>
                  Aún no se ha generado un caso.
                </p>
              </div>
            </div>
          </section>

          <section
            id="sistema-sensitivo"
            class="bg-white border border-slate-200 rounded-3xl shadow-lg p-8 lg:p-12 space-y-10"
          >
            <h2 class="text-3xl font-bold text-slate-900">Sistema sensitivo</h2>
            <p class="mt-4 text-lg text-slate-600">
              Integra sensibilidad superficial, profunda y cortical con herramientas visuales que te ayudan a priorizar dermatomos y columnas sensitivas.
            </p>
            <div class="grid gap-8 lg:grid-cols-2">
              <div class="border border-slate-200 rounded-2xl p-6 bg-slate-50">
                <h3 class="font-semibold text-slate-800">Control deslizante de umbral</h3>
                <p class="text-sm text-slate-500">
                  Ajusta el rango y recibe recomendaciones automáticas.
                </p>
                <input
                  type="range"
                  min="0"
                  max="100"
                  value="40"
                  class="w-full mt-4"
                  data-threshold
                />
                <div class="mt-4 p-4 rounded-2xl bg-white border border-slate-200" data-threshold-output>
                  Umbral sugerido: <strong>40%</strong>. Prioriza pruebas táctiles ligeras.
                </div>
              </div>
              <div class="border border-slate-200 rounded-2xl p-6">
                <h3 class="font-semibold text-slate-800">Tablero de sensibilidad cortical</h3>
                <p class="text-sm text-slate-500">
                  Completa las tres tareas para consolidar el mapa sensitivo.
                </p>
                <div class="mt-4 space-y-3">
                  <button type="button" class="challenge" data-challenge data-xp="8">
                    <span>Estereognosia con dos objetos distintos.</span>
                    <i class="fas fa-braille"></i>
                  </button>
                  <button type="button" class="challenge" data-challenge data-xp="8">
                    <span>Graphesthesia en ambas manos.</span>
                    <i class="fas fa-braille"></i>
                  </button>
                  <button type="button" class="challenge" data-challenge data-xp="8">
                    <span>Discriminación de dos puntos (&lt;5 mm en pulpejos).</span>
                    <i class="fas fa-braille"></i>
                  </button>
                </div>
              </div>
            </div>
            <div class="border border-slate-200 rounded-2xl p-6">
              <h3 class="font-semibold text-slate-800">Generador de patrones sensitivos</h3>
              <p class="text-sm text-slate-500">
                Ideal para relacionar hallazgos con topografía medular o periférica.
              </p>
              <button type="button" class="case-button" data-pattern-button>
                <i class="fas fa-random"></i> Crear patrón
              </button>
              <p class="mt-4 text-slate-700" data-pattern-output>
                Sin patrón seleccionado.
              </p>
            </div>
          </section>

          <section
            id="demostracion-practica"
            class="bg-white border border-slate-200 rounded-3xl shadow-lg p-8 lg:p-12 space-y-8"
          >
            <h2 class="text-3xl font-bold text-slate-900">Demostración y práctica supervisada</h2>
            <p class="mt-4 text-lg text-slate-600">
              Sigue la ruta pedagógica y registra tus observaciones; comparte tus clips o notas para obtener retroalimentación inmediata.
            </p>
            <div class="timeline">
              <div>
                <p class="timeline-label">00:00 - 05:00</p>
                <h3>Anclaje visual</h3>
                <p>Observa postura, fasciculaciones, tropismos y tono global. Documenta con fotografías o bosquejos.</p>
              </div>
              <div>
                <p class="timeline-label">05:00 - 15:00</p>
                <h3>Maniobras guiadas</h3>
                <p>Combina evaluaciones motoras y sensitivas con comandos verbales claros. Invita al paciente a repetir instrucciones.</p>
              </div>
              <div>
                <p class="timeline-label">15:00 - 25:00</p>
                <h3>Retroalimentación</h3>
                <p>Contrasta hallazgos con tu equipo, identifica sesgos, refuerza maniobras difíciles.</p>
              </div>
            </div>
            <details class="teaching-note">
              <summary class="font-semibold text-slate-800">Consejo del tutor</summary>
              <p class="mt-2 text-slate-600">
                Utiliza frases gatillo como "siento resistencia al movimiento" o "la vibración se pierde en metatarso" para describir hallazgos en voz alta y fomentar memoria auditiva.
              </p>
            </details>
          </section>

          <section
            id="evaluacion-formativa"
            class="bg-white border border-slate-200 rounded-3xl shadow-lg p-8 lg:p-12 space-y-8"
          >
            <h2 class="text-3xl font-bold text-slate-900">Evaluación formativa</h2>
            <p class="mt-4 text-lg text-slate-600">
              Completa el cuestionario y revisa la rúbrica en tiempo real. Cada respuesta correcta suma puntos y potencia tu racha clínica.
            </p>
            <div class="quiz" data-quiz>
              <div class="space-y-4">
                <h3 class="font-semibold text-slate-800">1. Paciente con parálisis facial periférica</h3>
                <p class="text-sm text-slate-500">¿Cuál hallazgo esperas?</p>
                <div class="quiz-options">
                  <button type="button" data-answer="incorrect">Parálisis exclusiva del tercio inferior de la cara.</button>
                  <button type="button" data-answer="correct">Incapacidad de cerrar el ojo ipsilateral.</button>
                  <button type="button" data-answer="incorrect">Hiperacusia contralateral.</button>
                </div>
              </div>
              <div class="space-y-4">
                <h3 class="font-semibold text-slate-800">2. Lesión de cordones posteriores</h3>
                <p class="text-sm text-slate-500">¿Qué prueba priorizas?</p>
                <div class="quiz-options">
                  <button type="button" data-answer="correct">Sensibilidad vibratoria con diapasón.</button>
                  <button type="button" data-answer="incorrect">Prueba de temperatura.</button>
                  <button type="button" data-answer="incorrect">Reflejo cutáneo abdominal.</button>
                </div>
              </div>
              <div class="space-y-4">
                <h3 class="font-semibold text-slate-800">3. Sospecha de lesión bulbar</h3>
                <p class="text-sm text-slate-500">Selecciona la maniobra más útil.</p>
                <div class="quiz-options">
                  <button type="button" data-answer="incorrect">Maniobra de Hoover.</button>
                  <button type="button" data-answer="correct">Observa elevación simétrica del paladar blando.</button>
                  <button type="button" data-answer="incorrect">Prueba de Romberg sensibilizada.</button>
                </div>
              </div>
              <button type="button" class="case-button" data-quiz-submit>
                <i class="fas fa-star"></i> Verificar respuestas
              </button>
              <p class="text-sm text-slate-600" data-quiz-feedback>
                Selecciona una respuesta por pregunta para obtener tu puntuación.
              </p>
            </div>
            <div class="border border-slate-200 rounded-2xl p-6 bg-slate-50">
              <h3 class="font-semibold text-slate-800">Rúbrica breve</h3>
              <ul class="mt-4 space-y-3 text-slate-600">
                <li><strong>Observación</strong>: postura, marcha, trofismo.</li>
                <li><strong>Técnica</strong>: instrucciones claras, seguridad del paciente.</li>
                <li><strong>Interpretación</strong>: correlación neuroanatómica.</li>
                <li><strong>Comunicación</strong>: feedback y resumen estructurado.</li>
              </ul>
            </div>
          </section>

          <section
            id="bibliografia"
            class="bg-white border border-slate-200 rounded-3xl shadow-lg p-8 lg:p-12 space-y-6"
          >
            <h2 class="text-3xl font-bold text-slate-900">Bibliografía</h2>
            <div class="grid gap-4 md:grid-cols-2">
              <article class="reference-card">
                <h3>Blumenfeld, H.</h3>
                <p>Neuroanatomy through Clinical Cases.</p>
                <span>Sinauer Associates.</span>
              </article>
              <article class="reference-card">
                <h3>Adams & Victor</h3>
                <p>Principles of Neurology.</p>
                <span>McGraw-Hill Education.</span>
              </article>
              <article class="reference-card">
                <h3>Mayo Clinic</h3>
                <p>Videos de examen neurológico.</p>
                <span>Repositorio audiovisual.</span>
              </article>
              <article class="reference-card">
                <h3>J. DeMyer</h3>
                <p>Technique of the Neurologic Examination.</p>
                <span>McGraw-Hill.</span>
              </article>
            </div>
          </section>
        </section>
      </div>
    </main>

      renderNav(sidebarLinks);
      renderNav(drawerLinks);
      renderModules();

      const drawer = document.querySelector('.drawer');
      const overlay = document.querySelector('.drawer-overlay');
      const drawerToggle = document.querySelector('.drawer-toggle');
      const drawerClose = document.querySelector('.drawer-close');

      function openDrawer() {
        drawer.classList.add('open');
        overlay.classList.add('visible');
        drawer.setAttribute('aria-hidden', 'false');
        document.body.classList.add('drawer-open');
      }

      function closeDrawer() {
        drawer.classList.remove('open');
        overlay.classList.remove('visible');
        drawer.setAttribute('aria-hidden', 'true');
        document.body.classList.remove('drawer-open');
      }

      drawerToggle.addEventListener('click', openDrawer);
      drawerClose.addEventListener('click', closeDrawer);
      overlay.addEventListener('click', closeDrawer);
      window.addEventListener('keydown', (event) => {
        if (event.key === 'Escape') {
          closeDrawer();
        }
      });

      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            const id = entry.target.getAttribute('id');
            const selector = `a[href="#${id}"]`;
            document.querySelectorAll(selector).forEach((link) => {
              if (entry.isIntersecting) {
                link.classList.add('active');
              } else {
                link.classList.remove('active');
              }
            });
          });
        },
        { rootMargin: '-40% 0px -50% 0px' }
      );

      sections.forEach((section) => observer.observe(section));

      navLinks.forEach((link) => {
        link.addEventListener('click', () => {
          navLinks.forEach((l) => l.classList.remove('active'));
          link.classList.add('active');
        });
      });

      const missions = document.querySelectorAll('[data-mission]');
      const challenges = document.querySelectorAll('[data-challenge]');
      const progressBar = document.querySelector('[data-progress-bar]');
      const progressText = document.querySelector('[data-progress-text]');
      const xpDisplay = document.querySelector('[data-xp-display]');
      const streakDisplay = document.querySelector('[data-streak]');
      let xp = Number(xpDisplay?.textContent ?? 0);
      let streak = Number(streakDisplay?.textContent ?? 0);

      const updateScore = (xpDelta = 0, streakDelta = 0) => {
        if (!xpDisplay || !streakDisplay) return;
        xp = Math.max(0, xp + xpDelta);
        streak = Math.max(0, streak + streakDelta);
        xpDisplay.textContent = xp;
        streakDisplay.textContent = streak;
      };

      const updateProgress = () => {
        if (!progressBar || !progressText) return;
        const total = missions.length;
        const completed = document.querySelectorAll('[data-mission].completed')
          .length;
        const percent = total ? Math.round((completed / total) * 100) : 0;
        progressBar.style.width = `${percent}%`;
        progressText.textContent = `${percent}% completado`;
      };

      missions.forEach((mission) => {
        mission.addEventListener('click', () => {
          const xpValue = Number(mission.dataset.xp || 0);
          const completed = mission.classList.toggle('completed');
          updateScore(completed ? xpValue : -xpValue, completed ? 1 : -1);
          updateProgress();
        });
      });

      challenges.forEach((challenge) => {
        challenge.addEventListener('click', () => {
          const xpValue = Number(challenge.dataset.xp || 0);
          const completed = challenge.classList.toggle('completed');
          updateScore(completed ? xpValue : -xpValue, completed ? 1 : -1);
        });
      });

      updateProgress();

      document
        .querySelectorAll('[data-flip-card]')
        .forEach((card) =>
          card.addEventListener('click', () =>
            card.classList.toggle('is-flipped'),
          ),
        );

      const labButtons = document.querySelectorAll('[data-lab-button]');
      const labPanels = document.querySelectorAll('[data-lab-panel]');

      labButtons.forEach((button) => {
        button.addEventListener('click', () => {
          const target = button.dataset.labButton;
          labButtons.forEach((btn) => btn.classList.remove('active'));
          labPanels.forEach((panel) =>
            panel.classList.toggle('active', panel.dataset.labPanel === target),
          );
          button.classList.add('active');
        });
      });

      const caseButton = document.querySelector('[data-case-button]');
      const caseOutput = document.querySelector('[data-case-output]');
      const cases = [
        'Paciente de 68 años con hemiparesia derecha y Babinski positivo.',
        'Adolescente con debilidad proximal progresiva y reflejos hipoactivos.',
        'Mujer de 45 años con temblor de reposo y rigidez en rueda dentada.',
        'Varón deportista con arreflexia aquílea y fasciculaciones distales.',
      ];

      caseButton?.addEventListener('click', () => {
        const scenario = cases[Math.floor(Math.random() * cases.length)];
        if (caseOutput) {
          caseOutput.textContent = scenario;
        }
      });

      const thresholdInput = document.querySelector('[data-threshold]');
      const thresholdOutput = document.querySelector('[data-threshold-output]');

      thresholdInput?.addEventListener('input', (event) => {
        if (!thresholdOutput) return;
        const value = Number(event.target.value);
        let focus = 'Prioriza pruebas táctiles ligeras.';
        if (value >= 70) {
          focus = 'Intensifica vibración y propiocepción en miembros inferiores.';
        } else if (value >= 40) {
          focus = 'Combina temperatura y dolor para delimitar dermatomos.';
        }
        thresholdOutput.innerHTML = `Umbral sugerido: <strong>${value}%</strong>. ${focus}`;
      });

      const patternButton = document.querySelector('[data-pattern-button]');
      const patternOutput = document.querySelector('[data-pattern-output]');
      const patterns = [
        'Hipoestesia en guante: neuropatía periférica distal.',
        'Nivel sensitivo en T6 con preservación sacra: síndrome medular central.',
        'Anestesia facial en V2-V3 con reflejo corneal disminuido.',
        'Pérdida vibratoria en MMII con marcha atáxica: cordones posteriores.',
      ];

      patternButton?.addEventListener('click', () => {
        const pattern = patterns[Math.floor(Math.random() * patterns.length)];
        if (patternOutput) {
          patternOutput.textContent = pattern;
        }
      });

      const quiz = document.querySelector('[data-quiz]');
      const quizSubmit = document.querySelector('[data-quiz-submit]');
      const quizFeedback = document.querySelector('[data-quiz-feedback]');
      let lastQuizScore = 0;

      quiz?.querySelectorAll('.quiz-options').forEach((group) => {
        group.addEventListener('click', (event) => {
          const target = event.target.closest('button');
          if (!target) return;
          group.querySelectorAll('button').forEach((btn) => {
            btn.classList.remove('selected');
          });
          target.classList.add('selected');
        });
      });

      quizSubmit?.addEventListener('click', () => {
        if (!quiz) return;
        const groups = quiz.querySelectorAll('.quiz-options');
        let unanswered = false;
        groups.forEach((group) => {
          const selected = group.querySelector('button.selected');
          if (!selected) {
            unanswered = true;
          }
        });
        if (unanswered) {
          quizFeedback &&
            (quizFeedback.textContent =
              'Selecciona una respuesta en cada pregunta antes de verificar.');
          return;
        }

        groups.forEach((group) => {
          group.querySelectorAll('button').forEach((btn) => {
            btn.classList.remove('correct', 'incorrect');
          });
        });

        let correctAnswers = 0;
        groups.forEach((group) => {
          const selected = group.querySelector('button.selected');
          if (!selected) return;
          if (selected.dataset.answer === 'correct') {
            selected.classList.add('correct');
            correctAnswers += 1;
          } else {
            selected.classList.add('incorrect');
            group.querySelector('[data-answer="correct"]')?.classList.add(
              'correct',
            );
          }
        });

        const xpDelta = (correctAnswers - lastQuizScore) * 15;
        const streakDelta = correctAnswers - lastQuizScore;
        updateScore(xpDelta, streakDelta);
        lastQuizScore = correctAnswers;
        quizFeedback &&
          (quizFeedback.textContent = `Respuestas correctas: ${correctAnswers}/${groups.length}. ¡Sigue entrenando!`);
      });
    </script>
  </body>
</html>
