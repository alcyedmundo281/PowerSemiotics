<!doctype html>
<html lang="es" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Módulo Interactivo: La Caja Negra del Poder</title>

    <!-- Tailwind CSS -->
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <!-- Iconos (Lucide) -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>

    <!-- Estilos personalizados -->

    <link href="../../assets/tailwind.css" rel="stylesheet" />
  </head>
  <body class="font-sans bg-gray-100">
    <div class="container mx-auto p-4 md:p-8 max-w-5xl">
      <!-- Módulo 0: Introducción -->
      <section
        id="step-0"
        class="step text-center min-h-screen flex flex-col justify-center"
      >
        <h1
          class="text-4xl md:text-6xl font-black tracking-tighter leading-tight mb-4"
        >
          La <span class="gradient-text">Caja Negra</span> del Poder
        </h1>
        <p class="max-w-3xl mx-auto text-lg md:text-xl text-gray-600 mb-8">
          Un viaje interactivo para entender por qué las políticas de salud a
          menudo no funcionan como deberían, basado en el marco teórico del
          Capítulo 2.
        </p>
        <button
          onclick="showStep(1)"
          class="bg-blue-900 text-white font-bold py-3 px-8 rounded-full text-lg inline-block hover:bg-blue-800 transition-colors shadow-lg"
        >
          Comenzar el Viaje
        </button>
      </section>

      <!-- Módulo 1: El Mapa Antiguo -->
      <section
        id="step-1"
        class="step min-h-screen flex flex-col justify-center"
      >
        <div class="text-center mb-12">
          <p class="text-blue-700 font-bold">Módulo 1 de 5</p>
          <h2 class="text-3xl md:text-4xl font-bold mb-2">
            Más Allá de la Contabilidad
          </h2>
          <p class="text-gray-600 max-w-2xl mx-auto">
            Los análisis tradicionales ven el gasto y las políticas, pero
            ignoran el proceso intermedio, tratándolo como una "caja negra".
          </p>
        </div>

        <div class="flex justify-center items-center">
          <div
            id="black-box-container"
            class="relative w-72 h-72 cursor-pointer"
            onclick="openBlackBox()"
          >
            <div
              id="black-box"
              class="w-full h-full bg-gray-900 rounded-2xl shadow-2xl flex items-center justify-center text-white text-2xl font-bold transition-transform duration-500"
              style="transform-style: preserve-3d"
            >
              <span class="transform scale-x-[-1]">&#10067;</span> LA CAJA NEGRA
            </div>
            <div
              id="box-content"
              class="absolute inset-0 grid grid-cols-2 gap-4 p-6 opacity-0 transition-opacity duration-500"
            >
              <div
                class="bg-purple-200 text-purple-800 rounded-lg flex items-center justify-center font-bold text-center"
              >
                Poder
              </div>
              <div
                class="bg-indigo-200 text-indigo-800 rounded-lg flex items-center justify-center font-bold text-center"
              >
                Intereses
              </div>
              <div
                class="bg-blue-200 text-blue-800 rounded-lg flex items-center justify-center font-bold text-center"
              >
                Política
              </div>
              <div
                class="bg-pink-200 text-pink-800 rounded-lg flex items-center justify-center font-bold text-center"
              >
                Cultura
              </div>
            </div>
            <p class="text-center text-gray-500 mt-4 font-semibold">
              Haz clic para abrir
            </p>
          </div>
        </div>
        <div class="text-center mt-12">
          <button
            onclick="showStep(2)"
            class="bg-blue-900 text-white font-bold py-2 px-6 rounded-full hover:bg-blue-800 transition-colors"
          >
            Siguiente &rarr;
          </button>
        </div>
      </section>

      <!-- Módulo 2: Un Nuevo Kit de Herramientas -->
      <section
        id="step-2"
        class="step min-h-screen flex flex-col justify-center"
      >
        <div class="text-center mb-12">
          <p class="text-blue-700 font-bold">Módulo 2 de 5</p>
          <h2 class="text-3xl md:text-4xl font-bold mb-2">
            Un Marco Teórico Híbrido
          </h2>
          <p class="text-gray-600 max-w-2xl mx-auto">
            Para abrir la caja negra, combinamos dos disciplinas
            complementarias.
          </p>
        </div>
        <div class="flex flex-col md:flex-row gap-8 items-stretch">
          <!-- Card CI -->
          <div
            class="flex-1 p-8 bg-white rounded-2xl shadow-lg border-2 border-transparent hover:border-blue-500 transition-all"
          >
            <h3 class="text-2xl font-bold text-blue-800">
              Ciencia de la Implementación (CI)
            </h3>
            <p class="text-5xl font-black my-4 gradient-text">EL CÓMO</p>
            <p class="text-gray-600">
              Ofrece los marcos para desentrañar el
              <span class="font-bold">proceso</span> de implementación,
              identificando sistemáticamente las barreras y facilitadores que
              afectan la ejecución de políticas en el mundo real.
            </p>
          </div>
          <!-- Card AEP -->
          <div
            class="flex-1 p-8 bg-white rounded-2xl shadow-lg border-2 border-transparent hover:border-purple-500 transition-all"
          >
            <h3 class="text-2xl font-bold text-purple-800">
              Análisis de Economía Política (AEP)
            </h3>
            <p class="text-5xl font-black my-4 gradient-text">EL PORQUÉ</p>
            <p class="text-gray-600">
              Ofrece el lente para analizar cómo el
              <span class="font-bold"
                >poder, los intereses y las instituciones</span
              >
              configuran el contexto en el que ocurre la implementación y
              determinan sus resultados.
            </p>
          </div>
        </div>
        <div class="text-center mt-12">
          <button
            onclick="showStep(3)"
            class="bg-blue-900 text-white font-bold py-2 px-6 rounded-full hover:bg-blue-800 transition-colors"
          >
            Siguiente &rarr;
          </button>
        </div>
      </section>

      <!-- Módulo 3: La Ciencia de la Implementación (CI) -->
      <section
        id="step-3"
        class="step min-h-screen flex flex-col justify-center"
      >
        <div class="text-center mb-12">
          <p class="text-blue-700 font-bold">Módulo 3 de 5</p>
          <h2 class="text-3xl md:text-4xl font-bold mb-2">
            Explorando el "CÓMO" con la CI
          </h2>
          <p class="text-gray-600 max-w-2xl mx-auto">
            Usemos un marco llamado CFIR para diagnosticar el contexto.
            <span class="font-semibold"
              >Pasa el cursor sobre cada dominio.</span
            >
          </p>
        </div>

        <div class="w-full bg-white p-8 rounded-2xl shadow-xl">
          <div class="grid grid-cols-1 md:grid-cols-5 gap-4 text-center">
            <div class="has-tooltip relative p-4 bg-gray-100 rounded-lg">
              <i data-lucide="box" class="mx-auto h-10 w-10 text-blue-600"></i>
              <h4 class="font-bold mt-2">Intervención</h4>
              <div
                class="tooltip absolute bottom-full mb-2 w-64 p-2 bg-gray-800 text-white text-sm rounded-lg shadow-lg"
              >
                <span class="font-bold">Características de la Política:</span>
                ¿Es compleja? ¿Costosa? ¿Tiene evidencia sólida? Ej: La
                complejidad de la Subasta Inversa de Medicamentos.
              </div>
            </div>
            <div class="has-tooltip relative p-4 bg-gray-100 rounded-lg">
              <i
                data-lucide="globe-2"
                class="mx-auto h-10 w-10 text-blue-600"
              ></i>
              <h4 class="font-bold mt-2">Contexto Externo</h4>
              <div
                class="tooltip absolute bottom-full mb-2 w-64 p-2 bg-gray-800 text-white text-sm rounded-lg shadow-lg"
              >
                <span class="font-bold">Factores fuera del sistema:</span>
                Leyes, crisis económicas, presión de la industria farmacéutica o
                gremios privados.
              </div>
            </div>
            <div class="has-tooltip relative p-4 bg-gray-100 rounded-lg">
              <i
                data-lucide="building-2"
                class="mx-auto h-10 w-10 text-blue-600"
              ></i>
              <h4 class="font-bold mt-2">Contexto Interno</h4>
              <div
                class="tooltip absolute bottom-full mb-2 w-64 p-2 bg-gray-800 text-white text-sm rounded-lg shadow-lg"
              >
                <span class="font-bold">Dentro de la organización:</span>
                Cultura, liderazgo, recursos, comunicación. Ej: La fragmentación
                histórica entre el MSP y el IESS.
              </div>
            </div>
            <div class="has-tooltip relative p-4 bg-gray-100 rounded-lg">
              <i
                data-lucide="users"
                class="mx-auto h-10 w-10 text-blue-600"
              ></i>
              <h4 class="font-bold mt-2">Individuos</h4>
              <div
                class="tooltip absolute bottom-full mb-2 w-64 p-2 bg-gray-800 text-white text-sm rounded-lg shadow-lg"
              >
                <span class="font-bold">Los actores que ejecutan:</span> Sus
                conocimientos, motivaciones, resistencia al cambio. Ej:
                Directores de hospitales, personal administrativo.
              </div>
            </div>
            <div class="has-tooltip relative p-4 bg-gray-100 rounded-lg">
              <i
                data-lucide="git-branch"
                class="mx-auto h-10 w-10 text-blue-600"
              ></i>
              <h4 class="font-bold mt-2">Proceso</h4>
              <div
                class="tooltip absolute bottom-full mb-2 w-64 p-2 bg-gray-800 text-white text-sm rounded-lg shadow-lg"
              >
                <span class="font-bold">La calidad de la implementación:</span>
                ¿Hubo buena planificación, compromiso, evaluación y reflexión?
              </div>
            </div>
          </div>
        </div>
        <div class="text-center mt-12">
          <button
            onclick="showStep(4)"
            class="bg-blue-900 text-white font-bold py-2 px-6 rounded-full hover:bg-blue-800 transition-colors"
          >
            Siguiente &rarr;
          </button>
        </div>
      </section>

      <!-- Módulo 4: Desenmascarando el Poder (AEP) -->
      <section
        id="step-4"
        class="step min-h-screen flex flex-col justify-center"
      >
        <div class="text-center mb-12">
          <p class="text-blue-700 font-bold">Módulo 4 de 5</p>
          <h2 class="text-3xl md:text-4xl font-bold mb-2">
            Las Tres Caras del Poder
          </h2>
          <p class="text-gray-600 max-w-2xl mx-auto">
            El poder no siempre es visible. Usemos la metáfora de un iceberg
            para explorar sus dimensiones ocultas.
            <span class="font-semibold">Haz clic en cada parte.</span>
          </p>
        </div>

        <div class="iceberg-container">
          <svg viewBox="0 0 500 500" class="w-full h-auto">
            <!-- Linea de agua -->
            <line
              x1="0"
              y1="200"
              x2="500"
              y2="200"
              stroke="#60a5fa"
              stroke-width="3"
              stroke-dasharray="10 5"
            />
            <text
              x="450"
              y="190"
              font-family="Inter, sans-serif"
              font-size="16"
              fill="#60a5fa"
            >
              Visible
            </text>
            <text
              x="450"
              y="225"
              font-family="Inter, sans-serif"
              font-size="16"
              fill="#3b82f6"
            >
              Oculto
            </text>

            <!-- 1ra Cara -->
            <g onclick="showModal('power-1')">
              <path
                class="iceberg-part"
                d="M 250,50 L 150,200 L 350,200 Z"
                fill="#bfdbfe"
              />
              <text
                x="250"
                y="140"
                text-anchor="middle"
                font-weight="bold"
                font-size="20"
                fill="#1e3a8a"
              >
                1. Poder Decisional
              </text>
            </g>
            <!-- 2da Cara -->
            <g onclick="showModal('power-2')">
              <path
                class="iceberg-part"
                d="M 150,200 L 350,200 L 400,350 L 100,350 Z"
                fill="#93c5fd"
              />
              <text
                x="250"
                y="280"
                text-anchor="middle"
                font-weight="bold"
                font-size="20"
                fill="#1e3a8a"
              >
                2. Poder de Agenda
              </text>
            </g>
            <!-- 3ra Cara -->
            <g onclick="showModal('power-3')">
              <path
                class="iceberg-part"
                d="M 100,350 L 400,350 L 300,480 L 200,480 Z"
                fill="#60a5fa"
              />
              <text
                x="250"
                y="420"
                text-anchor="middle"
                font-weight="bold"
                font-size="20"
                fill="#1e3a8a"
              >
                3. Poder Ideológico
              </text>
            </g>
          </svg>
        </div>
        <div class="text-center mt-12">
          <button
            onclick="showStep(5)"
            class="bg-blue-900 text-white font-bold py-2 px-6 rounded-full hover:bg-blue-800 transition-colors"
          >
            Siguiente &rarr;
          </button>
        </div>
      </section>

      <!-- Módulo 5: Síntesis -->
      <section
        id="step-5"
        class="step min-h-screen flex flex-col justify-center"
      >
        <div class="text-center mb-12">
          <p class="text-blue-700 font-bold">Módulo 5 de 5</p>
          <h2 class="text-3xl md:text-4xl font-bold mb-2">
            Conectando los Puntos: La Sinergia Causal
          </h2>
          <p class="text-gray-600 max-w-2xl mx-auto">
            Así es como el poder (AEP) causa las fallas que la ciencia de la
            implementación (CI) diagnostica.
          </p>
        </div>

        <div class="space-y-4">
          <!-- Flujo -->
          <div
            class="p-6 bg-white rounded-xl shadow-lg flex items-center gap-4"
          >
            <div class="bg-purple-100 p-3 rounded-full">
              <i data-lucide="key-round" class="h-8 w-8 text-purple-700"></i>
            </div>
            <div>
              <h4 class="font-bold text-lg text-purple-800">
                1. Ejercicio del Poder (AEP)
              </h4>
              <p class="text-gray-600">
                Actores con intereses (ej. industria farmacéutica) usan sus
                recursos para influir en el sistema.
              </p>
            </div>
          </div>
          <div class="flex justify-center">
            <i data-lucide="arrow-down" class="h-8 w-8 text-gray-400"></i>
          </div>
          <div
            class="p-6 bg-white rounded-xl shadow-lg flex items-center gap-4"
          >
            <div class="bg-blue-100 p-3 rounded-full">
              <i data-lucide="construction" class="h-8 w-8 text-blue-700"></i>
            </div>
            <div>
              <h4 class="font-bold text-lg text-blue-800">
                2. Se Crean Barreras de Implementación (CI)
              </h4>
              <p class="text-gray-600">
                Esto genera un "contexto interno" resistente, un "liderazgo"
                débil, o una "cultura" que desconfía de la política (ej.
                genéricos).
              </p>
            </div>
          </div>
          <div class="flex justify-center">
            <i data-lucide="arrow-down" class="h-8 w-8 text-gray-400"></i>
          </div>
          <div
            class="p-6 bg-white rounded-xl shadow-lg flex items-center gap-4"
          >
            <div class="bg-red-100 p-3 rounded-full">
              <i data-lucide="shield-x" class="h-8 w-8 text-red-700"></i>
            </div>
            <div>
              <h4 class="font-bold text-lg text-red-800">
                3. La Implementación Falla
              </h4>
              <p class="text-gray-600">
                La política no se adopta, se aplica con baja fidelidad, no es
                sostenible, o no es aceptada por los actores.
              </p>
            </div>
          </div>
          <div class="flex justify-center">
            <i data-lucide="arrow-down" class="h-8 w-8 text-gray-400"></i>
          </div>
          <div
            class="p-6 bg-yellow-100 rounded-xl shadow-lg flex items-center gap-4"
          >
            <div class="bg-yellow-200 p-3 rounded-full">
              <i data-lucide="repeat" class="h-8 w-8 text-yellow-700"></i>
            </div>
            <div>
              <h4 class="font-bold text-lg text-yellow-800">
                4. Se Perpetúa la Paradoja
              </h4>
              <p class="text-gray-600">
                A pesar del alto gasto, los problemas persisten porque el dinero
                no fluye como debería para proteger a la población.
              </p>
            </div>
          </div>
        </div>
        <div class="text-center mt-12">
          <button
            onclick="showStep(0)"
            class="bg-gray-700 text-white font-bold py-2 px-6 rounded-full hover:bg-gray-600 transition-colors"
          >
            Reiniciar Módulo
          </button>
        </div>
      </section>
    </div>

    <!-- Modales para las Caras del Poder -->
    <div
      id="modal-container"
      class="fixed inset-0 z-50 flex items-center justify-center p-4 hidden"
    >
      <div
        class="modal-overlay absolute inset-0 bg-black/60"
        onclick="closeModal()"
      ></div>
      <div
        class="modal-content bg-white rounded-2xl shadow-2xl p-8 max-w-lg w-full relative transform scale-95"
      >
        <button
          onclick="closeModal()"
          class="absolute top-4 right-4 text-gray-500 hover:text-gray-800"
        >
          <i data-lucide="x"></i>
        </button>

        <div id="power-1-content" class="modal-body hidden">
          <h3 class="text-2xl font-bold mb-4 gradient-text">
            1. Poder Decisional (La punta del iceberg)
          </h3>
          <p class="text-gray-600">
            Es la forma de poder más visible y se alinea con el análisis de
            Dahl. Se refiere a la capacidad de influir
            <span class="font-bold">directamente</span> en las decisiones
            observables.
          </p>
          <div class="mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200">
            <p class="font-semibold text-blue-800">Pregunta clave:</p>
            <p class="text-blue-700">
              ¿Quién gana en las negociaciones del presupuesto entre el
              Ministerio de Salud (MSP) y el de Finanzas (MEF)? ¿Quién inicia
              propuestas y quién las veta?
            </p>
          </div>
        </div>

        <div id="power-2-content" class="modal-body hidden">
          <h3 class="text-2xl font-bold mb-4 gradient-text">
            2. Poder de Agenda (Bajo la superficie)
          </h3>
          <p class="text-gray-600">
            También llamado "non-decision making". Es la capacidad de controlar
            <span class="font-bold">qué temas se discuten</span> y, más
            importante, cuáles se mantienen fuera de la agenda política,
            evitando que se conviertan en un conflicto.
          </p>
          <div class="mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200">
            <p class="font-semibold text-blue-800">Pregunta clave:</p>
            <p class="text-blue-700">
              ¿Por qué una reforma integral al financiamiento del IESS, que
              podría amenazar intereses creados, rara vez se debate seriamente?
            </p>
          </div>
        </div>

        <div id="power-3-content" class="modal-body hidden">
          <h3 class="text-2xl font-bold mb-4 gradient-text">
            3. Poder Ideológico (Las profundidades)
          </h3>
          <p class="text-gray-600">
            Es la forma más sutil y poderosa. Es la capacidad de
            <span class="font-bold"
              >moldear las percepciones, deseos y preferencias</span
            >
            de los actores para que acepten el orden existente como "natural" o
            "inevitable", previniendo que surjan conflictos.
          </p>
          <div class="mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200">
            <p class="font-semibold text-blue-800">Pregunta clave:</p>
            <p class="text-blue-700">
              ¿Cómo se ha normalizado la idea de que los ciudadanos deban pagar
              de su bolsillo por servicios que teóricamente están cubiertos por
              el Estado?
            </p>
          </div>
        </div>
      </div>
    </div>

    <script>
      let currentStep = 0;
      const steps = document.querySelectorAll('.step');

      function showStep(index) {
        if (index < 0 || index >= steps.length) return;

        const currentSection = document.getElementById(`step-${currentStep}`);
        if (currentSection) {
          currentSection.classList.remove('visible');
        }

        const nextSection = document.getElementById(`step-${index}`);
        if (nextSection) {
          nextSection.classList.add('visible');
          nextSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        currentStep = index;
      }

      function openBlackBox() {
        const box = document.getElementById('black-box');
        const content = document.getElementById('box-content');
        box.style.transform = 'rotateY(180deg)';
        setTimeout(() => {
          content.style.opacity = '1';
        }, 300);
      }

      const modalContainer = document.getElementById('modal-container');
      const modalBodies = document.querySelectorAll('.modal-body');

      function showModal(powerType) {
        modalBodies.forEach((body) => body.classList.add('hidden'));
        const contentToShow = document.getElementById(`${powerType}-content`);
        if (contentToShow) {
          contentToShow.classList.remove('hidden');
        }
        modalContainer.classList.remove('hidden');
        document.body.style.overflow = 'hidden';
      }

      function closeModal() {
        modalContainer.classList.add('hidden');
        document.body.style.overflow = 'auto';
      }

      window.onload = () => {
        showStep(0);
        lucide.createIcons();
      };
    </script>
  </body>
</html>
